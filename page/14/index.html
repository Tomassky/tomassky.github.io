<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Tomas&#39;Blog">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;page&#x2F;14&#x2F;index.html">
<meta property="og:site_name" content="Tomas&#39;Blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/14/"/>





  <title>Tomas'Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Tomas'Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
            å½’æ¡£
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E4%B8%83)%EF%BC%9A%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F--UDP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E4%B8%83)%EF%BC%9A%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F--UDP/" itemprop="url">Kali Linuxç¬”è®°(åä¸ƒ)ï¼šç«¯å£æ‰«æ--UDP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  367 å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  1 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-ç«¯å£æ‰«æï¼ˆUDPï¼‰"><a href="#1-ç«¯å£æ‰«æï¼ˆUDPï¼‰" class="headerlink" title="1. ç«¯å£æ‰«æï¼ˆUDPï¼‰"></a>1. ç«¯å£æ‰«æï¼ˆUDPï¼‰</h4><ul>
<li>ç«¯å£å¯¹åº”ç½‘ç»œæœåŠ¡åŠåº”ç”¨ç«¯ç¨‹åº</li>
<li>æœåŠ¡ç«¯ç¨‹åºçš„æ¼æ´é€šè¿‡ç«¯å£æ”»å…¥</li>
<li>å‘ç°å¼€æ”¾çš„ç«¯å£</li>
<li>æ›´å…·ä½“çš„æ”»å‡»é¢</li>
<li>UDPç«¯å£<ul>
<li>å‡è®¾ICMP port-unreachable å“åº”ä»£è¡¨ç«¯å£å…³é—­ï¼ˆæ²¡æœ‰å“åº”ï¼Œå³ä¸ºç«¯å£å¼€æ”¾ï¼‰</li>
<li>ç›®æ ‡ç³»ç»Ÿä¸å“åº”ICMP port-unreachableæ—¶ï¼Œå¯èƒ½äº§ç”Ÿè¯¯åˆ¤</li>
</ul>
</li>
<li>å®Œæ•´çš„UDPåº”ç”¨å±‚è¯·æ±‚<ul>
<li>å‡†ç¡®æ€§é«˜</li>
<li>è€—æ—¶å·¨å¤§</li>
</ul>
</li>
</ul>
<h4 id="2-ç«¯å£æ‰«æï¼ˆScapy-UDPï¼‰"><a href="#2-ç«¯å£æ‰«æï¼ˆScapy-UDPï¼‰" class="headerlink" title="2. ç«¯å£æ‰«æï¼ˆScapy-UDPï¼‰"></a>2. ç«¯å£æ‰«æï¼ˆScapy-UDPï¼‰</h4><ul>
<li>Scapy UDP Scan<ul>
<li>ç«¯å£å…³é—­ï¼šICMP port-unreachable</li>
<li>ç«¯å£å¼€æ”¾ï¼šæ²¡æœ‰å›åŒ…</li>
<li>äº†è§£æ¯ä¸€ç§åŸºäºUDPçš„åº”ç”¨åŒ…ç»“æ„å¾ˆæœ‰å¸®åŠ©</li>
<li>ä¸ä¸‰å±‚ç›¸åŒçš„æŠ€æœ¯</li>
<li>è¯¯åˆ¤</li>
</ul>
</li>
<li>Scapy<ul>
<li>sr1(IP(dst=â€IPåœ°å€â€)/UDP(dport=53),timeout=1,verbose=1)</li>
</ul>
</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./udp_scan.py IPåœ°å€ èµ·å§‹ç«¯å£ ç»“æŸç«¯å£</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">logging.getLogger(&quot;scapy.runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import *</span><br><span class="line">import time</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=4:</span><br><span class="line">    print &quot;Usage - ./udp_scan.py [Target IP] [First IP] [Last IP] &quot;</span><br><span class="line">    print &quot;Example - ./udp_scan.py 192.168.100.1 1 200&quot;</span><br><span class="line">    print &quot;Example will perform a TCP ACK scan of the 192.168.100.0/24 range&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">ip=sys.argv[1]</span><br><span class="line">start=int(sys.argv[2])</span><br><span class="line">end=int(sys.argv[3])</span><br><span class="line"></span><br><span class="line">for port in range(start end):</span><br><span class="line">    a=sr1(IP(dst=ip)/UDP(dport=port),timeout=5,verbose=0)</span><br><span class="line">    time.sleep(1)</span><br><span class="line">    if a==None:</span><br><span class="line">      print port</span><br><span class="line">    else:</span><br><span class="line">      pass</span><br></pre></td></tr></table></figure>

<h4 id="3-ç«¯å£æ‰«æï¼ˆNmap-UDPï¼‰"><a href="#3-ç«¯å£æ‰«æï¼ˆNmap-UDPï¼‰" class="headerlink" title="3. ç«¯å£æ‰«æï¼ˆNmap-UDPï¼‰"></a>3. ç«¯å£æ‰«æï¼ˆNmap-UDPï¼‰</h4><ul>
<li>Nmap</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap -sUï¼ˆç«¯å£æ‰«æï¼‰ IPåœ°å€</code></strong><ul>
<li>é»˜è®¤çš„1000ä¸ªå‚æ•°ï¼ˆä¸æŒ‡å®šç«¯å£çš„æƒ…å†µä¸‹ï¼‰</li>
<li>ICMP host-unreachable</li>
</ul>
</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap IPåœ°å€ -sU -pï¼ˆæŒ‡å®šç«¯å£ï¼‰ 53</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap -iL iplist.txt -sU -pï¼ˆæŒ‡å®šç«¯å£èŒƒå›´ï¼‰ 1-200</code></strong></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E5%85%AD)%EF%BC%9A%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0--%E5%9B%9B%E5%B1%82%E5%8F%91%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E5%85%AD)%EF%BC%9A%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0--%E5%9B%9B%E5%B1%82%E5%8F%91%E7%8E%B0/" itemprop="url">Kali Linuxç¬”è®°(åå…­)ï¼šä¸»æœºå‘ç°--å››å±‚å‘ç°</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  996 å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  5 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-å‘ç°-å››å±‚å‘ç°ï¼ˆä¸å¯¹ç«¯å£çŠ¶æ€è¿›è¡Œè¯†åˆ«ï¼Œä¸»è¦æ˜¯å¯¹IPæ˜¯å¦åœ¨çº¿è¿›è¡Œè¯†åˆ«ï¼‰"><a href="#1-å‘ç°-å››å±‚å‘ç°ï¼ˆä¸å¯¹ç«¯å£çŠ¶æ€è¿›è¡Œè¯†åˆ«ï¼Œä¸»è¦æ˜¯å¯¹IPæ˜¯å¦åœ¨çº¿è¿›è¡Œè¯†åˆ«ï¼‰" class="headerlink" title="1. å‘ç°-å››å±‚å‘ç°ï¼ˆä¸å¯¹ç«¯å£çŠ¶æ€è¿›è¡Œè¯†åˆ«ï¼Œä¸»è¦æ˜¯å¯¹IPæ˜¯å¦åœ¨çº¿è¿›è¡Œè¯†åˆ«ï¼‰"></a>1. å‘ç°-å››å±‚å‘ç°ï¼ˆä¸å¯¹ç«¯å£çŠ¶æ€è¿›è¡Œè¯†åˆ«ï¼Œä¸»è¦æ˜¯å¯¹IPæ˜¯å¦åœ¨çº¿è¿›è¡Œè¯†åˆ«ï¼‰</h4><ul>
<li>ä¼˜ç‚¹<ul>
<li>å¯è·¯ç”±ä¸”ç»“æœå¯é </li>
<li>ä¸å¤ªå¯èƒ½è¢«é˜²ç«å¢™è¿‡æ»¤</li>
<li>ç”šè‡³å¯ä»¥å‘ç°æ‰€æœ‰ç«¯å£éƒ½è¢«è¿‡æ»¤çš„ä¸»æœº</li>
</ul>
</li>
<li>ç¼ºç‚¹<ul>
<li>åŸºäºçŠ¶æ€è¿‡æ»¤çš„é˜²ç«å¢™å¯èƒ½è¿‡æ»¤æ‰«æ</li>
<li>å…¨ç«¯å£æ‰«æé€Ÿåº¦æ…¢</li>
</ul>
</li>
<li>TCPï¼ˆæ­£å¸¸è¿‡ç¨‹ï¼šSYNâ€“SYN/ACKâ€“ACKï¼‰<ul>
<li>æœªç»è¯·æ±‚çš„ACKâ€“RST</li>
<li>SYNâ€“SYN/ACKã€RST</li>
</ul>
</li>
<li>UDP<ul>
<li>ICMPç«¯å£ä¸å¯è¾¾ã€ä¸€å»ä¸å¤è¿”ï¼ˆè¢«è¯†åˆ«ä¸»æœºç«¯å£æœªå¼€æ”¾UDPæœåŠ¡ï¼‰</li>
</ul>
</li>
</ul>
<h4 id="2-å‘ç°-å››å±‚å‘ç°ï¼ˆScapy-TCPï¼‰"><a href="#2-å‘ç°-å››å±‚å‘ç°ï¼ˆScapy-TCPï¼‰" class="headerlink" title="2. å‘ç°-å››å±‚å‘ç°ï¼ˆScapy-TCPï¼‰"></a>2. å‘ç°-å››å±‚å‘ç°ï¼ˆScapy-TCPï¼‰</h4><ul>
<li>ACKâ€“TCP Portâ€“RST</li>
<li>Scapy<ul>
<li>i=IP()</li>
<li>i.dst=â€IPåœ°å€â€</li>
<li>t=TCP()</li>
<li>t.flags=â€Aâ€</li>
<li>r=(i/f)</li>
<li>a=sr1(r)</li>
<li>a.display()</li>
</ul>
</li>
<li>a=sr1(IP(dst=â€IPåœ°å€â€)/TCP(dport=80,flags=â€Aâ€),timeout=1)</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./ACK_Ping.py IPç½‘æ®µ</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">import subprocess</span><br><span class="line">logging.getLogger(&quot;scapy.runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import *</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=2:</span><br><span class="line">    print &quot;Usage - ./ACK_Ping.py [/24 network address]&quot;</span><br><span class="line">    print &quot;Example - ./ACK_Ping.py 192.168.100.0&quot;</span><br><span class="line">    print &quot;Example will perform a TCP ACK scan of the 192.168.100.0/24 range&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">address=str(sys.argv[1])</span><br><span class="line">prefix=address.split(&quot;.&quot;)[0]+&quot;.&quot;+address.split(&quot;.&quot;)[1]+&quot;.&quot;+address.split(&quot;.&quot;)[2]+&quot;.&quot;</span><br><span class="line"></span><br><span class="line">for addr in range(1,254):</span><br><span class="line">    response=sr1(IP(dst=prefix+str(addr))/TCP(dport=2222,flags=&apos;A&apos;),timeout=0.1,verbose=0)</span><br><span class="line">    try:</span><br><span class="line">      if int(response[TCP].flags)==4:</span><br><span class="line">        print prefix+str(addr)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure>

<h4 id="3-å‘ç°-å››å±‚å‘ç°ï¼ˆScapy-UDPï¼‰"><a href="#3-å‘ç°-å››å±‚å‘ç°ï¼ˆScapy-UDPï¼‰" class="headerlink" title="3. å‘ç°-å››å±‚å‘ç°ï¼ˆScapy-UDPï¼‰"></a>3. å‘ç°-å››å±‚å‘ç°ï¼ˆScapy-UDPï¼‰</h4><ul>
<li>UDPâ€“UDP Portâ€“ICMP</li>
<li>Scapy<ul>
<li>i=IP()</li>
<li>u=UDP()</li>
<li>i.dst=â€IPåœ°å€â€</li>
<li>u.dport=33333</li>
<li>r=(i/u)</li>
<li>a=sr1(r,timeout=1,verbose=1)</li>
<li>a.display()</li>
</ul>
</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./UDP_Ping.py IPç½‘æ®µ</code></strong>ï¼ˆUDPå‘ç°ä¸å¯é ï¼‰</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">import subprocess</span><br><span class="line">logging.getLogger(&quot;scapy.runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import *</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=2:</span><br><span class="line">    print &quot;Usage - ./UDP_Ping.py [/24 network address]&quot;</span><br><span class="line">    print &quot;Example - ./UDP_Ping.py 192.168.100.0&quot;</span><br><span class="line">    print &quot;Example will perform a UDP ICMP scan of the 192.168.100.0/24 range&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">address=str(sys.argv[1])</span><br><span class="line">prefix=address.split(&quot;.&quot;)[0]+&quot;.&quot;+address.split(&quot;.&quot;)[1]+&quot;.&quot;+address.split(&quot;.&quot;)[2]+&quot;.&quot;</span><br><span class="line"></span><br><span class="line">for addr in range(1,254):</span><br><span class="line">    response=sr1(IP(dst=prefix+str(addr))/UDP(dport=33333),timeout=0.1,verbose=0)</span><br><span class="line">    try:</span><br><span class="line">      if int(response[IP].proto)==1:</span><br><span class="line">        print prefix+str(addr)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure>

<h4 id="4-å‘ç°-å››å±‚å‘ç°ï¼ˆNmapï¼‰"><a href="#4-å‘ç°-å››å±‚å‘ç°ï¼ˆNmapï¼‰" class="headerlink" title="4. å‘ç°-å››å±‚å‘ç°ï¼ˆNmapï¼‰"></a>4. å‘ç°-å››å±‚å‘ç°ï¼ˆNmapï¼‰</h4><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap IPåœ°å€-254 -PU53ï¼ˆå¯¹äºUDP53ç«¯å£ï¼‰-sn</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap IPåœ°å€-254 -PA80ï¼ˆå¯¹äºTCP80ç«¯å£ï¼‰-sn</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap -iL iplist.txt -PA80 -sn</code></strong></li>
</ul>
<p>â–² 2019.12.3 Nmapå±€åŸŸç½‘ï¼Œæ— è®ºæ˜¯TCPè¿˜æ˜¯UDPï¼Œå‘é€çš„éƒ½æ˜¯DNSçš„åŒ…ï¼Œå±€åŸŸç½‘å†…æ˜¯å‘ç»™ç½‘å…³<br>â–² 2019.12.3 Nmapå¤–ç½‘ï¼ŒUDPæŸ¥è¯¢æ—¶å‘é€DNSåŒ…ï¼ŒTCPå‘é€TCPåŒ…</p>
<blockquote>
<pre><code>nmap IPåœ°å€ -P0 -sn Pingå±‚çš„å‘ç°
nmap IPåœ°å€ -PS -sn SCTPå‘ç°
nmap IPåœ°å€ -PE -sn ICMP echo
nmap IPåœ°å€ -PP -sn æ—¶é—´æˆ³
namp IPåœ°å€ -PM -sn å­ç½‘æ©ç å‘ç°
nmap 192.168.100.1-254 -PA80 -sn | grep &quot;Nmap&quot; | grep -v &quot;Starting&quot; | grep -v &quot;done&quot;| cut -d &quot; &quot; -f 6 | cut -d &quot;(&quot; -f 2| cut -d &quot;)&quot; -f 1 &gt; iplist.txt</code></pre></blockquote>
<h4 id="5-å‘ç°-å››å±‚å‘ç°ï¼ˆhping3ï¼‰"><a href="#5-å‘ç°-å››å±‚å‘ç°ï¼ˆhping3ï¼‰" class="headerlink" title="5. å‘ç°-å››å±‚å‘ç°ï¼ˆhping3ï¼‰"></a>5. å‘ç°-å››å±‚å‘ç°ï¼ˆhping3ï¼‰</h4><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šhping3 --udp IPåœ°å€ -c 1</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šfor addr in $(seq 1 254);do hping3 --udp 1.1.1.$addr -c 1 &gt;&gt;r.txt;done</code></strong><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šgrep Unreachable r.txt | cut -d &quot;&quot; -f 5 | cut -d &quot;=&quot; -f 2</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./udp_hping.sh IPç½‘æ®µ</code></strong></li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#ï¼/bin/bash</span><br><span class="line">if [ &quot;$#&quot; -ne 1 ];then</span><br><span class="line">    echo &quot;USAGE - ./udp_hping.sh [/24 network address]&quot;</span><br><span class="line">    echo &quot;Example - ./udp_hping.sh 192.168.100.0&quot;</span><br><span class="line">    echo &quot;Example will perform an UDP scan of the 192.168.100.0/24 network and output.txt file&quot;</span><br><span class="line">    exit</span><br><span class="line">fi</span><br><span class="line">prefix=$(echo $1 | cut -d &quot;.&quot; -f 1-3)</span><br><span class="line">for addr in $(seq 1 254);do</span><br><span class="line">    hping3 $prefix.$addr --udp -c 1 &gt;&gt; r.txt;</span><br><span class="line">done</span><br><span class="line">grep Unreachable r.txt | cut -d &quot;&quot; -f 5 | cut -d &quot;=&quot; -f 2 &gt;&gt; output.txt</span><br><span class="line">rm r.txt</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šhping3 IPåœ°å€ -c 1</code></strong>ï¼ˆTCPï¼ŒFlag 0â€“ACKã€RSTï¼‰<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šhping3 IPåœ°å€</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./tcp_hping.sh IPç½‘æ®µ</code></strong></li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#ï¼/bin/bash</span><br><span class="line">if [ &quot;$#&quot; -ne 1 ];then</span><br><span class="line">    echo &quot;USAGE - ./tcp_hping.sh [/24 network address]&quot;</span><br><span class="line">    echo &quot;Example - ./tcp_hping.sh 192.168.100.0&quot;</span><br><span class="line">    echo &quot;Example will perform an TCP scan of the 192.168.100.0/24 network and output.txt file&quot;</span><br><span class="line">    exit</span><br><span class="line">fi</span><br><span class="line">prefix=$(echo $1 | cut -d &quot;.&quot; -f 1-3)</span><br><span class="line">for addr in $(seq 1 254);do</span><br><span class="line">    hping3 $prefix.$addr -c 1 &gt;&gt; r.txt;</span><br><span class="line">done</span><br><span class="line">grep Unreachable r.txt | cut -d &quot;&quot; -f 5 | cut -d &quot;=&quot; -f 2 &gt;&gt; output.txt</span><br><span class="line">rm r.txt</span><br></pre></td></tr></table></figure>


<blockquote>
<pre><code>hping3ä¸æ˜¯å‘ACKçš„TCPåŒ…ï¼Œæ˜¯flag0çš„TCPåŒ…ï¼Œéœ€è¦æ”¶å›ACKã€RSTçš„TCPåŒ…
nmapå’ŒScapyå‘çš„æ˜¯ACKçš„TCPåŒ…ï¼Œæ˜¯flag16çš„TCPåŒ…ï¼Œéœ€è¦æ”¶å›RSTçš„TCPåŒ…</code></pre></blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E4%B9%9D)%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%89%AB%E6%8F%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E4%B9%9D)%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%89%AB%E6%8F%8F/" itemprop="url">Kali Linuxç¬”è®°(åä¹)ï¼šæœåŠ¡æ‰«æ</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  1.5k å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  6 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-æœåŠ¡æ‰«æï¼ˆä¸èƒ½ç®€å•é€šè¿‡ç«¯å£å·æ¥åˆ¤æ–­ç«¯å£ä¸Šçš„æœåŠ¡ï¼‰"><a href="#1-æœåŠ¡æ‰«æï¼ˆä¸èƒ½ç®€å•é€šè¿‡ç«¯å£å·æ¥åˆ¤æ–­ç«¯å£ä¸Šçš„æœåŠ¡ï¼‰" class="headerlink" title="1. æœåŠ¡æ‰«æï¼ˆä¸èƒ½ç®€å•é€šè¿‡ç«¯å£å·æ¥åˆ¤æ–­ç«¯å£ä¸Šçš„æœåŠ¡ï¼‰"></a>1. æœåŠ¡æ‰«æï¼ˆä¸èƒ½ç®€å•é€šè¿‡ç«¯å£å·æ¥åˆ¤æ–­ç«¯å£ä¸Šçš„æœåŠ¡ï¼‰</h4><ul>
<li>è¯†åˆ«å¼€æ”¾ç«¯å£ä¸Šè¿è¡Œçš„åº”ç”¨</li>
<li>è¯†åˆ«ç›®æ ‡æ“ä½œç³»ç»Ÿ</li>
<li>æé«˜æ”»å‡»æ•ˆç‡<ul>
<li>Banneræ•è·ï¼ˆæœ€ä¸»è¦ï¼Œæœ€ç®€å•ï¼Œå‡†ç¡®æ€§ä¸é«˜ï¼‰</li>
<li>æœåŠ¡è¯†åˆ«</li>
<li>æ“ä½œç³»ç»Ÿè¯†åˆ«</li>
<li>SNMPåˆ†æï¼ˆé€šè¿‡ç³»ç»Ÿå†…éƒ¨ä¿¡æ¯æ¥è¿›è¡Œæ¢ç´¢ï¼‰</li>
<li>é˜²ç«å¢™è¯†åˆ«ï¼ˆè¯†åˆ«è¾¹ç•Œé˜²ç«å¢™ï¼Œè¿‡æ»¤æœºåˆ¶ï¼Œè¿›è¡Œç»•è¿‡ï¼‰</li>
</ul>
</li>
<li>Banner<ul>
<li>è½¯ä»¶å¼€å‘å•†</li>
<li>è½¯ä»¶åç§°</li>
<li>æœåŠ¡ç±»å‹</li>
<li>ç‰ˆæœ¬å·ï¼ˆç›´æ¥å‘ç°å·²çŸ¥çš„æ¼æ´å’Œå¼±ç‚¹ï¼‰</li>
</ul>
</li>
<li>è¿æ¥å»ºç«‹åç›´æ¥è·å–banner</li>
<li>å¦ç±»æœåŠ¡è¯†åˆ«æ–¹æ³•<ul>
<li>ç‰¹å¾è¡Œä¸ºå’Œå“åº”å­—æ®µï¼ˆæŒ‡çº¹ä¿¡æ¯ï¼‰</li>
<li>ä¸ç”¨çš„å“åº”å¯ç”¨äºè¯†åˆ«åº•å±‚æ“ä½œç³»ç»Ÿ</li>
</ul>
</li>
<li>SNMPï¼ˆé»˜è®¤å°±æ˜¯publicï¼Œå¯è¯»å¯å†™privateï¼Œpublicå¯æŸ¥çœ‹äº¤æ¢æœºä¿¡æ¯ï¼‰<ul>
<li>ç®€å•ç½‘ç»œç®¡ç†åè®®</li>
<li>Community strings</li>
<li>ä¿¡æ¯æŸ¥è¯¢æˆ–é‡æ–°é…ç½®</li>
</ul>
</li>
<li>è¯†åˆ«å’Œç»•è¿‡é˜²ç«å¢™ç­›é€‰</li>
</ul>
<h4 id="2-æœåŠ¡æ‰«æ-Banner"><a href="#2-æœåŠ¡æ‰«æ-Banner" class="headerlink" title="2. æœåŠ¡æ‰«æ-Banner"></a>2. æœåŠ¡æ‰«æ-Banner</h4><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnc -nv IPåœ°å€ ç«¯å£å·</code></strong>ï¼ˆæŸ¥çœ‹ç«¯å£bannerä¿¡æ¯ï¼‰</li>
</ul>
<h4 id="3-æœåŠ¡æ‰«æ-Banner"><a href="#3-æœåŠ¡æ‰«æ-Banner" class="headerlink" title="3. æœåŠ¡æ‰«æ-Banner"></a>3. æœåŠ¡æ‰«æ-Banner</h4><ul>
<li>Python socketï¼ˆsocketç¼ºä¹å¯¹åº”ç”¨å±‚æ•°æ®åŒ…çš„å®šä¹‰ï¼Œæ— æ³•å»ºç«‹å®Œæ•´ä¼šè¯ï¼‰<ul>
<li>socketæ¨¡å—ç”¨äºè¿æ¥ç½‘ç»œæœåŠ¡</li>
</ul>
</li>
<li>python</li>
<li>import socket</li>
<li>banner=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</li>
<li>banner.connet((â€œIPåœ°å€â€,ç«¯å£å·))</li>
<li>banner.recv(4096)  ï¼ˆâ€™220(vsftp 2.3.4)\r\nâ€™ï¼‰ </li>
<li>banner.close()</li>
<li>exit()</li>
<li>Bannerä¸å…è®¸æŠ“å–ï¼Œrecvå‡½æ•°æ— è¿”å›å°†æŒ‚èµ·ï¼ï¼</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./ban_grab.py IPåœ°å€ èµ·å§‹ç«¯å£ ç»“æŸç«¯å£</code></strong>  â–²2019.12.6 æš‚æ—¶æ‰«ä¸å‡ºæœåŠ¡</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import socket</span><br><span class="line">import select</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=4:</span><br><span class="line">    print &quot;Usage - ./ban_grab.py [Target IP] [First Port] [Last Port] &quot;</span><br><span class="line">    print &quot;Example - ./ban_grab.py 192.168.100.1 1 200&quot;</span><br><span class="line">    print &quot;Example will grab banners for TCP ports 1 through 100 on 192.168.100.1&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">ip=sys.argv[1]</span><br><span class="line">start=int(sys.argv[2])</span><br><span class="line">end=int(sys.argv[3])</span><br><span class="line"></span><br><span class="line">for port in range(start,end):</span><br><span class="line">    try:</span><br><span class="line">      bangrab=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">      bangrab.connect((ip,port))</span><br><span class="line">      ready=select.select((bangrab),[],[],1)</span><br><span class="line">      if ready[0]:</span><br><span class="line">        print &quot;TCP Port &quot;+str[port]+&quot;-&quot;+bangrab.recv[4096]</span><br><span class="line">        bangrab.close()</span><br><span class="line">    except:</span><br><span class="line">      pass</span><br></pre></td></tr></table></figure>

<h4 id="4-æœåŠ¡æ‰«æ-Banner"><a href="#4-æœåŠ¡æ‰«æ-Banner" class="headerlink" title="4. æœåŠ¡æ‰«æ-Banner"></a>4. æœåŠ¡æ‰«æ-Banner</h4><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šdmitry -pï¼ˆTCPæ‰«æï¼‰IPåœ°å€</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šdmitry -pbï¼ˆTCPæ‰«æbannerä¿¡æ¯ï¼‰ IPåœ°å€</code></strong></li>
</ul>
<h4 id="5-æœåŠ¡æ‰«æ-Banner"><a href="#5-æœåŠ¡æ‰«æ-Banner" class="headerlink" title="5. æœåŠ¡æ‰«æ-Banner"></a>5. æœåŠ¡æ‰«æ-Banner</h4><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap -sTï¼ˆå®Œæ•´çš„TCPè¿æ¥ï¼‰ IPåœ°å€ -p ç«¯å£ --script=banner.nse</code></strong></li>
</ul>
<blockquote>
<pre><code>nmapæ‰«æè„šæœ¬ï¼š/usr/share/nmap/script</code></pre></blockquote>
<h4 id="6-æœåŠ¡æ‰«æ-Banner"><a href="#6-æœåŠ¡æ‰«æ-Banner" class="headerlink" title="6. æœåŠ¡æ‰«æ-Banner"></a>6. æœåŠ¡æ‰«æ-Banner</h4><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šamap -Bï¼ˆä¸“é—¨å‘ç°æŒ‡å®šç«¯å£ä¸Šçš„bannerä¿¡æ¯ï¼‰ IPåœ°å€ ç«¯å£</code></strong></li>
</ul>
<h4 id="7-æœåŠ¡æ‰«æ-æœåŠ¡è¯†åˆ«"><a href="#7-æœåŠ¡æ‰«æ-æœåŠ¡è¯†åˆ«" class="headerlink" title="7. æœåŠ¡æ‰«æ-æœåŠ¡è¯†åˆ«"></a>7. æœåŠ¡æ‰«æ-æœåŠ¡è¯†åˆ«</h4><ul>
<li>Bannerä¿¡æ¯æŠ“å–èƒ½åŠ›æœ‰é™</li>
<li>nmapå“åº”ç‰¹å¾åˆ†æè¯†åˆ«æœåŠ¡<ul>
<li>å‘ç°ç³»åˆ—å¤æ‚çš„æ¢æµ‹</li>
<li>ä¾æ®å“åº”ç‰¹å¾signature</li>
</ul>
</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnv -nv IPåœ°å€ ç«¯å£</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap IPåœ°å€ -p ç«¯å£</code></strong>-sVï¼ˆè¯†åˆ«ç«¯å£åé¢æœåŠ¡ï¼Œé€šè¿‡æŒ‡çº¹åŒ¹é…çš„æ–¹å¼ï¼Œä¸å•æ˜¯bannerä¿¡æ¯ï¼‰</li>
</ul>
<h4 id="8-æœåŠ¡æ‰«æ-æœåŠ¡è¯†åˆ«"><a href="#8-æœåŠ¡æ‰«æ-æœåŠ¡è¯†åˆ«" class="headerlink" title="8. æœåŠ¡æ‰«æ-æœåŠ¡è¯†åˆ«"></a>8. æœåŠ¡æ‰«æ-æœåŠ¡è¯†åˆ«</h4><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šAmap</code></strong>ï¼ˆè¿˜æ˜¯åŸºäºbannerä¿¡æ¯è¿›è¡Œè¯†åˆ«ï¼‰</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šamap IPåœ°å€</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šamap IPåœ°å€ ç«¯å£å·</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šamap IPåœ°å€ ç«¯å£å· -q</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šamap IPåœ°å€ ç«¯å£å· -qb</code></strong></li>
</ul>
<h4 id="9-SNMPæ‰«æï¼ˆé€šä¿¡ï¼š101å’Œ102ï¼Œè¢«æŸ¥è¯¢çš„æœåŠ¡ç«¯ï¼š161ï¼Œå®¢æˆ·ç«¯ï¼š162-â†’-udpï¼‰"><a href="#9-SNMPæ‰«æï¼ˆé€šä¿¡ï¼š101å’Œ102ï¼Œè¢«æŸ¥è¯¢çš„æœåŠ¡ç«¯ï¼š161ï¼Œå®¢æˆ·ç«¯ï¼š162-â†’-udpï¼‰" class="headerlink" title="9. SNMPæ‰«æï¼ˆé€šä¿¡ï¼š101å’Œ102ï¼Œè¢«æŸ¥è¯¢çš„æœåŠ¡ç«¯ï¼š161ï¼Œå®¢æˆ·ç«¯ï¼š162 â†’ udpï¼‰"></a>9. SNMPæ‰«æï¼ˆé€šä¿¡ï¼š101å’Œ102ï¼Œè¢«æŸ¥è¯¢çš„æœåŠ¡ç«¯ï¼š161ï¼Œå®¢æˆ·ç«¯ï¼š162 â†’ udpï¼‰</h4><ul>
<li>snmpï¼ˆæ˜æ–‡ä¼ è¾“ï¼Œå¯è¢«å—…æ¢åˆ°ï¼‰<ul>
<li>ä¿¡æ¯çš„é‡‘çŸ¿ï¼ˆè®¾å¤‡çš„è¯¦ç»†å†…å®¹ï¼‰</li>
<li>ç»å¸¸è¢«é”™è¯¯é…ç½®ï¼ˆç‰¹å¾å­—ç¬¦ï¼Œcommunityï¼‰</li>
<li>public/private/mnager</li>
</ul>
</li>
<li>MIB Tree<ul>
<li>SNMP Management Information Baseï¼ˆMIBï¼‰</li>
<li>æ ‘å½¢çš„ç½‘ç»œè®¾å¤‡ç®¡ç†åŠŸèƒ½æ•°æ®åº“</li>
<li>1.3.6.1.4.1.77.1.2.25ï¼ˆOIDï¼‰</li>
</ul>
</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šonesixtyone IPåœ°å€ public</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šonesixtyone -cï¼ˆå­—å…¸ï¼‰ dict.txt -iï¼ˆå¤šä¸ªä¸»æœºåˆ—è¡¨ï¼‰ host -o my.log -w 100</code></strong></li>
</ul>
<blockquote>
<pre><code>Window XPå®‰è£… â†’ ç¨‹åºè½¯ä»¶å®‰è£… â†’ æ·»åŠ ç»„ä»¶ â†’ ç®¡ç†å’Œç›‘è§†ï¼ˆæœ‰å¯èƒ½éœ€è¦å®‰è£…å…‰ç›˜ï¼‰
services.msc snmpæœåŠ¡ï¼Œå¯æ·»åŠ ä»£ç†ï¼Œé™·é˜±ï¼ˆsnmpä½œä¸ºå®¢æˆ·ç«¯ï¼‰ï¼Œé»˜è®¤å®‰è£…publicä½œä¸ºcommuityï¼Œç„¶åæ¥å—æ¥è‡ªä»»ä½•ä¸»æœºçš„SNMPæŸ¥è¯¢åŒ…</code></pre></blockquote>
<h4 id="10-SNMPæ‰«æ"><a href="#10-SNMPæ‰«æ" class="headerlink" title="10. SNMPæ‰«æ"></a>10. SNMPæ‰«æ</h4><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šsnmpwalk IPåœ°å€ -c public -vï¼ˆsnmpç‰ˆæœ¬ï¼‰ 2c</code></strong></li>
<li>ç”¨æˆ·<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šsnmp -c publuc -v 2c IPåœ°å€ 1.3.6.1.4.1.77.1.2.25</code></strong>ï¼ˆMIB All IDï¼‰</li>
</ul>
</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šsnmpcheck -t</code></strong>ï¼ˆç›®æ ‡ä¸»æœºï¼‰ IPåœ°å€ï¼ˆé»˜è®¤æƒ…å†µä¸‹æ˜¯publicï¼Œå¯ä»¥ç”¨-cå»ä¿®æ”¹communityï¼‰</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šsnmpcheck -t IPåœ°å€ -c private -v 2</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šsnmpcheck -t IPåœ°å€ -p agent w</code></strong>ï¼ˆæ£€æµ‹æ˜¯å¦æœ‰å¯å†™æƒé™ï¼‰</li>
</ul>
<blockquote>
<pre><code>SNMPç‰ˆæœ¬ï¼šv1ï¼Œv2cï¼Œv3ï¼ˆå¤§é‡å®‰å…¨æœºåˆ¶ï¼‰</code></pre></blockquote>
<h4 id="11-SMBæ‰«æ"><a href="#11-SMBæ‰«æ" class="headerlink" title="11. SMBæ‰«æ"></a>11. SMBæ‰«æ</h4><ul>
<li><p>Server Message Block åè®®</p>
<ul>
<li>å¾®è½¯å†å²ä¸Šå‡ºç°å®‰å…¨é—®é¢˜æœ€å¤šçš„åè®®</li>
<li>å®ç°å¤æ‚</li>
<li>é»˜è®¤å¼€æ”¾</li>
<li>æ–‡ä»¶å…±äº«</li>
<li>ç©ºä¼šè¯æœªèº«ä»½è®¤è¯è®¿é—®ï¼ˆSMB1ï¼‰</li>
</ul>
<ol>
<li>å¯†ç ç­–ç•¥</li>
<li>ç”¨æˆ·å</li>
<li>ç»„å</li>
<li>æœºå™¨å</li>
<li>ç”¨æˆ·ã€ç»„SIDï¼ˆAdminastratoråœ¨windowä¸­SIDé»˜è®¤ä¸º500ï¼‰</li>
</ol>
</li>
<li><p><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap -vï¼ˆè¯¦ç»†ç»“æœï¼‰ -p 139,445 IPåœ°å€</code></strong>ï¼ˆè¾ƒç²—ç³™æ‰«æï¼Œè¿˜ä¸èƒ½åˆ¤æ–­winè¿˜æ˜¯linuxï¼‰</p>
</li>
<li><p><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap IPåœ°å€ -p139,445 --script=smb-os-discovery.nse</code></strong></p>
</li>
<li><p><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap -v -p 139,445 --script=smb-check-vulns --script-args=unsafe=1ï¼ˆè¿›è¡Œä¸å®‰å…¨çš„æ‰«æï¼Œå¿«ï¼Œå‡†ç¡®ï¼Œå¯èƒ½ä¼šå®•æœºï¼‰ IPåœ°å€</code></strong> â–²2019.12.6 scriptæ— smb-check-vulnsè„šæœ¬</p>
</li>
<li><p><strong><code>ğŸ”ºå‘½ä»¤ï¼šnbtscan -r IPç½‘æ®µ/24ï¼ˆå¯ä»¥æ‰«å‡ºå…¶ä»–ç½‘æ®µçš„MACåœ°å€ï¼‰</code></strong>â–²2019.12.6æµ‹è¯•æš‚ä¸å¯æ‰«å‡º</p>
</li>
<li><p><strong><code>ğŸ”ºå‘½ä»¤ï¼šenum4linux -a IPåœ°å€</code></strong></p>
</li>
</ul>
<blockquote>
<pre><code>SMB Vulnsï¼ˆé’ˆå¯¹çš„æ˜¯Windowç³»ç»Ÿï¼‰
MS08-067ï¼Œa windpws RPC vulnerability
Confickerï¼Œan infection by the Conficker worm
Unnamed regsc Dosï¼Œa denial-of-service vulnerability I accidentally found in windows 2000
SMBv2 exploitï¼ˆCVE-2009-3103ï¼ŒMicrosoft Security Advisory 975497ï¼‰
MS06-025ï¼Œa windows Ras RPC service vulnerability
MS07-029ï¼Œa windows Dns Server RPC Service vulnerability
MS09-001ï¼Œa windows Code execution from remote</code></pre></blockquote>
<blockquote>
<pre><code>SMBæœåŠ¡ï¼š
&lt;00&gt;   Workstation Serviceï¼ˆå…±äº«åˆ«äººçš„æ–‡ä»¶ï¼‰
&lt;03&gt;   Messenger Service
&lt;20&gt;   File Server Serviceï¼ˆå¯¹åˆ«äººçš„æ–‡ä»¶å…±äº«ï¼‰
&lt;1e&gt;   Browser Service Electionsï¼ˆæµè§ˆå™¨æœåŠ¡ï¼‰
â–² windowä¸‹ä¸»æœºçš„SID  ç”¨æˆ·çš„RID
â–² linuxä¸‹ä¸»æœº uidï¼Œgidï¼Œgroups</code></pre></blockquote>
<h4 id="12-SMTPæ‰«æï¼ˆå‘ç°ç›®æ ‡ç³»ç»Ÿçš„é‚®ä»¶è´¦å·ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¢«åŠ¨ä¿¡æ¯æ”¶é›†ï¼‰"><a href="#12-SMTPæ‰«æï¼ˆå‘ç°ç›®æ ‡ç³»ç»Ÿçš„é‚®ä»¶è´¦å·ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¢«åŠ¨ä¿¡æ¯æ”¶é›†ï¼‰" class="headerlink" title="12. SMTPæ‰«æï¼ˆå‘ç°ç›®æ ‡ç³»ç»Ÿçš„é‚®ä»¶è´¦å·ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¢«åŠ¨ä¿¡æ¯æ”¶é›†ï¼‰"></a>12. SMTPæ‰«æï¼ˆå‘ç°ç›®æ ‡ç³»ç»Ÿçš„é‚®ä»¶è´¦å·ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¢«åŠ¨ä¿¡æ¯æ”¶é›†ï¼‰</h4><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnc -nv IPåœ°å€ ç«¯å£</code></strong><ul>
<li>VRFY rootï¼ˆç¡®è®¤æœ‰æ— rootè´¦å·ï¼‰</li>
</ul>
</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap smtp.163.com -p 25 --script=smtp-enum-users.nse --script-args=smtp-enum-users.methods=VRFY</code></strong>ï¼ˆåé¢å¯åŠ å‚æ•°æŒ‡å®šå­—å…¸æ–‡ä»¶ï¼‰</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap smtp.163.com -p 25 --script=smtp-open-relay.nse --script=smtp-user-enum -M VRFY -Uï¼ˆæŒ‡å®šå­—å…¸ï¼‰ user.txt -t IPåœ°å€</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./smtp.py &lt;username&gt;</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"></span><br><span class="line">import socket</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=2:</span><br><span class="line">    print &quot;Usage: smtp.py &lt;username&gt;&quot;</span><br><span class="line">    sys.exit(0)</span><br><span class="line"></span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">connect=s.connect((&quot;IPåœ°å€&quot;,ç«¯å£))</span><br><span class="line">banner=s.recv(4096)</span><br><span class="line">print banner+&quot;aaaaa&quot;</span><br><span class="line">s.send(&apos;VRFY&apos;+sys.argv[1]+&apos;\r\n&apos;)</span><br><span class="line">result=s.recv(4096)</span><br><span class="line">print result</span><br><span class="line">s.close</span><br></pre></td></tr></table></figure>

<blockquote>
<pre><code>é‚®ä»¶æœåŠ¡å™¨å¼€æ”¾ä¸­ç»§ï¼Œå…è®¸å…¶ä»–äººç”¨é‚®ä»¶æœåŠ¡å™¨å¯¹å…¶ä»–äººå‘é‚®ä»¶ï¼Œæˆä¸ºè‚‰é¸¡</code></pre></blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E5%85%AB)%EF%BC%9A%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F--TCP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%8D%81%E5%85%AB)%EF%BC%9A%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F--TCP/" itemprop="url">Kali Linuxç¬”è®°(åå…«)ï¼šç«¯å£æ‰«æ--TCP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  1.6k å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  8 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-ç«¯å£æ‰«æï¼ˆTCPï¼‰"><a href="#1-ç«¯å£æ‰«æï¼ˆTCPï¼‰" class="headerlink" title="1. ç«¯å£æ‰«æï¼ˆTCPï¼‰"></a>1. ç«¯å£æ‰«æï¼ˆTCPï¼‰</h4><ul>
<li><p>TCPç«¯å£æ‰«æï¼ˆSYNâ€“SYN/ACKâ€“ACKï¼‰</p>
<ul>
<li>åŸºäºè¿æ¥çš„åè®®</li>
<li>ä¸‰æ¬¡æ¡æ‰‹ï¼ˆACKåŒ…è¿æ¥ï¼‰</li>
<li>éšè”½æ‰«æï¼ˆéšè—ä¸ç›®æ ‡è¿›ç¨‹çš„ä¼šè¯ï¼‰â€“SYNï¼ˆå¼€æ”¾ â†’SYN/ACKï¼Œä¸å¼€æ”¾ â†’ RSTï¼‰</li>
</ul>
<ol>
<li>ä¸å»ºç«‹å®Œæ•´è¿æ¥ï¼ˆSYNï¼ˆå¼€æ”¾ â†’SYN/ACKï¼Œä¸å¼€æ”¾ â†’ RSTï¼‰ï¼‰</li>
<li>åº”ç”¨æ—¥å¿—ä¸è®°å½•æ‰«æè¡Œä¸ºâ€“éšè”½ï¼ˆä½†å®¡è®¡ç½‘ç»œå±‚ï¼Œè¿˜æ˜¯å¯ä»¥å‘ç°ï¼‰</li>
</ol>
<ul>
<li>åƒµå°¸æ‰«æï¼ˆå‡ ä¹ä¸å’Œç›®æ ‡è¿›ç¨‹å°è¯•ä¼šè¯ï¼‰</li>
</ul>
<ol>
<li>æåº¦éšè”½</li>
<li>å®æ–½æ¡ä»¶è‹›åˆ»</li>
<li>å¯ä¼ªé€ æºåœ°å€ï¼ˆâ–²æ‰«æè€…ä¸ç›®æ ‡ä¸»æœºå¿…é¡»å¯ä»¥å®ç°åœ°å€ä¼ªé€ ï¼‰</li>
<li>é€‰æ‹©åƒµå°¸æœºï¼ˆâ–²å¿…é¡»è¦æœ‰ï¼Œç½‘ç»œä¸­é—²ç½®çš„æœºå­ï¼Œä¸åŒäºåƒµå°¸ç½‘ç»œçš„æœºå­ï¼‰<ul>
<li>é—²ç½®ç³»ç»Ÿ</li>
<li>ç³»ç»Ÿä½¿ç”¨é€’å¢çš„IPIDï¼šï¼ˆ1ï¼‰ä¸èƒ½ä¸º0 ï¼ˆ2ï¼‰ä¸èƒ½ä¸ºéšæœº</li>
</ul>
</li>
</ol>
<ul>
<li>å…¨è¿æ¥æ‰«æï¼ˆä¸‰æ¬¡æ¡æ‰‹è¿æ¥ï¼‰</li>
<li>æ‰€æœ‰çš„TCPæ‰«ææ–¹å¼éƒ½æ˜¯åŸºäºä¸‰æ¬¡æ¡æ‰‹çš„å˜åŒ–æ¥åˆ¤æ–­ç›®æ ‡ç«¯å£çŠ¶æ€</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>IPID:IPæŠ¥å¤´é‡Œé¢çš„Identificationå­—æ®µ
1.åƒµå°¸æ‰«æè¿‡ç¨‹ï¼ˆç«¯å£å¼€æ”¾ï¼‰ï¼š
ï¼ˆ1ï¼‰Scannerã€SYN/ACKã€‘ -- Zombieã€RST IPID=Xã€‘
ï¼ˆ2ï¼‰Scannerã€SYN IPSRC=zombieã€‘ -- targetã€SYN/ACKã€‘ -- Zombieã€RST IPID=x+1,(åƒµå°¸æœºéœ€è¦è¶³å¤Ÿç©ºé—²)ã€‘
ï¼ˆ3ï¼‰Scannerã€SYN/ACKã€‘ -- Zombieã€RST IPID=x+2ã€‘
2.åƒµå°¸æ‰«æè¿›ç¨‹ï¼ˆç«¯å£æœªå¼€æ”¾ï¼‰ï¼š
ï¼ˆ1ï¼‰Scannerã€SYN/ACKã€‘ -- Zombieã€RST IPID=Xã€‘
ï¼ˆ2ï¼‰Scannerã€SYN IPSRC=zombieã€‘ -- targetã€RSTã€‘ -- Zombie
ï¼ˆ3ï¼‰Scannerã€SYN/ACKã€‘ -- Zombieã€RST IPID=x+1ã€‘</code></pre></blockquote>
<h4 id="2-éšè”½ç«¯å£æ‰«æ"><a href="#2-éšè”½ç«¯å£æ‰«æ" class="headerlink" title="2. éšè”½ç«¯å£æ‰«æ"></a>2. éšè”½ç«¯å£æ‰«æ</h4><ul>
<li>synâ€“syn/ackâ€“rstï¼ˆæœ¬æœºæ“ä½œç³»ç»Ÿå†…æ ¸äº§ç”Ÿçš„ï¼‰</li>
<li>Scapy<ul>
<li>sr1(IP(dst=â€IPåœ°å€â€)/TCP(dport=80,flags=â€Sâ€),timeout=1,verbose=0)</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./syn_scan.py ç›®æ ‡IPåœ°å€ èµ·å§‹ç«¯å£ ç»“æŸç«¯å£</code></strong></li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">logging.getLogger(&quot;scapy.runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import *</span><br><span class="line">import time</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=4:</span><br><span class="line">    print &quot;Usage - ./syn_scan.py [Target IP] [First IP] [Last IP] &quot;</span><br><span class="line">    print &quot;Example - ./syn_scan.py 192.168.100.1 1 200&quot;</span><br><span class="line">    print &quot;Example will perform a TCP SYN scan of the 192.168.100.0/24 range&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">ip=sys.argv[1]</span><br><span class="line">start=int(sys.argv[2])</span><br><span class="line">end=int(sys.argv[3])</span><br><span class="line"></span><br><span class="line">for port in range(start,end):</span><br><span class="line">    a=sr1(IP(dst=ip)/TCP(dport=port),timeout=1,verbose=0)</span><br><span class="line">    if a==None:</span><br><span class="line">      pass</span><br><span class="line">    else:</span><br><span class="line">      if int(a[TCP].flags)==18:</span><br><span class="line">        print port</span><br><span class="line">      else:</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure>

<blockquote>
<pre><code>æ­£å¸¸æƒ…å†µä¸‹ï¼š
ç«¯å£å¼€æ”¾ï¼šsyn--syn/ack
ç«¯å£æœªå¼€æ”¾ï¼šsyn--rst/ack</code></pre></blockquote>
<h4 id="3-éšè”½ç«¯å£æ‰«æ"><a href="#3-éšè”½ç«¯å£æ‰«æ" class="headerlink" title="3. éšè”½ç«¯å£æ‰«æ"></a>3. éšè”½ç«¯å£æ‰«æ</h4><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap -sS IPåœ°å€ -p 80,21,25,110,443</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap -sS IPåœ°å€ -p 1-65535 --open</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap -sS IPåœ°å€ --open</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap -sS -iL iplist.txt -p 80,21,22,23</code></strong></li>
</ul>
<h4 id="4-éšè”½ç«¯å£æ‰«æ"><a href="#4-éšè”½ç«¯å£æ‰«æ" class="headerlink" title="4. éšè”½ç«¯å£æ‰«æ"></a>4. éšè”½ç«¯å£æ‰«æ</h4><ul>
<li>hping3ï¼ˆå‘åŒ…ä¹ æƒ¯æ˜¯é¡ºåºç«¯å£ï¼‰</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šhping3 IPåœ°å€ --scan 80 -S</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šhping3 IPåœ°å€ --scan 80,21,25,443 -S</code></strong>ï¼ˆsynåŒ…ï¼‰</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šhping3 IPåœ°å€ --scan 0-65535 -S</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šhping3 -c 10 -S --spoofï¼ˆä¼ªé€ æºåœ°å€ï¼‰ IPåœ°å€ -p ++1ï¼ˆç«¯å£é€’å¢ï¼‰ IPåœ°å€</code></strong></li>
</ul>
<h4 id="5-å…¨è¿æ¥ç«¯å£æ‰«æ"><a href="#5-å…¨è¿æ¥ç«¯å£æ‰«æ" class="headerlink" title="5. å…¨è¿æ¥ç«¯å£æ‰«æ"></a>5. å…¨è¿æ¥ç«¯å£æ‰«æ</h4><ul>
<li>Scapyï¼ˆå®¹æ˜“è§¦å‘ç›®æ ‡ä¸»æœºçš„æŠ¥è­¦ç³»ç»Ÿï¼‰<ul>
<li>synæ‰«æä¸éœ€è¦raw packets</li>
<li>å†…æ ¸è®¤ä¸ºsyn/ackæ˜¯éæ³•åŒ…ï¼Œç›´æ¥å‘rstç»ˆæ–­è¿æ¥</li>
<li>å…¨è¿æ¥æ‰«æå¯¹scapyæ¯”è¾ƒå›°éš¾</li>
</ul>
</li>
<li>sr1(IP(dst=â€IPåœ°å€â€)/TCP(dport=22,flags=â€Sâ€))</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./tcp_scan1.pyï¼ˆä»£ç å†…æŒ‡å®šIPåœ°å€ï¼‰</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">logging.getLogger(&quot;scapy,runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import*</span><br><span class="line"></span><br><span class="line">response=sr1(IP(dst=&quot;IPåœ°å€&quot;)/TCP(dport=80,flags=&quot;S&quot;))</span><br><span class="line">reply=sr1(IP(dst=&quot;IPåœ°å€&quot;)/TCP(dport=80,flags=&quot;A&quot;,ack=(response[TCP].seq+1)))</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./tcp_scan2.pyï¼ˆä»£ç å†…æŒ‡å®šIPåœ°å€ï¼‰</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">logging.getLogger(&quot;scapy,runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import*</span><br><span class="line"></span><br><span class="line">SYN=IP(dst=&quot;IPåœ°å€&quot;)/TCP(dport=25,flags=&quot;S&quot;)</span><br><span class="line"></span><br><span class="line">print &quot;--SENT--&quot;</span><br><span class="line">SYN.display()</span><br><span class="line"></span><br><span class="line">print &quot;\n\n--RECEIVED--&quot;</span><br><span class="line">response=sr1(SYN,timeout=1,verbose=0)</span><br><span class="line">response.display()</span><br><span class="line"></span><br><span class="line">if int(response[TCP].flags)==18:</span><br><span class="line">    print &quot;\n\n--SENT--&quot;</span><br><span class="line">    A=IP(dst=&quot;IPåœ°å€&quot;)/TCP(dport=25,flags=&quot;A&quot;,ack=(response[TCP].seq+1))</span><br><span class="line">    A.display()</span><br><span class="line">    print &quot;\n\n--RECEIVED--&quot;</span><br><span class="line">    response2=sr1(A,timeout=1,verbose=0)</span><br><span class="line">    response2.display()</span><br><span class="line">else:</span><br><span class="line">    print &quot;SYN-ACK not returned&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šiptables -A OUTPUT -p tcp --tcp-flags RST RST -d ç›®æ ‡IPåœ°å€ -j DROP</code></strong></li>
</ul>
<blockquote>
<pre><code>iptablesæ˜¯å·¥ä½œåœ¨åº•å±‚çš„é˜²ç«å¢™ï¼Œåœ¨å†…æ ¸ä¹‹å‰è¿‡æ»¤æ•°æ®
iptables -LæŸ¥çœ‹å½“å‰é˜²ç«å¢™è§„åˆ™</code></pre></blockquote>
<h4 id="6-å…¨è¿æ¥ç«¯å£æ‰«æ"><a href="#6-å…¨è¿æ¥ç«¯å£æ‰«æ" class="headerlink" title="6. å…¨è¿æ¥ç«¯å£æ‰«æ"></a>6. å…¨è¿æ¥ç«¯å£æ‰«æ</h4><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap IPåœ°å€ -sT -p 80</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap IPåœ°å€ -sT -p 80,21,25</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap IPåœ°å€ -sT -p 1-65535</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap -sT -iL iplist.txt -p 80</code></strong></li>
<li>é»˜è®¤1000ä¸ªå¸¸ç”¨ç«¯å£</li>
</ul>
<h4 id="7-å…¨è¿æ¥ç«¯å£æ‰«æ"><a href="#7-å…¨è¿æ¥ç«¯å£æ‰«æ" class="headerlink" title="7. å…¨è¿æ¥ç«¯å£æ‰«æ"></a>7. å…¨è¿æ¥ç«¯å£æ‰«æ</h4><ul>
<li>dmitry<ul>
<li>åŠŸèƒ½ç®€å•ï¼Œä½†ä½¿ç”¨ç®€ä¾¿</li>
<li>é»˜è®¤150ä¸ªå¸¸ç”¨ç«¯å£</li>
</ul>
</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šdmitry -p IPåœ°å€</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šdmitry -p IPåœ°å€ -o output</code></strong></li>
</ul>
<h4 id="8-å…¨è¿æ¥ç«¯å£æ‰«æ"><a href="#8-å…¨è¿æ¥ç«¯å£æ‰«æ" class="headerlink" title="8. å…¨è¿æ¥ç«¯å£æ‰«æ"></a>8. å…¨è¿æ¥ç«¯å£æ‰«æ</h4><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnc -nv -wï¼ˆè¿æ¥çš„è¶…æ—¶æ—¶é—´ï¼‰1 -z IPåœ°å€ 1-65535</code></strong>ï¼ˆå€’åºå‘é€ï¼‰</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šfor x in $(seq 20 30);do nc -nv -w 1 -z IPåœ°å€ $x;done | grep open</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šfor x in $(seq 1 254);do nc -nv -w 1 -z 1.1.1.$x 80;done</code></strong></li>
</ul>
<h4 id="9-åƒµå°¸æ‰«æ"><a href="#9-åƒµå°¸æ‰«æ" class="headerlink" title="9. åƒµå°¸æ‰«æ"></a>9. åƒµå°¸æ‰«æ</h4><blockquote>
<pre><code>æ—©æœŸçš„Windowç³»ç»Ÿï¼ŒåŒ…æ‹¬XP,2003,98ç³»ç»Ÿçš„IPIDæ˜¯é€’å¢çš„</code></pre></blockquote>
<ul>
<li>Scapyâ€“zomebie.py<ul>
<li>i=IP()</li>
<li>t=TCP()</li>
<li>rz=(i/t)</li>
<li>rt=(i/t)</li>
<li>rz[IP].dst=â€zombie IPåœ°å€â€</li>
<li>rz[TCP].dport=445</li>
<li>rz[TCP].flags=â€SAâ€</li>
<li>rt[IP].src=â€zombie IPåœ°å€â€</li>
<li>rt[IP].dst=â€target IPåœ°å€â€</li>
<li>rt[TCP].dport=22</li>
<li>rt[TCP].flags=â€Sâ€</li>
<li>az1=sr1(rz) / at=sr1(rt,timeout=1) / az2=sr1(rz)</li>
<li>az1.display() / az2.display()</li>
</ul>
</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š./zombie.py</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import logging</span><br><span class="line">logging.getLogger(&quot;scapy,runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">from scapy.all import*</span><br><span class="line"></span><br><span class="line">def ipid(zombie):</span><br><span class="line">    reply1=sr1(IP(dst=zombie)/TCP(flags=&quot;SA&quot;),timeout=2,verbose=0)</span><br><span class="line">    send(IP(dst=zombie)/TCP(flags=&quot;SA&quot;),verbose=0)</span><br><span class="line">    reply2=sr1(IP(dst=zombie)/TCP(flags=&quot;SA&quot;),timeout=2,verbose=0)</span><br><span class="line">    if reply2[IP].id==(reply1[IP].id+2):</span><br><span class="line">      print &quot;IPID sequence is incremental and target appears to be idle.ZOMBIE LOCATED&quot;</span><br><span class="line">      response=raw_input(&quot;DO you want to use this zombie to perfore scan?(Y or N):&quot;)</span><br><span class="line">      if response==&quot;Y&quot;:</span><br><span class="line">        target=raw_input(&quot;Enter the IP Address of the target system:&quot;)</span><br><span class="line">        zombiescant(target,zombie)</span><br><span class="line">    else:</span><br><span class="line">      print &quot;Either the IPID sequence is not incremental or the target is not idle.NOT A GOOD ZOMBIE&quot;</span><br><span class="line"></span><br><span class="line">def zombiescan(target,zombie):</span><br><span class="line">    print &quot;\nScanning target &quot;+target+&quot; with zombie &quot;+zombie</span><br><span class="line">    print &quot;\n-----------Open Ports On Target-------------\n &quot;</span><br><span class="line">    for port in range(1,100):</span><br><span class="line">      try:</span><br><span class="line">        start_val=sr1(IP(dst=zombie)/TCP(flags=&quot;SA&quot;,dport=port),timeout=2,verbose=0)</span><br><span class="line">        send(IP(src=zombie,dst=target)/TCP(flags=&quot;S&quot;,dport=port),verbose=0)</span><br><span class="line">        end_val=sr1(IP(dst=zombie)/TCP(flags=&quot;SA&quot;,dport=port),timeout=2,verbose=0)</span><br><span class="line">        if end_val[IP].id==(start_val[IP].id+2):</span><br><span class="line">          print port</span><br><span class="line">      except:</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">print &quot;----------------Zombie Scan Suite-----------\n&quot;</span><br><span class="line">print &quot;1 - Identify Zombie Host\n&quot;</span><br><span class="line">print &quot;2 - Perform Zombie Scan\n&quot;</span><br><span class="line">ans=raw_input(&quot;Select an Option (1 or 2):&quot;)</span><br><span class="line">if ans==&quot;1&quot;:</span><br><span class="line">    zombie=raw_input(&quot;Enter IP Address to test IPID sequence&quot;)</span><br><span class="line">    ipid(zombie)</span><br><span class="line">else:</span><br><span class="line">    if ans==&quot;2&quot;:</span><br><span class="line">      zombie=raw_input(&quot;Enter IP Address for zombie sysytem:&quot;)</span><br><span class="line">      target=raw_input(&quot;Enter IP Address for scan target:&quot;)</span><br><span class="line">      zombiescan(target,zombie)</span><br></pre></td></tr></table></figure>

<blockquote>
<pre><code>sr1 å‘åŒ…åªæ”¶ä¸€ä¸ªæ•°æ®åŒ…
send å‘åŒ…ä¸æ”¶æ•°æ®åŒ…</code></pre></blockquote>
<h4 id="10-åƒµå°¸æ‰«æ"><a href="#10-åƒµå°¸æ‰«æ" class="headerlink" title="10. åƒµå°¸æ‰«æ"></a>10. åƒµå°¸æ‰«æ</h4><ul>
<li>å‘ç°åƒµå°¸æœº<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap -p445 IPåœ°å€ --script=ipidseq.nse</code></strong></li>
</ul>
</li>
<li>æ‰«æç›®æ ‡<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap targetçš„IPåœ°å€ -sIï¼ˆæŒ‡å®šzombieï¼‰ zomboeçš„IPåœ°å€ -Pn -p 0-100</code></strong></li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%B8%80)%EF%BC%9ANAMP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%B8%80)%EF%BC%9ANAMP/" itemprop="url">Kali Linuxç¬”è®°(äºŒåä¸€)ï¼šNMAP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  681 å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  2 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-NMAP"><a href="#1-NMAP" class="headerlink" title="1. NMAP"></a>1. NMAP</h4><ul>
<li>æ‰€æœ‰å‚æ•°</li>
<li>ç›®æ ‡å‘ç°<ul>
<li>-iL <inputfilename>ï¼ˆåˆ—è¡¨æ–‡ä»¶ä½œä¸ºè¾“å…¥ï¼‰</li>
<li>-iR <num hosts>ï¼ˆéšæœºé€‰æ‹©ç›®æ ‡è¿›è¡Œæ‰«æï¼‰</li>
<li>â€“exclude &lt;host1[,host2]&gt;ï¼ˆæ‰«æç½‘å€æ®µä¸åŒ…å«ï¼‰</li>
<li>â€“excludefile <exclude_file>ï¼ˆæ’é™¤æ–‡ä»¶ï¼‰</li>
</ul>
</li>
<li>ä¸»æœºå‘ç°<ul>
<li>-sLï¼ˆä¸åšæ‰«æï¼Œåˆ—å‡ºåœ°å€æ®µï¼‰</li>
<li>-snï¼ˆpingæ‰«æï¼Œä¸åšç«¯å£æ‰«æï¼‰</li>
<li>-Pnï¼ˆå½»åº•æ‰«æåœ°å€æ®µï¼Œä¸å›åŒ…ä¹Ÿè¿›è¡Œæ‰«æï¼‰</li>
<li>-PS/PA/PU/PY ï¼ˆTCP SYN/ACKï¼ŒUDP or SCTPå‘ç°ï¼‰</li>
<li>-P0/PS/PE/PP/PM ï¼ˆPingå±‚çš„å‘ç°/SCTPå‘ç°/ICMP echo/æ—¶é—´æˆ³/å­ç½‘æ©ç å‘ç°ï¼‰</li>
<li>-n/-R ï¼ˆä¸åšDNSè§£æ/è‡ªåŠ¨åšåå‘è§£æï¼‰</li>
<li>â€“dns-servers &lt;serv1[,serv2]&gt;ï¼ˆæŒ‡å®šDNSè§£ææœåŠ¡å™¨ï¼‰</li>
<li>â€“system-dnsï¼ˆæ“ä½œç³»ç»Ÿé»˜è®¤çš„DNSè§£ææœåŠ¡å™¨ï¼‰</li>
<li>â€“tracerouteï¼ˆæ‰«æè¿›è¡Œè·¯ç”±è¿½è¸ªï¼‰</li>
</ul>
</li>
<li>ç«¯å£å‘ç°<ul>
<li>sS/sT/sA/sW/sM ï¼ˆTCP SYN/Connect()/ACK/Window/Maimon scansï¼‰</li>
<li>sU ï¼ˆUDPæ‰«æï¼‰</li>
<li>sN/sF/sX ï¼ˆTCP Nullï¼ŒFin and xmas scansï¼‰</li>
<li>â€“scanflags <flags> ï¼ˆé€‰æ‹©è¦æ‰«æçš„flagsï¼‰</li>
<li>-sI &lt;zombie host[:probeport]&gt;ï¼ˆåƒµå°¸æ‰«æï¼‰</li>
<li>-sY/sZ ï¼ˆSCTPåè®®å‚æ•°ï¼‰</li>
<li>-s0ï¼ˆIPæ‰«æï¼‰</li>
<li>-b <FTP relay host>ï¼ˆFTPä¸­ç»§æ‰«æï¼‰</li>
</ul>
</li>
<li>æŒ‡å®šæ‰«æç«¯å£<ul>
<li>-p <port number> U â†’ UDP T â†’ TCP</li>
<li>â€“exclude-ports <port ranges> ï¼ˆæ’é™¤ç«¯å£ï¼‰</li>
<li>-F ï¼ˆå¿«é€Ÿæ¨¡å¼ï¼Œæ¯”è¾ƒå°‘æ•°é‡ç«¯å£ï¼‰</li>
<li>-r ï¼ˆè¿ç»­æ‰«æç«¯å£ï¼Œå°‘äº1000ä¸ªç«¯å£ï¼‰</li>
<li>â€“top-ports <number> ï¼ˆæ‰«æ1000ç«¯å£çš„å‰é¢ç«¯å£ï¼‰</li>
<li>â€“port-ratio <ratio> ï¼ˆæ‰«ææ›´å¸¸è§çš„ç«¯å£ï¼‰</li>
</ul>
</li>
<li>æœåŠ¡/ç‰ˆæœ¬è¯†åˆ«<ul>
<li>-sV ï¼ˆæœåŠ¡ç‰¹å¾åº“åŒ¹é…ï¼‰</li>
<li>-sV â€“version-intensity <level> ï¼ˆæ‰«æçš„æ·±åº¦ã€å¼ºåº¦ï¼‰</li>
<li>-sV â€“version-light ï¼ˆintensity=2ï¼‰</li>
<li>-sV â€“version-all ï¼ˆintensity=9ï¼‰</li>
<li>-sV â€“version-traceï¼ˆæ‰«æè¿‡ç¨‹è¿›è¡Œè·Ÿè¸ªï¼‰</li>
</ul>
</li>
<li>è„šæœ¬æ‰«æ<ul>
<li>-sC ï¼ˆè„šæœ¬æ‰«æï¼Œä¸€èˆ¬æ˜¯â€“script=defaultï¼‰</li>
<li>â€“script=<Lua script> ï¼ˆä½¿ç”¨Luaè„šæœ¬ï¼‰</li>
<li>â€“script-args=&lt;n1=v1[,n2=v2]&gt; ï¼ˆä¿®æ”¹å‚æ•°ï¼‰</li>
<li>â€“script-update ï¼ˆè„šæœ¬åº“æ›´æ–°ï¼‰</li>
<li>â€“script-trace ï¼ˆè¿›è¡Œè·¯ç”±è¿½è¸ªï¼‰</li>
<li>â€“script-help=<Lua scripts> ï¼ˆè„šæœ¬ä½¿ç”¨æ•™ç¨‹å¸®åŠ©ï¼‰</li>
</ul>
</li>
<li>OS æ‰«æ<ul>
<li>-O ï¼ˆæ£€æµ‹OSï¼‰</li>
<li>â€“osscan-limit ï¼ˆOSæ£€æµ‹é™åˆ¶ï¼‰</li>
<li>â€“osscan-guess ï¼ˆOSçŒœæµ‹ï¼‰</li>
</ul>
</li>
<li>æ—¶é—´å’Œæ€§èƒ½<ul>
<li>-â€˜sâ€™,â€™mâ€™,â€™hâ€™,â€™msâ€™ ï¼ˆç§’ã€åˆ†ã€æ—¶ã€æ¯«ç§’ï¼‰</li>
<li>â€“min-hostgroup/max-hostgroup <size> ï¼ˆå¹¶è¡Œæ‰«æä¸»æœºç»„çš„æ•°é‡ï¼‰</li>
<li>â€“min-parallelism/max-parallelism <numprobes> ï¼ˆå¹¶è¡Œæ¢æµ‹æ•°é‡ï¼‰</li>
<li>â€“min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout <time> ï¼ˆrttæ—¶é—´ï¼‰</li>
<li>â€“max-retries <tries> ï¼ˆæœ€å¤§å›åŒ…æ—¶é—´ï¼‰</li>
<li>â€“host-timeout <time> ï¼ˆä¸»æœºè¶…æ—¶æ—¶é—´ï¼‰</li>
<li>â€“scan-delay/â€“max-scan-delay <time> ï¼ˆä¸»æœºå»¶è¿Ÿå‘åŒ…æ—¶é—´ï¼‰</li>
<li>â€“min-rate <number> ï¼ˆæœ€å°å‘åŒ…é€Ÿç‡ï¼‰</li>
<li>â€“max-rate <number> ï¼ˆæœ€å¤§å‘åŒ…é€Ÿç‡ï¼‰</li>
</ul>
</li>
<li>é˜²ç«å¢™/IDSèº²é¿ã€æ¬ºéª—<ul>
<li>-f â€“mtu <val> ï¼ˆè®¾ç½®ä¼ è¾“å•å…ƒï¼‰</li>
<li>-D &lt;decoy1,decoy2[,ME]&gt; ï¼ˆä¼ªé€ æºåœ°å€ï¼Œå¢åŠ å™ªå£°IPï¼‰</li>
<li>-S <IP Address> ï¼ˆæ¬ºéª—æºåœ°å€ï¼‰</li>
<li>-e <iface> ï¼ˆæŒ‡å®šä½¿ç”¨çš„ç½‘å¡ï¼‰</li>
<li>-g/â€“source-port <portnum> ï¼ˆæŒ‡å®šæºç«¯å£è¿›è¡Œå‘åŒ…ï¼‰</li>
<li>â€“proxies &lt;url1,[url2]&gt; ï¼ˆæŒ‡å®šä»£ç†æœåŠ¡å™¨ï¼‰</li>
<li>â€“data <hex string> ï¼ˆæŒ‡å®šåå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œåœ¨åŒ…çš„åé¢å¢åŠ ï¼‰</li>
<li>â€“data-string <string> ï¼ˆå¢åŠ ACSIIç å­—ç¬¦ä¸²ï¼‰</li>
<li>â€“data-length <num> ï¼ˆæ•°æ®çš„é•¿åº¦ï¼‰</li>
<li>â€“ip-options <options> ï¼ˆä¿®æ”¹IPçš„é€‰é¡¹ï¼‰</li>
<li>â€“ttl <val> ï¼ˆè®¾ç½®IPçš„TTLå€¼ï¼‰</li>
<li>â€“spoof-mac &lt;mac address/prefix/vendor name&gt; ï¼ˆæ¬ºéª—MACåœ°å€ï¼‰</li>
<li>â€“badsum ï¼ˆå‘é€é”™è¯¯çš„TCP/UDP/SCTP æ ¡éªŒå’Œï¼‰</li>
</ul>
</li>
<li>MISC<ul>
<li>-6 ï¼ˆå¯ä»¥æ‰«IPv6åœ°å€ï¼‰</li>
<li>-A ï¼ˆOSï¼Œversionï¼Œscriptï¼Œtracerouteçš„ç»„åˆå‘½ä»¤ï¼‰</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%BA%94)%EF%BC%9ANEXPOSE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%BA%94)%EF%BC%9ANEXPOSE/" itemprop="url">Kali Linuxç¬”è®°(äºŒåäº”)ï¼šNEXPOSE</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  410 å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  1 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-NEXPOSE"><a href="#1-NEXPOSE" class="headerlink" title="1. NEXPOSE"></a>1. NEXPOSE</h4><ul>
<li>Rapid7<ul>
<li>Nexpose</li>
<li>å®Œæ•´çš„æ¼æ´ç®¡ç†å®ç°</li>
</ul>
</li>
<li>ç¯å¢ƒå‡†å¤‡<ul>
<li>å»ºè®®VM 4Gå†…å­˜</li>
<li><a href="https://www.rapid7.com/products/nexpose/download/" target="_blank" rel="noopener">https://www.rapid7.com/products/nexpose/download/</a></li>
<li><a href="https://IP_ADDR:3780ï¼ˆnxadmin/nxpassword,åæ”¹ä¸ºRapid7@mazhentaoï¼‰" target="_blank" rel="noopener">https://IP_ADDR:3780ï¼ˆnxadmin/nxpassword,åæ”¹ä¸ºRapid7@mazhentaoï¼‰</a></li>
<li>æ“ä½œç³»ç»Ÿè´¦å·å¯†ç ï¼šnexpose</li>
<li><a href="https://www.rapid7.com/try/nexpose/" target="_blank" rel="noopener">https://www.rapid7.com/try/nexpose/</a></li>
<li>QHWT-72GT-BHDS-FQLHï¼ˆæ¿€æ´»ç è¿›è¡Œæ³¨å†Œï¼Œ30å¤©æœ‰æ•ˆæœŸï¼‰</li>
<li>service nexposeconsole.cc restartï¼ˆé‡å¯å‘½ä»¤ï¼Œä½†åˆå§‹åŒ–æ—¶é—´éå¸¸é•¿ï¼‰</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>æ¦‚å¿µï¼šç”¨æ‰«æå™¨å»å‘ç°æ¼æ´ï¼Œç”¨æ¸—é€æ¡†æ¶å»éªŒè¯æ¼æ´
â–² 2019.12.8å¯ä»¥æ³¨å†Œä¸€ä¸ªä¼ä¸šé‚®ç®±ï¼Œå¯ç”³è¯·å¤šä¸ªï¼ˆè…¾è®¯ã€‚ç½‘æ˜“ç­‰ï¼‰
â–² 2019.12.8éœ€è¦ä¿®æ”¹å¯†ç ï¼Œè‡³å°‘ä¸€ä¸ªæ•°å­—ï¼Œä¸€ä¸ªå¤§å†™å­—æ¯ï¼Œä¸€ä¸ªå­—ç¬¦ï¼Œé•¿åº¦å¤§äº14ä½ï¼Œå¤šæ¬¡ä¸æˆåŠŸä¼šé”è´¦å· Rapid7@mazhentao
â–² 2019.12.8åªæœ‰æ³¨å†Œåï¼Œæ‰å¯ä¸‹è½½åˆ°ovaæ–‡ä»¶</code></pre></blockquote>
<h4 id="2-Administrator"><a href="#2-Administrator" class="headerlink" title="2. Administrator"></a>2. Administrator</h4><ul>
<li>Scan Templates<ul>
<li>Exhaustive â†’ Copy</li>
<li>General â†’ Name â†’ Types of Checksï¼ˆAssert Discoveryã€Vulnerabilityã€WebSplderingã€Policiesï¼‰</li>
<li>Asset Discoveryï¼ˆä¸»æœºå‘ç°ï¼‰</li>
<li>Service Discoveryï¼ˆæœåŠ¡å‘ç°ï¼‰</li>
<li>Discovery Performanceï¼ˆå‘ç°é€‰é¡¹ï¼‰</li>
<li>Vulnerability Checksï¼ˆunsafe or safeï¼Œ<strong>ï¼Select Checksï¼</strong>ï¼‰</li>
<li>File Searchingï¼ˆæ–‡ä»¶æœç´¢ï¼‰</li>
<li>Spam Relayingï¼ˆåƒåœ¾é‚®ä»¶ï¼‰</li>
<li>Database Serversï¼ˆæ•°æ®åº“ï¼‰</li>
<li>Mail Serverï¼ˆé‚®ä»¶æœåŠ¡å™¨ï¼‰</li>
<li>CVS Serverrï¼ˆç‰ˆæœ¬ç®¡ç†æœåŠ¡å™¨ï¼‰</li>
<li>DHCP Server</li>
<li>Telnet Server</li>
<li>Web Splderingï¼ˆç½‘é¡µçˆ¬ç½‘ï¼Œæœ‰å¯èƒ½é€ æˆCCæ”»å‡»ï¼‰</li>
<li>Oracle Policyï¼ˆOracle ç­–ç•¥ï¼‰</li>
<li>Lotus Domino Policyï¼ˆLotus Domino ç­–ç•¥ï¼‰</li>
<li>Windows Group Policyï¼ˆwindow ç»„ç­–ç•¥ï¼‰</li>
<li>CIFS/SMB Account Policyï¼ˆCIFS/SMB è´¦å·ç­–ç•¥ï¼‰</li>
<li>AS/400 Policyï¼ˆAS/400 æœºå‹ç­–ç•¥ï¼‰</li>
<li>Unix Policyï¼ˆUnix ç­–ç•¥ï¼‰</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>ä¼ä¸šåœ¨ç¾å›½ä¸Šå¸‚éœ€è¦è¿‡å¡ç­æ€å‘æ¡ˆï¼Œä¹Ÿå³404æ³•æ¡ˆï¼ŒSarbans-Oxley compliance
æ”¯ä»˜è¡Œä¸šè¦è¿‡PCI ASV Extemal Audit/PCI Internal Aduit</code></pre></blockquote>
<ul>
<li>Sitesï¼ˆåœ¨homeï¼‰<ul>
<li>Create sites</li>
<li>INFO &amp; SECURITY</li>
<li>ASSETS</li>
<li>AUTHENTICATIONï¼ˆWeb Application â†’ HTML FORM/HTTP HEADERSï¼ˆSEESIONIDï¼‰ï¼‰</li>
<li>TEMPLATES</li>
<li>ENGINESï¼ˆæ‰«æå¼•æ“ï¼‰</li>
<li>ALERTSï¼ˆåˆ°ç‚¹ï¼Œå¯ä»¥ç”¨äºå‘é€mailï¼‰</li>
<li>SCHEDULE</li>
</ul>
</li>
</ul>
<h4 id="3-æ‰«æç»“æœåˆ†æ"><a href="#3-æ‰«æç»“æœåˆ†æ" class="headerlink" title="3. æ‰«æç»“æœåˆ†æ"></a>3. æ‰«æç»“æœåˆ†æ</h4><ul>
<li>False Positiveï¼šè¯¯æŠ¥</li>
<li>False negativeï¼šæ¼æŠ¥</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E5%9B%9B)%EF%BC%9ANESSUS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E5%9B%9B)%EF%BC%9ANESSUS/" itemprop="url">Kali Linuxç¬”è®°(äºŒåå››)ï¼šNESSUS</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  401 å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  1 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-NESSUS"><a href="#1-NESSUS" class="headerlink" title="1. NESSUS"></a>1. NESSUS</h4><ul>
<li>å®¶åº­ç‰ˆ<ul>
<li>å…è´¹</li>
</ul>
</li>
<li>ä¸“ä¸šç‰ˆ<ul>
<li>æ”¶è´¹ï¼Œæ— é™çš„å¹¶å‘è¿æ¥</li>
</ul>
</li>
<li>ä¸‹è½½<ul>
<li><a href="https://www.tenable.com/downloads/nessus" target="_blank" rel="noopener">https://www.tenable.com/downloads/nessus</a></li>
</ul>
</li>
<li>å®‰è£…<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šdpkg -i æ–‡ä»¶dbg</code></strong></li>
<li>å®‰è£…è·¯å¾„ï¼š/opt/nessus</li>
</ul>
</li>
<li>å¯åŠ¨æœåŠ¡<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š/etc/init.d/nessusd start</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼š/etc/init.d/nessusd status</code></strong>ï¼ˆæŸ¥çœ‹çŠ¶æ€ï¼‰</li>
</ul>
</li>
<li>ç®¡ç†åœ°å€<ul>
<li><a href="https://127.0.0.1:8834" target="_blank" rel="noopener">https://127.0.0.1:8834</a></li>
</ul>
</li>
<li>æ³¨å†Œæ¿€æ´»ç <ul>
<li><a href="https://www.tenable.com/products/nessus/nessus-essentials" target="_blank" rel="noopener">https://www.tenable.com/products/nessus/nessus-essentials</a></li>
</ul>
</li>
<li>ç®¡ç†è´¦å·<ul>
<li>æ›´æ–°æ’ä»¶</li>
</ul>
</li>
<li>åŸºæœ¬é…ç½®ï¼ˆsettingï¼‰<ul>
<li>å‡çº§</li>
<li>è´¦å·</li>
<li>SMTP</li>
<li>ä»£ç†</li>
</ul>
</li>
<li>Policy Library<ul>
<li>Advanced Scanï¼ˆé«˜çº§æ‰«æï¼‰</li>
<li>Basic Shellshock Detectionï¼ˆæ£€æµ‹ç ´å£³æ¼æ´ï¼Œç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ï¼‰</li>
<li>Basic Network Scanï¼ˆåŸºæœ¬ç½‘ç»œæ‰«æï¼Œfor any hostï¼‰</li>
<li>Credentialed Patch Auditï¼ˆèº«ä»½éªŒè¯è¡¥ä¸ï¼‰</li>
<li>GHOSTï¼ˆglibcï¼‰Detectionï¼ˆåº•å±‚Cè¯­è¨€æ¨¡å—æ¼æ´ï¼‰</li>
<li>Host Discoveryï¼ˆä¸»æœºå‘ç°ï¼‰</li>
<li>Web Applicattion Testï¼ˆé’ˆå¯¹Webçš„æ¼æ´ï¼ŒXSS,CSRF,SQLæ³¨å…¥ç­‰ï¼‰</li>
<li>Windows Mainware Scanï¼ˆæ‰«ææ¶æ„è½¯ä»¶ï¼Œè®¡ç®—æ¶æ„ç¨‹åºçš„å“ˆå¸Œå€¼ï¼Œç”Ÿæˆåˆ—è¡¨ï¼Œæ¥åŒ¹é…ï¼‰</li>
</ul>
</li>
</ul>
<h4 id="2-NESSUSæ‰«æï¼ˆwindowï¼‰"><a href="#2-NESSUSæ‰«æï¼ˆwindowï¼‰" class="headerlink" title="2. NESSUSæ‰«æï¼ˆwindowï¼‰"></a>2. NESSUSæ‰«æï¼ˆwindowï¼‰</h4><ul>
<li>Advanced Scan â†’ Setting<ul>
<li>Basic â†’ Generalï¼ˆName â†’ window_vuln_scan_policyï¼‰</li>
<li>Basic â†’ Permissions</li>
<li>Discovery â†’ Host Discoveryï¼ˆUse fast network discoveryï¼ŒAdd Fileï¼ˆæ·»åŠ MACåœ°å€ï¼‰ï¼‰</li>
<li>Discovery â†’ Prot Scanningï¼ˆPorts â†’ defultï¼ŒTCP â†’ SYNï¼‰</li>
<li>Discovery â†’ Service Discoveryï¼ˆAll Portsï¼ŒEnable all SSL ciphersï¼ŒEnable CRL checkingï¼‰</li>
<li>Assessment â†’ Web Applicationï¼ˆopenï¼‰</li>
<li>Advancedï¼ˆnot safeï¼‰</li>
</ul>
</li>
<li>Advanced Scan â†’ Credentialsï¼ˆè¯ä¹¦ï¼Œè¯æ˜æé«˜ï¼‰</li>
<li>Advanced Scan â†’ Complianceï¼ˆåˆè§„æ€§ï¼‰</li>
<li>Advanced Scan â†’ Pluginsï¼ˆç±»ä¼¼äºopenvasçš„familyï¼Œæ’ä»¶ï¼‰</li>
<li>New Scan â†’ window_vuln_scan_policy  â–² 2019.12.8 SMTP 25ç«¯å£æ— æ³•è¿æ¥socket<ul>
<li>setting â†’ send Emailï¼ˆSMTP Serverï¼‰</li>
<li>Hostï¼š<a href="mailto:smtp@163.com" target="_blank" rel="noopener">smtp@163.com</a></li>
<li>Portï¼š25</li>
<li>Fromï¼š<a href="mailto:nessus@163.com" target="_blank" rel="noopener">nessus@163.com</a></li>
<li>Encryptionï¼šUse TLS if available</li>
<li>Hostnameï¼šlocalhostï¼š8834</li>
<li>Auth Methodï¼šPLAIN</li>
<li>Username/Password   </li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>windowså¢åŠ ç”¨æˆ·å¯†ç ï¼šnet user ç”¨æˆ· -
å¯æ·»åŠ ä¸€ä¸ªé’ˆå¯¹Linuxç³»ç»Ÿçš„Advabced Scanï¼ˆlinux_vuln_scan_policyï¼‰
å¯é€šè¿‡è®¾ç½®User Profile â†’ API Keysæ¥è®¾ç½®Access Keyå’ŒSecret Key</code></pre></blockquote>
<h4 id="3-NESSUS"><a href="#3-NESSUS" class="headerlink" title="3. NESSUS"></a>3. NESSUS</h4><ul>
<li>ç­–ç•¥</li>
<li>æ‰«æ</li>
<li>æ‰«ææœ¬æœº</li>
<li>æ‰«æwindows</li>
<li>æ‰«æLinux</li>
<li>æ‰«æç½‘ç»œè®¾å¤‡</li>
<li>æ‰«æweb server</li>
<li>æŠ¥å‘Š</li>
<li>è°ƒåº¦</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%B8%89)%EF%BC%9AOPENVAS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%B8%89)%EF%BC%9AOPENVAS/" itemprop="url">Kali Linuxç¬”è®°(äºŒåä¸‰)ï¼šOPENVAS</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  638 å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  2 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-OPENVAS"><a href="#1-OPENVAS" class="headerlink" title="1. OPENVAS"></a>1. OPENVAS</h4><ul>
<li>Openvas<ul>
<li>Nessusé¡¹ç›®åˆ†æ”¯</li>
<li>ç®¡ç†ç›®æ ‡ç³»ç»Ÿçš„æ¼æ´</li>
<li>å…è´¹å¼€æº</li>
<li>Kalié»˜è®¤å®‰è£…ï¼Œä½†æœªé…ç½®å’Œå¯åŠ¨</li>
</ul>
</li>
</ul>
<h4 id="2-OPENVAS"><a href="#2-OPENVAS" class="headerlink" title="2. OPENVAS"></a>2. OPENVAS</h4><ul>
<li>å®‰è£…</li>
<li>åˆ›å»ºè¯ä¹¦</li>
<li>åŒæ­¥å¼±ç‚¹æ•°æ®åº“NVT</li>
<li>åˆ›å»ºå®¢æˆ·ç«¯è¯ä¹¦</li>
<li>é‡å»ºæ•°æ®åº“</li>
<li>å¤‡ä»½æ•°æ®åº“</li>
<li>å¯åŠ¨æœåŠ¡è£…å…¥æ’ä»¶</li>
<li>åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·</li>
<li>åˆ›å»ºæ™®é€šç”¨æˆ·è´¦å·</li>
<li>é…ç½®æœåŠ¡ä¾¦å¬ç«¯å£</li>
<li>å®‰è£…éªŒè¯</li>
</ul>
<blockquote>
<pre><code>Kali Linuxé…ç½®OPENVASï¼Œopenvas-setupï¼Œç°åœ¨ä¸€æ¡å‘½ä»¤å³å¯
OPENVASæ¯å¤©ä¼šå‘å¸ƒfeedï¼Œé‡Œé¢åŒ…å«ç”±ä¸€ä¸ªæˆ–å¤šä¸ªNVT</code></pre></blockquote>
<h4 id="3-OPENVAS"><a href="#3-OPENVAS" class="headerlink" title="3. OPENVAS"></a>3. OPENVAS</h4><ul>
<li>OpenVAS Managerï¼ˆè´Ÿè´£æŠŠå…¶ä»–çš„ç»„ä»¶è¿æ¥ï¼‰<ul>
<li>æ§åˆ¶Scannerå’Œå…¶ä»–Managerçš„ä¸­å¿ƒç»„ä»¶</li>
<li>æ§åˆ¶ä¸­å¿ƒæ•°æ®åº“ï¼Œä¿å­˜ç”¨æˆ·é…ç½®åŠæ‰«æç»“æœ</li>
<li>å®¢æˆ·ç«¯ä½¿ç”¨åŸºäºXMLçš„æ— çŠ¶æ€OMPåè®®ä¸å…¶é€šä¿¡</li>
<li>é›†ä¸­æ’åºç­›é€‰ï¼Œä½¿å®¢æˆ·ç«¯è·å¾—ä¸€è‡´å±•ç°</li>
</ul>
</li>
<li>OpenVAS Scannerï¼ˆæ‰«æå™¨ï¼Œå¯ä»¥å¤šä¸ªscannerï¼Œå¤šçº§éƒ¨ç½²ï¼‰<ul>
<li>å…·ä½“æ‰§è¡ŒNetwork Vulnerability Testsï¼ˆNVTsï¼‰</li>
<li>NVTs æ¯å¤©é€šè¿‡æ›´æ–°Feedæ›´æ–°</li>
<li>å—Manageræ§åˆ¶</li>
</ul>
</li>
<li>OSP Scannerï¼ˆscanneræ‰«æå™¨ç»„ï¼‰<ul>
<li>å¯ä»¥ç»Ÿä¸€ç®¡ç†å¤šä¸ªScanner</li>
<li>å°†ä¸€ç»„Scannerä½œä¸ºä¸€ä¸ªå¯¹è±¡äº¤ç»™managerç®¡ç†</li>
</ul>
</li>
<li>Greenbone Security Assistantï¼ˆç›¸å½“äºä¸€ä¸ªæœåŠ¡å™¨ç«¯ï¼Œè®¿é—®OpenVASManageï¼‰<ul>
<li>æé«˜Web Service</li>
</ul>
</li>
<li>OMP Clientsï¼ˆæ”¯æŒé€šè¿‡APIçš„æ–¹å¼å»è°ƒç”¨OpenVAS Managerï¼‰</li>
<li>Web Browserï¼ˆé€šè¿‡GreenBoneå»è®¿é—®OpenVAS Managerï¼‰</li>
<li>Feedï¼ˆNVTSï¼ŒSCAP CERT,User Dataï¼‰ </li>
<li>Target System</li>
<li>OpenVAS CLI<ul>
<li>ompå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯å®ç°æ‰¹å¤„ç†æ§åˆ¶manager</li>
</ul>
</li>
<li>æ›´æ–°å¾ˆå¿«<ul>
<li>æ‰€æœ‰æ‰¾å¾—åˆ°çš„èµ„æ–™å‡ ä¹éƒ½å·²ä¸åŒç¨‹åº¦çš„è¿‡æ—¶äº†</li>
</ul>
</li>
</ul>
<h4 id="4-OPENVAS"><a href="#4-OPENVAS" class="headerlink" title="4. OPENVAS"></a>4. OPENVAS</h4><ul>
<li>åˆå§‹åŒ–å®‰è£…<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šopenvas-setup</code></strong></li>
</ul>
</li>
<li>æ£€æŸ¥å®‰è£…ç»“æœ<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šopenvas-check-setup</code></strong>ï¼ˆå‡ºé—®é¢˜ä¼šå‡ºç°FIXé”™è¯¯é¡¹ï¼‰</li>
</ul>
</li>
<li>æŸ¥çœ‹å½“å‰è´¦å·<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šopenvasmd --list-users</code></strong> â–²2019.12.7 æ— æ­¤å‚æ•°</li>
</ul>
</li>
<li>ä¿®æ”¹è´¦æˆ·å¯†ç <ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šopenvas --user=admin --new-password=Password</code></strong></li>
</ul>
</li>
<li>å‡çº§<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šopenvas-feed-update</code></strong></li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>openvasmd -h å¯ä¿®æ”¹è´¦æˆ·å¯†ç ï¼Œå¯å¢åŠ è´¦æˆ·
9390ç«¯å£ï¼šopenvas manager
9391ç«¯å£ï¼šé»˜è®¤ç¬¬ä¸€scanner
9392ç«¯å£ï¼šwebç™»é™†ï¼ˆhttpsï¼‰
openvas-check-setup | grep Fix å¯æŸ¥çœ‹æŠ¥é”™çš„ç»„ä»¶
è¯ä¹¦æŠ¥é”™çš„åŸå› ï¼šï¼ˆ1ï¼‰åç§°ä¸URLåœ°å€ä¸ä¸€è‡´ï¼ˆ2ï¼‰è¯ä¹¦ä¸ºè‡ªç­¾åè¯ä¹¦</code></pre></blockquote>
<h4 id="5-OPENVAS"><a href="#5-OPENVAS" class="headerlink" title="5. OPENVAS"></a>5. OPENVAS</h4><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼švi /usr/bin/openvas-start</code></strong>ï¼ˆè°ƒæ•´å¯åŠ¨æœåŠ¡é¡ºåºï¼Œå¯¹äºkali2.0ç‰ˆæœ¬ä»¥ä¸‹ï¼‰<ul>
<li>Starting OpenVas Services</li>
<li>3\Starting OpenVas Manager.openvasmd</li>
<li>2\Starting OpenVas Scanner.openvassd</li>
<li>1\Starting Greenbone Security Assistant:gsad</li>
</ul>
</li>
<li>openvas-start</li>
</ul>
<h4 id="6-OPENVAS"><a href="#6-OPENVAS" class="headerlink" title="6. OPENVAS"></a>6. OPENVAS</h4><ul>
<li>Configration<ul>
<li>scan configs â†’ windows_server_scan_configration</li>
<li>target â†’ windows_xpï¼ˆAlive Test â†’ Consider Aliveï¼ŒPort Listï¼‰</li>
<li>Port List â†’ windows_xp_ports ï¼ˆor OpenVAS Defaultï¼‰</li>
<li>Schedules â†’ weekly_scanï¼ˆPeriodï¼ŒDurationï¼‰</li>
</ul>
</li>
<li>Scan Management<ul>
<li>Tasks â†’ weekly_windows_scan_taskï¼ˆScan Targetï¼ŒScheduleï¼ŒAdd results to Asset Managementï¼ŒOpenVAS Scannerï¼ŒScan configï¼ŒSlaveï¼ŒNetwork Sourece Interfaceï¼ŒOrder for target hostsï¼ŒMaximum concurrently executed NVTs per hostï¼ŒMaximum concurrently scanner hostï¼‰</li>
</ul>
</li>
<li>Configration<ul>
<li>scan configs â†’ linux_unix_scan_configration</li>
</ul>
</li>
<li>start a short scanï¼ˆfull and fastï¼Œéœ€è¦ä¸€ä¸ªIPï¼‰ â–²2019.12.7æ–°ç‰ˆåœ¨Task Wizardä¸­</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%BA%8C)%EF%BC%9A%E5%BC%B1%E7%82%B9%E6%89%AB%E6%8F%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81%E4%BA%8C)%EF%BC%9A%E5%BC%B1%E7%82%B9%E6%89%AB%E6%8F%8F/" itemprop="url">Kali Linuxç¬”è®°(äºŒåäºŒ)ï¼šå¼±ç‚¹æ‰«æ</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  1.4k å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  5 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-å‘ç°å¼±ç‚¹"><a href="#1-å‘ç°å¼±ç‚¹" class="headerlink" title="1. å‘ç°å¼±ç‚¹"></a>1. å‘ç°å¼±ç‚¹</h4><ul>
<li>å‘ç°æ¼æ´<ul>
<li>åŸºäºç«¯å£æœåŠ¡æ‰«æç»“æœç‰ˆæœ¬ä¿¡æ¯ï¼ˆé€Ÿåº¦æ…¢ï¼‰</li>
<li>æœç´¢å·²å…¬å¼€çš„æ¼æ´æ•°æ®åº“ï¼ˆæ•°é‡å¤§ï¼‰</li>
<li>ä½¿ç”¨å¼±ç‚¹æ‰«æå™¨å®ç°æ¼æ´ç®¡ç†</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>ï¼ˆ1ï¼‰https://www.exploit-db.com Kali å®˜æ–¹å…¬å¸ƒçš„æ¼æ´ä»£ç 
ï¼ˆ2ï¼‰searchsploit æœåŠ¡ç±»å‹  æŸ¥æ‰¾ç›¸å…³æ¼æ´åˆ©ç”¨ä»£ç  ï¼ˆç›¸å¹²æ–‡ä»¶æ”¾åœ¨usr/share/exploitdb/platformsï¼‰
ï¼ˆ3ï¼‰Kaliè‡ªå¸¦å·¥å…· sandi-gui  â–²2019.12.7æš‚æ— æ­¤å·¥å…·</code></pre></blockquote>
<h4 id="2-ä»ä¿¡æ¯çš„ç»´åº¦å®šä¹‰æ¼æ´ç®¡ç†"><a href="#2-ä»ä¿¡æ¯çš„ç»´åº¦å®šä¹‰æ¼æ´ç®¡ç†" class="headerlink" title="2. ä»ä¿¡æ¯çš„ç»´åº¦å®šä¹‰æ¼æ´ç®¡ç†"></a>2. ä»ä¿¡æ¯çš„ç»´åº¦å®šä¹‰æ¼æ´ç®¡ç†</h4><ul>
<li>ä¿¡æ¯æ”¶é›†ï¼š<ul>
<li>æ‰«æå‘ç°ç½‘ç»œIPã€OSã€æœåŠ¡ã€é…ç½®ã€æ¼æ´</li>
<li>èƒ½åŠ›è¦æ±‚ï¼šå®šä¹‰æ‰«ææ–¹å¼å†…å®¹å’Œç›®æ ‡</li>
</ul>
</li>
<li>ä¿¡æ¯ç®¡ç†<ul>
<li>æ ¼å¼åŒ–ä¿¡æ¯ï¼Œå¹¶è¿›è¡Œç­›é€‰ã€åˆ†ç»„ã€å®šä¹‰ä¼˜å…ˆçº§</li>
<li>èƒ½åŠ›è¦æ±‚ï¼šèµ„äº§åˆ†ç»„ã€æŒ‡å®šæ‰€æœ‰è€…ã€å‘æ‰€æœ‰è€…æŠ¥å‘Šæ¼æ´</li>
</ul>
</li>
<li>ä¿¡æ¯è¾“å‡º<ul>
<li>å‘ä¸åŒå±‚çº§çš„äººç¾¤å±•ç¤ºè¶³å¤Ÿçš„ä¿¡æ¯é‡</li>
<li>èƒ½åŠ›éœ€æ±‚ï¼šç”ŸæˆæŠ¥å‘Šã€å¯¼å‡ºæ•°æ®ã€ä¸SIEMé›†æˆ</li>
</ul>
</li>
</ul>
<h4 id="3-å¼±ç‚¹æ‰«æç±»å‹"><a href="#3-å¼±ç‚¹æ‰«æç±»å‹" class="headerlink" title="3. å¼±ç‚¹æ‰«æç±»å‹"></a>3. å¼±ç‚¹æ‰«æç±»å‹</h4><ul>
<li>ä¸»åŠ¨æ‰«æ<ul>
<li>æœ‰èº«ä»½éªŒè¯</li>
<li>æ— èº«ä»½éªŒè¯</li>
</ul>
</li>
<li>è¢«åŠ¨æ‰«æ<ul>
<li>é•œåƒç«¯å£æŠ“åŒ…</li>
<li>å…¶ä»–æ¥æºè¾“å…¥</li>
</ul>
</li>
<li>åŸºäºAgentçš„æ‰«æ<ul>
<li>æ”¯æŒå¹³å°æœ‰é™</li>
</ul>
</li>
</ul>
<h4 id="4-æ¼æ´æ¦‚å¿µ"><a href="#4-æ¼æ´æ¦‚å¿µ" class="headerlink" title="4. æ¼æ´æ¦‚å¿µ"></a>4. æ¼æ´æ¦‚å¿µ</h4><ul>
<li>CVSSï¼ˆCommon Vulnerability Scoring Systemï¼‰<ul>
<li>é€šç”¨æ¼æ´è¯„åˆ†ç³»ç»Ÿâ€“å·¥ä¸šæ ‡å‡†</li>
<li>æ‰«æå®‰å…¨æ¼æ´ä¸¥é‡ç¨‹åº¦çš„ç»Ÿä¸€è¯„åˆ†æ–¹æ¡ˆ</li>
<li>V3ç‰ˆæœ¬â€“2015å¹´6æœˆ10æ—¥</li>
<li>Basic Metricï¼šåŸºç¡€çš„æ’å®šä¸å˜çš„å¼±ç‚¹æƒé‡</li>
<li>Temporal Metricï¼šä¾èµ–æ—¶é—´å› ç´ çš„å¼±ç‚¹æƒé‡</li>
<li>Enviromental Metricï¼šåˆ©ç”¨å¼±ç‚¹çš„ç¯å¢ƒè¦æ±‚å’Œå®æ–½éš¾åº¦çš„æƒé‡</li>
<li>CVSSæ˜¯å®‰å…¨å†…å®¹è‡ªåŠ¨åŒ–åè®®ï¼ˆSCAPï¼‰çš„ä¸€éƒ¨åˆ†</li>
<li>é€šå¸¸CVSSä¸CVEä¸€åŒç”±ç¾å›½å›½å®¶æ¼æ´åº“ï¼ˆNVDï¼‰å‘å¸ƒå¹¶ä¿æŒæ•°æ®çš„æ›´æ–°</li>
<li>åˆ†å€¼èŒƒå›´ï¼š0â€“10</li>
<li>ä¸åŒæœºæ„æŒ‰CVSSåˆ†å€¼å®šä¹‰å¨èƒçš„ä¸­ã€é«˜ã€ä½å¨èƒçº§åˆ«</li>
<li>CVSSä½“ç°å¼±ç‚¹çš„é£é™©ï¼Œå¨èƒçº§åˆ«ï¼ˆseverityï¼‰è¡¨ç¤ºå¼±ç‚¹é£é™©å¯¹ä¼ä¸šçš„å½±å“</li>
<li>CVSSåˆ†å€¼æ˜¯å·¥ä¸šæ ‡å‡†ï¼Œä½†å¨èƒçº§åˆ«ä¸æ˜¯</li>
</ul>
</li>
<li>Vulnerability Reference</li>
<li>CVEï¼ˆCommon Vulnerability and Exposuresï¼‰<ul>
<li>å·²å…¬å¼€çš„ä¿¡æ¯å®‰å…¨æ¼æ´å­—å…¸ï¼Œç»Ÿä¸€çš„æ¼æ´ç¼–å·æ ‡å‡†</li>
<li>MITREå…¬å¸è´Ÿè´£ç»´æŠ¤ï¼ˆéç›ˆåˆ©æœºæ„ï¼‰</li>
<li>æ‰«æå™¨çš„å¤§éƒ¨åˆ†æ‰«æé¡¹éƒ½å¯¹åº”ä¸€ä¸ªCVEç¼–å·</li>
<li>å®ç°ä¸åŒäº§å•†ä¹‹é—´ä¿¡æ¯äº¤æ¢çš„ç»Ÿä¸€æ ‡å‡†</li>
</ul>
</li>
<li>CVEå‘å¸ƒæµç¨‹<ul>
<li>å‘ç°æ¼æ´</li>
<li>CANè´Ÿè´£æŒ‡å®šCVE ID</li>
<li>å‘å¸ƒåˆ°CVE Listâ€“CVE-2008-4250</li>
<li>MITREè´Ÿè´£å¯¹å†…å®¹è¿›è¡Œç¼–è¾‘ç»´æŠ¤</li>
</ul>
</li>
</ul>
<h4 id="5-æ¼æ´åŸºæœ¬æ¦‚å¿µ"><a href="#5-æ¼æ´åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="5. æ¼æ´åŸºæœ¬æ¦‚å¿µ"></a>5. æ¼æ´åŸºæœ¬æ¦‚å¿µ</h4><ul>
<li><p>å¾ˆå¤šäº§å•†ç»´æŠ¤è‡ªå·±çš„Vulnerability Reference</p>
<ul>
<li>MS</li>
<li>MSKB</li>
</ul>
</li>
<li><p>å…¶ä»–Vulnerability Reference</p>
<ul>
<li>CERT TA08-297A</li>
<li>BID 31874</li>
<li>IAVM 2008-A-0081</li>
<li>OVAL OVAL6093</li>
</ul>
</li>
<li><p>OVALï¼ˆOpen Vulnerability and Assessment Languageï¼‰</p>
<ul>
<li>æè¿°æ¼æ´æ£€æµ‹æ–¹æ³•çš„æœºå™¨å¯è¯†åˆ«è¯­è¨€</li>
<li>è¯¦ç»†çš„æè¿°æ¼æ´æ£€æµ‹çš„æŠ€æœ¯ç»†èŠ‚ï¼Œå¯å¯¼å…¥è‡ªåŠ¨åŒ–æ£€æµ‹å·¥å…·å®æ–½æ¼æ´æ£€æµ‹å·¥å…·</li>
<li>OVALä½¿ç”¨XMLè¯­è¨€æè¿°ï¼ŒåŒ…å«äº†ä¸¥å¯†çš„è¯­æ³•é€»è¾‘</li>
</ul>
</li>
<li><p>CCE</p>
<ul>
<li>æè¿°è½¯ä»¶é…ç½®ç¼ºé™·çš„ä¸€ç§æ ‡å‡†åŒ–æ ¼å¼</li>
<li>åœ¨ä¿¡æ¯å®‰å…¨é£é™©è¯„ä¼°ï¼Œé…ç½®ç¼ºé™·çš„æ£€æµ‹æ˜¯ä¸€é¡¹é‡è¦å†…å®¹ï¼Œä½¿ç”¨CCEå¯ä»¥é…ç½®ç¼ºé™·ä»¥æ ‡å‡†çš„æ–¹å¼å±•ç°å‡ºæ¥ï¼Œä¾¿äºé…ç½®ç¼ºé™·è¯„ä¼°çš„å¯é‡åŒ–æ“ä½œ</li>
</ul>
</li>
<li><p>CPEï¼ˆCommon Product Enumerationï¼‰</p>
<ul>
<li>ä¿¡æ¯æŠ€æœ¯äº§å“ã€ç³»ç»Ÿã€è½¯ä»¶åŒ…çš„ç»“æ„åŒ–å‘½ä»¤è§„èŒƒï¼Œåˆ†ç±»å‘½å</li>
</ul>
</li>
<li><p>CWEï¼ˆCommon Weakness Enumerationï¼‰</p>
<ul>
<li>å¸¸è§æ¼æ´ç±»å‹çš„å­—å…¸ï¼Œæè¿°ä¸åŒç±»å‹æ¼æ´çš„ç‰¹å¾ï¼ˆè®¿é—®æ§åˆ¶ã€ä¿¡æ¯æ³„éœ²ã€æ‹’ç»æœåŠ¡ï¼‰</li>
</ul>
</li>
<li><p>Security Content Automation Protocalï¼ˆSCAPï¼‰</p>
<ul>
<li>SCAPæ˜¯ä¸€ä¸ªé›†åˆäº†å¤šç§å®‰å…¨æ ‡å‡†æ¡†æ¶</li>
<li>å…­ä¸ªå…ƒç´ ï¼šCVEã€OVALã€CCEã€CPEã€CVSSã€XCCDF</li>
<li>ç›®çš„æ˜¯ä»¥æ ‡å‡†çš„æ–¹æ³•å±•ç¤ºå’Œæ“ä½œå®‰å…¨æ•°æ®</li>
<li>ç”±NISTè´Ÿè´£ç»´æŠ¤</li>
</ul>
</li>
<li><p>SCAPä¸»è¦è§£å†³ä¸‰ä¸ªé—®é¢˜</p>
<ul>
<li>å®ç°é«˜å±‚æ”¿ç­–æ³•è§„ç­‰åˆ°åº•å±‚å®æ–½çš„è½åœ°ï¼ˆå¦‚FISMAï¼ŒISO27000ç³»åˆ—ï¼‰</li>
<li>å°†ä¿¡æ¯å®‰å…¨æ‰€æ¶‰åŠçš„å„ä¸ªè¦ç´ æ ‡å‡†åŒ–ï¼ˆå¦‚ç»Ÿä¸€æ¼æ´çš„å‘½ååŠä¸¥é‡æ€§åº¦é‡ï¼‰</li>
<li>å°†å¤æ‚çš„ç³»ç»Ÿé…ç½®æ£€æŸ¥å·¥ä½œè‡ªåŠ¨åŒ–</li>
</ul>
</li>
<li><p>SCAPæ˜¯å½“å‰ç¾å›½æ¯”è¾ƒæˆç†Ÿçš„ä¸€å¥—ä¿¡æ¯å®‰å…¨è¯„ä¼°æ ‡å‡†ä½“ç³»ï¼Œå…¶æ ‡å‡†åŒ–ã€è‡ªåŠ¨åŒ–çš„æ€æƒ³å¯¹ä¿¡æ¯å®‰å…¨è¡Œä¸šäº§ç”Ÿäº†æ·±è¿œçš„å½±å“</p>
</li>
<li><p>NVDï¼ˆNational Vulnerability Databaseï¼‰</p>
<ul>
<li>ç¾å›½æ”¿åºœçš„æ¼æ´ç®¡ç†æ ‡å‡†æ•°æ®</li>
<li>å®Œå…¨åŸºäºSCAPæ¡†æ¶</li>
<li>å®ç°è‡ªåŠ¨åŒ–æ¼æ´ç®¡ç†ã€å®‰å…¨æµ‹é‡ã€åˆè§„è¦æ±‚</li>
<li>åŒ…å«ä»¥ä¸‹åº“(<a href="https://nvd.nist.gov/)ï¼š" target="_blank" rel="noopener">https://nvd.nist.gov/)ï¼š</a></li>
</ul>
<ol>
<li>å®‰å…¨æ£€æŸ¥åˆ—è¡¨</li>
<li>è½¯ä»¶å®‰å…¨æ¼æ´</li>
<li>é…ç½®é”™è¯¯</li>
<li>äº§å“åç§°</li>
<li>å½±å“ç¨‹åº¦</li>
</ol>
</li>
</ul>
<h4 id="6-æ¼æ´ç®¡ç†"><a href="#6-æ¼æ´ç®¡ç†" class="headerlink" title="6. æ¼æ´ç®¡ç†"></a>6. æ¼æ´ç®¡ç†</h4><ul>
<li>å‘¨æœŸæ€§æ‰«æè·Ÿè¸ªæ¼æ´</li>
<li>é«˜å±æ¼æ´ä¼˜å…ˆå¤„ç†</li>
<li>æ‰«ææ³¨æ„äº‹é¡¹</li>
<li>æ¼æ´ç®¡ç†ä¸‰è¦ç´ <ul>
<li>å‡†ç¡®æ€§</li>
<li>æ—¶é—´</li>
<li>èµ„æº</li>
</ul>
</li>
</ul>
<h4 id="7-Nmap"><a href="#7-Nmap" class="headerlink" title="7. Nmap"></a>7. Nmap</h4><ul>
<li>nmapæ‰«æè„šæœ¬<ul>
<li>600+</li>
<li>åˆ†ç±»</li>
</ul>
</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šcat /usr/share/nmap/scripts/script.db</code></strong>ï¼ˆå­˜æ”¾nmapè„šæœ¬åç§°è·¯å¾„ï¼‰</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šgrep vuln /usr/share/nmap/scripts/script.db | cut -d &quot;\&quot; -f 2</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šcat /usr/share/nmap/scripts/smb-check-vuln.nse</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šsmb-check-vulns.nse</code></strong><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap -sU -sS --script=smb-check-vulns.nse --script=args=unsafe=1 -p U:137,T:139,446 IPåœ°å€</code></strong></li>
<li>MS08-067</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>ä¸­æ–‡è¾“å…¥æ³•ï¼šæ¡Œé¢çš„è®¾ç½®ï¼Œåˆ é™¤æœ¬æœºè‡ªå¸¦çš„æ±‰è¯­ï¼Œç„¶åapt-get install ibus ibus-pinyinï¼Œæ·»åŠ æ±‰è¯­</code></pre></blockquote>
<h4 id="8-Nmap"><a href="#8-Nmap" class="headerlink" title="8. Nmap"></a>8. Nmap</h4><ul>
<li><p>smb-vuln-ms10-061.nse</p>
<ul>
<li>Stuxnetè •è™«åˆ©ç”¨çš„4ä¸ªæ¼æ´ä¹‹ä¸€ï¼ˆç¾å›½å†›æ–¹æ‰“å‡»ä¼Šæœ—æ ¸è®¾æ–½æ”»å‡»çš„é˜µäº¡ç—…æ¯’ï¼‰</li>
<li>Print Spooleræƒé™ä¸å½“ï¼Œæ‰“å°è¯·æ±‚å¯åœ¨ç³»ç»Ÿç›®å½•å¯åˆ›å»ºæ–‡ä»¶ã€æ‰§è¡Œä»»æ„ä»£ç </li>
<li>LANMAN APIæšä¸¾å…±äº«æ‰“å°æœº</li>
<li>è¿œç¨‹å…±äº«æ‰“å°æœºåç§°</li>
<li>smb-enum-sharesæšä¸¾å…±äº«</li>
</ul>
<ol>
<li>èº«ä»½è®¤è¯å‚æ•°â€“smbuserã€smbpassword</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap -p445 --script=smb-enum-shares.nse --script-args=smbuser=admin,smbpassword=pass IPåœ°å€</code></strong></li>
</ol>
<ul>
<li>Windows XPï¼ŒServer 2003 SP2ï¼ŒVistaï¼ŒServer 2008ï¼Œwin 7</li>
</ul>
</li>
<li><p>å½±å“æ‰«æç»“æœçš„å› ç´ </p>
</li>
</ul>
<blockquote>
<pre><code>ä¸åŒæ‰«æå™¨å¯¹äºæ¼æ´çš„åˆ¤æ–­æ˜¯ä¸åŒçš„ï¼Œæœ‰äº›æ˜¯åŸºäºè¡¥ä¸æ˜¯å¦å®‰è£…ï¼Œæœ‰äº›æ˜¯åŸºäºç«¯å£æ˜¯å¦å¼€æ”¾</code></pre></blockquote>
<h4 id="9-æ‰«æç»“æœç¡®è®¤"><a href="#9-æ‰«æç»“æœç¡®è®¤" class="headerlink" title="9. æ‰«æç»“æœç¡®è®¤"></a>9. æ‰«æç»“æœç¡®è®¤</h4><ul>
<li>ç›®æ ‡ç³»ç»Ÿç‰ˆæœ¬</li>
<li>è¡¥ä¸æ˜¯å¦å®‰è£…</li>
<li>æ˜¯å¦å¯è¢«å…¥ä¾µ</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81)%EF%BC%9A%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E8%AF%86%E5%88%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%BA%8C%E5%8D%81)%EF%BC%9A%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E8%AF%86%E5%88%AB/" itemprop="url">Kali Linuxç¬”è®°(äºŒå)ï¼šæ“ä½œç³»ç»Ÿè¯†åˆ«</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-12-10T08:13:38+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  883 å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  4 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-æ“ä½œç³»ç»Ÿè¯†åˆ«"><a href="#1-æ“ä½œç³»ç»Ÿè¯†åˆ«" class="headerlink" title="1. æ“ä½œç³»ç»Ÿè¯†åˆ«"></a>1. æ“ä½œç³»ç»Ÿè¯†åˆ«</h4><ul>
<li>æ“ä½œç³»ç»Ÿè¯†åˆ«æŠ€æœ¯ï¼ˆé»˜è®¤å¼€æ”¾çš„ç³»ç»Ÿå¼€æ”¾ç«¯å£ï¼‰<ul>
<li>ç§ç±»ç¹å¤š</li>
<li>å¥½äº§å“é‡‡ç”¨å¤šç§æŠ€æœ¯ç»„åˆ</li>
</ul>
</li>
<li>TTLèµ·å§‹å€¼<ul>
<li>Windowsï¼š128ï¼ˆ65-128ï¼‰</li>
<li>Linux/Unixï¼š64ï¼ˆ1-64ï¼‰</li>
<li>æŸäº›Unixï¼š255</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>TTLå€¼åŠ«æŒè·¯ç”±å™¨ï¼Œä½¿ä¸åŒåœ°åŒºçš„äººè®¿é—®åˆ°ç½‘é¡µä¸ä¸€æ ·</code></pre></blockquote>
<h4 id="2-æ“ä½œç³»ç»Ÿè¯†åˆ«"><a href="#2-æ“ä½œç³»ç»Ÿè¯†åˆ«" class="headerlink" title="2. æ“ä½œç³»ç»Ÿè¯†åˆ«"></a>2. æ“ä½œç³»ç»Ÿè¯†åˆ«</h4><ul>
<li>Python<ul>
<li>form scapy.all import*</li>
<li>win=â€IPåœ°å€â€</li>
<li>linx=â€IPåœ°å€â€</li>
<li>aw=sr1(IP(dst=win)/ICMP())</li>
<li>al=sr1(IP(dst=linu)/ICMP())</li>
<li>if al[IP].ttl&lt;=64:</li>
<li>print â€œhost is linuxâ€</li>
<li>else:</li>
<li>print â€œhost is windowsâ€</li>
</ul>
</li>
<li>./ttl_os.py IPåœ°å€</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">from scapy.all import*</span><br><span class="line">import logging</span><br><span class="line">logging.getLogger(&quot;scapy,runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=2:</span><br><span class="line">    print &quot;Usage - ./ttl_os.py [IP Address]&quot;</span><br><span class="line">    print &quot;Example - ./ttl_os.py 192.168.100.1&quot;</span><br><span class="line">    print &quot;Example will perform ttl analysize to attempt to determine whether the system is Windows or Linux/Unix&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">ip=sys.argv[1]</span><br><span class="line">ans=sr1(IP(dst=&quot;str(ip)&quot;)/ICMP(),timeout=1,verbose=0)</span><br><span class="line">if ans==None:</span><br><span class="line">    print &quot;No response was returned&quot;</span><br><span class="line">elif int(ans[IP].ttl)&lt;=64:</span><br><span class="line">    print &quot;Host is Linux/Unix&quot;</span><br><span class="line">else:</span><br><span class="line">    print &quot;Host is Windows&quot;</span><br></pre></td></tr></table></figure>

<h4 id="3-æ“ä½œç³»ç»Ÿè¯†åˆ«"><a href="#3-æ“ä½œç³»ç»Ÿè¯†åˆ«" class="headerlink" title="3. æ“ä½œç³»ç»Ÿè¯†åˆ«"></a>3. æ“ä½œç³»ç»Ÿè¯†åˆ«</h4><ul>
<li>nmapä½¿ç”¨å¤šç§æŠ€æœ¯è¯†åˆ«æ“ä½œç³»ç»Ÿ<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap IPåœ°å€ -O</code></strong></li>
<li>ç³»ç»ŸæœåŠ¡ç‰¹å¾</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>CPEå›½é™…æ ‡å‡†åŒ–ç»„ç»‡è¿›è¡Œçš„æ ‡å‡†åŒ–æ“ä½œç³»ç»Ÿï¼Œè®¾å¤‡ç±»å‹åˆ†ç±»</code></pre></blockquote>
<h4 id="4-æ“ä½œç³»ç»Ÿè¯†åˆ«"><a href="#4-æ“ä½œç³»ç»Ÿè¯†åˆ«" class="headerlink" title="4. æ“ä½œç³»ç»Ÿè¯†åˆ«"></a>4. æ“ä½œç³»ç»Ÿè¯†åˆ«</h4><ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šxprobe2 IPåœ°å€</code></strong></li>
<li>ç»“æœæœ‰è¯¯å·®</li>
</ul>
<h4 id="5-æ“ä½œç³»ç»Ÿè¯†åˆ«"><a href="#5-æ“ä½œç³»ç»Ÿè¯†åˆ«" class="headerlink" title="5. æ“ä½œç³»ç»Ÿè¯†åˆ«"></a>5. æ“ä½œç³»ç»Ÿè¯†åˆ«</h4><ul>
<li>è¢«åŠ¨æ“ä½œç³»ç»Ÿè¯†åˆ«<ul>
<li>IDS</li>
<li>æŠ“åŒ…åˆ†æ</li>
</ul>
</li>
<li>è¢«åŠ¨æ‰«æï¼ˆä¸ä¸»åŠ¨å‘ç›®æ ‡ä¸»æœºå‘åŒ…ï¼Œéƒ¨ç½²åœ¨ç½‘ç»œå‡ºå£çš„åœ°æ–¹ï¼‰</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šp0f</code></strong><ul>
<li>ç»“åˆARPåœ°å€æ¬ºéª—è¯†åˆ«å…¨ç½‘OS</li>
</ul>
</li>
</ul>
<h4 id="6-é˜²ç«å¢™è¯†åˆ«ï¼ˆå°½é‡éšè”½ï¼‰"><a href="#6-é˜²ç«å¢™è¯†åˆ«ï¼ˆå°½é‡éšè”½ï¼‰" class="headerlink" title="6. é˜²ç«å¢™è¯†åˆ«ï¼ˆå°½é‡éšè”½ï¼‰"></a>6. é˜²ç«å¢™è¯†åˆ«ï¼ˆå°½é‡éšè”½ï¼‰</h4><ul>
<li>é€šè¿‡æ£€æŸ¥å›åŒ…ï¼Œå¯èƒ½è¯†åˆ«ç«¯å£æ˜¯å¦ç»è¿‡é˜²ç«å¢™è¿‡æ»¤</li>
<li>è®¾å¤‡å¤šç§å¤šæ ·ï¼Œç»“æœè¿‡å­˜åœ¨ä¸€å®šè¯¯å·®</li>
</ul>
<blockquote>
<pre><code>ï¼ˆ1ï¼‰é˜²ç«å¢™å†…éƒ¨å¯¹å¤–éƒ¨çš„è®¿é—®è¿æ¥  ï¼ˆ2ï¼‰é˜²ç«å¢™å¯¹æºåœ°å€çš„è¿‡æ»¤
é˜²ç«å¢™å‡ ç§æƒ…å†µï¼š
Send         Response           Type
SYN          NO              
ACK          RST                Filtered

SYN          SYN+ACK/SYN+RST 
ACK          NO                 Filtered

SYN          SYN+ACK/SYN+RST
ACK          RST                Unfiltered/Open

SYN          NO             
ACK          NO                 Closed</code></pre></blockquote>
<h4 id="7-é˜²ç«å¢™è¯†åˆ«"><a href="#7-é˜²ç«å¢™è¯†åˆ«" class="headerlink" title="7. é˜²ç«å¢™è¯†åˆ«"></a>7. é˜²ç«å¢™è¯†åˆ«</h4><ul>
<li>Scapy</li>
<li>Python<ul>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šfw_detect.py IPåœ°å€ ç«¯å£</code></strong> â–² 2019.12.6 è„šæœ¬å®éªŒä¸æˆåŠŸï¼Œé€»è¾‘æŠ¥é”™</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">from scapy.all import*</span><br><span class="line">import logging</span><br><span class="line">logging.getLogger(&quot;scapy,runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=3:</span><br><span class="line">    print &quot;Usage - ./fw_detect.py [Target IP] [Target Port] &quot;</span><br><span class="line">    print &quot;Example - ./syn_scan.py 192.168.100.1 445&quot;</span><br><span class="line">    print &quot;Example will determine if filtering exists on port 443 of host 192.168.100.1&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">ip=sys.argv[1]</span><br><span class="line">port=sys.argv[2]</span><br><span class="line"></span><br><span class="line">ACK_response=sr1(IP(dst=ip)/TCP(dport=port,flags=&apos;A&apos;),timeout=1,verbose=0)</span><br><span class="line">SYN_response=sr1(IP(dst=ip)/TCP(dport=port,flags=&apos;S&apos;),timeout=1,verbose=0)</span><br><span class="line">if (ACK_respnonse==None) and (SYN_response==None):</span><br><span class="line">    print &quot;Port is either unstatefully filered or host is down&quot;</span><br><span class="line">elif (ACK_respnonse==None) and ((SYN_response[flags]==18) or (SYN_response[flags==6])):</span><br><span class="line">    print &quot;Stateful filtering in place&quot;</span><br><span class="line">elif (SYN_response==None) and (ACK_response[flags]==4):</span><br><span class="line">    print &quot;Stateful filtering in place&quot;</span><br><span class="line">elif ((SYN_response[flags]==18) or (SYN_response[flags==6])) and (ACK_response[flags]==4):</span><br><span class="line">    print &quot;Port is unfiltered and open&quot;</span><br><span class="line">else:</span><br><span class="line">    print &quot;Unable to determine if the port is filtered&quot;</span><br></pre></td></tr></table></figure>

<h4 id="8-é˜²ç«å¢™è¯†åˆ«"><a href="#8-é˜²ç«å¢™è¯†åˆ«" class="headerlink" title="8. é˜²ç«å¢™è¯†åˆ«"></a>8. é˜²ç«å¢™è¯†åˆ«</h4><ul>
<li>Nmapæœ‰ç³»åˆ—é˜²ç«å¢™è¿‡æ»¤æ£€æµ‹åŠŸèƒ½</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap IPåœ°å€ ç«¯å£</code></strong>ï¼ˆé»˜è®¤SYNåŒ…ï¼‰</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap -sAï¼ˆACKåŒ…ï¼‰ IPåœ°å€ ç«¯å£</code></strong></li>
</ul>
<h4 id="9-è´Ÿè½½å‡è¡¡è¯†åˆ«"><a href="#9-è´Ÿè½½å‡è¡¡è¯†åˆ«" class="headerlink" title="9. è´Ÿè½½å‡è¡¡è¯†åˆ«"></a>9. è´Ÿè½½å‡è¡¡è¯†åˆ«</h4><ul>
<li>å¹¿åŸŸç½‘è´Ÿè½½å‡è¡¡<ul>
<li>DNS</li>
<li>æ™ºèƒ½DNSï¼ˆä¸åŒåœ°åŒºä¸åŒDNSå›åº”ï¼‰</li>
</ul>
</li>
<li>æœåŠ¡å™¨è´Ÿè½½å‡è¡¡<ul>
<li>åŸºäºWebçš„æœåŠ¡å™¨</li>
</ul>
</li>
<li>ç»„ä»¶çº§è´Ÿè½½å‡è¡¡</li>
<li>HTTP-Loadbalancing<ul>
<li>Nginx</li>
<li>Apache</li>
</ul>
</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šlbd www.baidu.com</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šlbd mail.163.com</code></strong></li>
</ul>
<h4 id="10-WAFè¯†åˆ«"><a href="#10-WAFè¯†åˆ«" class="headerlink" title="10. WAFè¯†åˆ«"></a>10. WAFè¯†åˆ«</h4><ul>
<li>WEBåº”ç”¨é˜²ç«å¢™ï¼ˆåŸºäºè§„åˆ™çš„è¿‡æ»¤ â†’ åŸºäºæœºå™¨å­¦ä¹ ï¼Œç‰¹å¾è¯†åˆ«ï¼Œè¯­æ³•è¯æ³•çš„è¿‡æ»¤ï¼‰</li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šwafw00f -l</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šwafw00f http://www.microsoft.com</code></strong></li>
<li><strong><code>ğŸ”ºå‘½ä»¤ï¼šnmap www.microsoft.com --script=http-waf-detect.nse</code></strong></li>
</ul>
<blockquote>
<pre><code>WAFäº§å“
Profense
Barracuda
F5 Trafficshield
Citrix NetScalor
IBM Web Application Security
webApp.secure
BIG IP
ISA Server
AkamaiGHost</code></pre></blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/13/">Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span><a class="page-number" href="/page/15/">15</a><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/15/">Next</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/photo.jpg"
                alt="Tomas" />
            
              <p class="site-author-name" itemprop="name">Tomas</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">159</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Tomassky" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:tomassky7@gmail.com" target="_blank" title="Gmailé‚®ç®±">
                      
                        <i class="fa fa-fw fa-envelope"></i>Gmailé‚®ç®±</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://ylsword-cheat.top" title="LengSword" target="_blank">LengSword</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://neigeshoufu.github.io/ljy.github.io" title="neigeshoufu" target="_blank">neigeshoufu</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tomas</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">146.6k</span>
  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
